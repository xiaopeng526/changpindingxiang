
(function($) {
	var myDate = new Date(); //实例一个时间对象；
	var getHours = myDate.getHours();
	var getMinutes = myDate.getMinutes();
	var getSeconds = myDate.getSeconds();
	if(getHours<10){
		getHours = '0' + getHours
	}
	if(getMinutes<10){
		getMinutes = '0' + getMinutes
	}
	if(getSeconds<10){
		getSeconds = '0' + getSeconds
	}
	var newTime = getHours +":"+ getMinutes +":"+ getSeconds;
	var platform = {
		createUploadIframe : function(id, uri) {
			var frameId = 'jUploadFrame' + id;
			if (window.ActiveXObject) {
				if (jQuery.browser.version == "9.0"
						|| jQuery.browser.version == "10.0") {
					var io = document.createElement('iframe');
					io.id = frameId;
					io.name = frameId;
				} else if (jQuery.browser.version == "6.0"
						|| jQuery.browser.version == "7.0"
						|| jQuery.browser.version == "8.0") {
					var io = document.createElement('<iframe id="' + frameId
							+ '" name="' + frameId + '" />');
					if (typeof uri == 'boolean') {
						io.src = 'javascript:false';
					} else if (typeof uri == 'string') {
						io.src = uri;
					}
				}
			} else {
				var io = document.createElement('iframe');
				io.id = frameId;
				io.name = frameId;
			}
			io.style.position = 'absolute';
			io.style.top = '-1000px';
			io.style.left = '-1000px';
			document.body.appendChild(io);
			return io;
		},
		createUploadForm : function(id, fileElementId, data) {
			var formId = 'jUploadForm' + id;
			var fileId = 'jUploadFile' + id;
			var form = jQuery('<form  action="" method="POST" name="' + formId
					+ '" id="' + formId
					+ '" enctype="multipart/form-data"></form>');
			var newElement = $(fileElementId).clone(true);
			var fileName = $(fileElementId).val();
			$(fileElementId).parent().append(newElement);
			$(fileElementId).attr("name", "file");
			$(fileElementId).appendTo(form);
			if (data) {
				for ( var i in data) {
					$(
							'<input type="hidden" name="' + i + '" value="'
									+ data[i] + '" />').appendTo(form);
				}
			}
			jQuery(form).css('position', 'absolute');
			jQuery(form).css('top', '-1200px');
			jQuery(form).css('left', '-1200px');
			jQuery(form).appendTo('body');
			return form;
		},

		ajaxFileUpload : function(s) {
			s = jQuery.extend({}, jQuery.ajaxSettings, s);
			var id = s.id;
			var form = platform.createUploadForm(id, s.fileElementId, s.data);
			var io = platform.createUploadIframe(id, s.secureuri);
			var frameId = 'jUploadFrame' + id;
			var formId = 'jUploadForm' + id;

			if (s.global && !jQuery.active++) {
				jQuery.event.trigger("ajaxStart");
			}
			var requestDone = false;
			var xml = {};
			if (s.global) {
				jQuery.event.trigger("ajaxSend", [ xml, s ]);
			}

			var uploadCallback = function(isTimeout) {
				var io = document.getElementById(frameId);
				try {
					if (io.contentWindow) {
						xml.responseText = io.contentWindow.document.body ? io.contentWindow.document.body.innerHTML
								: null;
						xml.responseXML = io.contentWindow.document.XMLDocument ? io.contentWindow.document.XMLDocument
								: io.contentWindow.document;
						xml.responseJson = io.contentWindow.document.body ? io.contentWindow.document.body.textContent
								: null;
					} else if (io.contentDocument) {
						xml.responseText = io.contentDocument.document.body ? io.contentDocument.document.body.innerHTML
								: null;
						xml.responseXML = io.contentDocument.document.XMLDocument ? io.contentDocument.document.XMLDocument
								: io.contentDocument.document;
						xml.responseJson = io.contentWindow.document.body ? io.contentWindow.document.body.textContent
								: null;
					}
				} catch (e) {
					platform.handleError(s, xml, null, e);
				}
				if (xml || isTimeout == "timeout"){
					requestDone = true;
					var status;
					try {
						status = isTimeout != "timeout" ? "success" : "error";
						if (status != "error") {
							var data = platform.uploadHttpData(xml, s.dataType);
							if (s.success) {
								s.success(data, status);
							}
							;
							if (s.global) {
								jQuery.event.trigger("ajaxSuccess", [ xml, s ]);
							}
							;
						} else {
							jQuery.handleError(s, xml, status);
						}

					} catch (e) {
						status = "error";
						platform.handleError(s, xml, status, e);
					}
					;
					if (s.global) {
						jQuery.event.trigger("ajaxComplete", [ xml, s ]);
					}
					;
					if (s.global && !--jQuery.active) {
						jQuery.event.trigger("ajaxStop");
					}
					;
					if (s.complete) {
						s.complete(xml, status);
					}
					;

					jQuery(io).unbind();
					setTimeout(function() {
						try {
							jQuery(io).remove();
							jQuery(form).remove();
						} catch (e) {
							jQuery.handleError(s, xml, null, e);
						}
					}, 100);
					xml = null;
				}
				;
			}
			if (s.timeout > 0) {
				setTimeout(function() {
					if (!requestDone) {
						uploadCallback("timeout");
					}
				}, s.timeout);
			}
			try {
				var form = jQuery('#' + formId);
				jQuery(form).attr('action', s.url);
				jQuery(form).attr('method', 'POST');
				jQuery(form).attr('target', frameId);
				if (form.encoding) {
					form.encoding = 'multipart/form-data';
				} else {
					form.enctype = 'multipart/form-data';
				}
				jQuery(form).submit();

			} catch (e) {
				platform.handleError(s, xml, null, e);
			}
			jQuery('#' + frameId).load(uploadCallback);
			return {
				abort : function() {
				}
			};

		},

		uploadHttpData : function(r, type) {
			var data = !type;
			data = type == "xml" || data ? r.responseXML : r.responseText;
			if (type == "script") {
				jQuery.globalEval(data);
			}
			if (type == "json") {
				data = r.responseJson;
				eval("data = " + data);
			}
			if (type == "html") {
				jQuery("<div>").html(data).evalScripts();
			}
			return data;
		},
		handleError : function(s, xhr, status, e) {
			if (s.error) {
				s.error.call(s.context || s, xhr, status, e);
			}
			if (s.global) {
				(s.context ? jQuery(s.context) : jQuery.event).trigger(
						"ajaxError", [ xhr, s, e ]);
			}
		},
		singleTime : {
			singleDate : true,
			showShortcuts : false,
			format : 'YYYY-MM-DD HH:mm:ss',
			time : {
				enabled : true
			}
		},
		JsonToGet : function(url, param) {
			if (platform.isNull(param)) {
				return url;
			}
			var str = "";

			for ( var i in param) {
				str += i + "=" + param[i] + "&";
			}
			if (url.indexOf("?") > -1) {
				return url + "&" + str;
			} else {
				return url + "?" + str;
			}
		},
		closeMenu : function(slibings) {
			slibings.each(function(index, item) {
				var level = $(item).attr("level");
				if (level == 1) {
					return false;
				}
				$(item).removeClass("show");
				$(item).addClass("hide");
			});
		},
		changeMenu : function(that) {
			var isOff = $(that).attr("off");
			if (platform.isNull(isOff)) {
				$(that).prevAll().each(function(index, item) {
					isOff = $(item).attr("off");
					if (!platform.isNull(isOff)) {
						that = item;
						return false;
					}
				});
			}
			$(".topClass").each(function(index, item) {
				var isOff = $(item).attr("off");
				if (isOff != "true") {
					var slibings = $(item).nextAll();
					platform.closeMenu(slibings);
					$(item).attr("off", "true");
					return false;
				}

			});
			var slibings = $(that).nextAll();
			if (isOff == "true") {// 关着呢
				slibings.each(function(index, item) {
					var level = $(item).attr("level");
					if (level == 1) {
						return false;
					}
					$(item).removeClass("hide");
					$(item).addClass("show");
				});
				$(that).attr("off", "false");
			} else {
				platform.closeMenu(slibings);
			}
		},
		myAjaxFileUpload : function(url, fileElementId, data, successBack,
				errorBack) {
			platform
					.ajaxFileUpload({
						url : url,
						contentType : "application/x-www-form-urlencoded; charset=utf-8",
						type : "POST",
						secureuri : false,
						fileElementId : fileElementId,
						dataType : 'json',
						data : data,
						success : successBack,
						error : errorBack
					})
		},
		required : function(selecter, msg) {
			var isPass = true;
			var mymsg = "";
			var myholder = "";
			var arr = [];
			var inputs = $(selecter).find("input[required='required']");
			var selects = $(selecter).find("select[required='required']");
			if (!platform.isNull(inputs)) {
				arr.push(inputs);
			}
			if (!platform.isNull(selects)) {
				arr.push(selects);
			}
			for (var int = 0; int < arr.length; int++) {
				arr[int].each(function(index, item) {
					var required = $(item).attr("required");
					if (required == "required") {
						var id = $(item).attr("id");
						var value = $(item).val();
						var holder = $(item).attr("placeholder");
						if (platform.isNull(value)) {
							isPass = false;
							myholder = holder;
							mymsg = "为空值";
							$(item).addClass("has-feedback main-error");
						}
						var type = $(this).attr("type");
						if (type == "number") {
							if (value < 0) {
								isPass = false;
								myholder = holder;
								mymsg = "不能小于0";
								$(item).addClass("has-feedback main-error");
							}
						}
					}
				});
			}
			if (!platform.isNull(myholder)) {
				mymsg = myholder + mymsg;
			} else {
				mymsg = "数据项" + mymsg;
			}
			if (!platform.isNull(msg)) {
				mymsg = msg;
			}
			if (!isPass) {
				layer.msg(mymsg);
			}
			return isPass;
		},
		role : {
			init : function() {
				$(".fd_page li").off("click", "a").on("click", "a", function() {
					var page = $(this).attr("assignPage");
					if(platform.isNull(page)){
						return;
					}
					platform.doGet(platform.role.getRequestFormsUrl(page));
				});
			},
			getRequestFormsUrl : function(page) {
				return rootPath + "/auth/role/index.shtml?current=" + page;
			}
		},
		resource : {
			init : function() {
				$(".fd_page li").off("click", "a").on("click", "a", function() {
					var page = $(this).attr("assignPage");
					if(platform.isNull(page)){
						return;
					}
					platform.doGet(platform.resource.getRequestFormsUrl(page));
				});
			},
			getRequestFormsUrl : function(page) {
				return rootPath + "/auth/resource/index.shtml?current=" + page;
			},
			edit : function() {
				$("#submit").click(function() {
					var url = $(this).attr("url");
					var json = platform.getFormJson("#form");
					platform.doPost(url, json);
				});
			}
		},
		userAuth : {
			init : function() {
				$(".repassword").click(function() {
					var url = $(this).attr("url");
					layer.prompt(function(val, index) {
						var param = {
							newPassword : val
						};
						platform.doPost(url, param);
						layer.close(index);
					});
				});
				$(".fd_page li").off("click", "a").on("click", "a", function() {
					var page = $(this).attr("assignPage");
					if(platform.isNull(page)){
						return;
					}
					platform.doGet(platform.userAuth.getRequestFormsUrl(page));
				});
			},
			getRequestFormsUrl : function(page) {
				return rootPath + "/auth/user/index.shtml?current=" + page;
			}
		},
		organization : {
			children : function() {
				$("#createBtn").click(
						function() {
							var param = platform.getFormJson("#form");
							platform.doPost(rootPath
									+ "/auth/organization/appendChild.shtml",
									param);
						})
			},
			init : function() {
				$("#submit").click(
						function() {
							var param = {
								name : $("#name").val()
							}
							platform.doPost(rootPath
									+ "/auth/organization/add.shtml", param);
						});
				$("#updateBtn").click(
						function() {
							platform.doPost(rootPath
									+ "/auth/organization/update.shtml", {
								code : $("#code").val(),
								name : $("#name").val(),
								status : $("#status").val(),
								pcode : $("#pcode").val(),
								pcodes : $("#pcodes").val()
							});
							return false;
						});
				$("#deleteBtn").click(
						function() {
							var index = layer.confirm('确定是否删除？', {
								btn : [ '确认', '取消' ]
							}, function() {
								layer.close(index);
								platform.doPost(rootPath
										+ "/auth/organization/"
										+ $("#code").val() + "/delete.shtml", {
									code : $("#code").val()
								});
							}, function() {
								layer.close(index);
							});
							return false;
						});
				$("#appendChildBtn").click(
						function() {
							$.ajaxSetup({
								cache : false
							});
							var index = platform.close();
							$("#treeContent").load(
									rootPath + "/auth/organization/"
											+ $("#code").val()
											+ "/appendChild.shtml", "",
									function(response, status, xhr) {
										platform.open(index, response);
									});
							return false;
						});
				$("#createBtn").click(
						function() {
							platform.doPost(rootPath
									+ "/auth/organization/appendChild.shtml", {
								code : $("#code").val(),
								name : $("#name").val(),
								status : $("#status").val(),
								pcode : $("#pcode").val(),
								pcodes : $("#pcodes").val()
							});
							return false;
						});
			}
		},
		strategy : {
			list : {
				init : function() {
					$("#myTab").find("li").click(
							function() {
								var used = $(this).attr("used");
								$("#used").val(used);
								platform.doGet(platform.strategy.list
										.getRequestFormsUrl(1));
							});

					$(".fd_page li").off("click", "a").on(
							"click",
							"a",
							function() {
								var page = $(this).attr("assignPage");
								if(platform.isNull(page)){
									return;
								}
								platform.doGet(platform.strategy.list
										.getRequestFormsUrl(page));
							});
				},
				getRequestFormsUrl : function(page) {
					var used = $("#used").val();
					var islml = $("#islml").val();
					return rootPath
							+ "/user/strategy/project/list.shtml?current="
							+ page + "&used=" + used+"&islml="+islml;
				}
			},
			create : {
				getValue : function(selecter, buttons, fgf1, fgf2) {
					var endValue = "";
					if (buttons.length > 0) {
						var type = $(selecter).attr("type");
						endValue = type + fgf1;
						$(buttons).each(function(buttonIndex, btn) {
							var data = $(btn).attr("data");
							var sonv = $(btn).attr("sonv");
							if (!platform.isNull(sonv)) {
								data += sonv;
							}
							endValue = endValue + data + fgf2;
						});
						endValue = endValue.substring(0, endValue.length - 1);
					}
					return endValue;
				},
				getDesc : function(selecter, buttons, fgf1, fgf2) {
					var endDesc = "";
					if (buttons.length > 0) {
						var name = $(selecter).attr("name");
						endDesc = name + fgf1;
						$(buttons).each(function(buttonIndex, btn) {
							var data = $(btn).html();
							var sond = $(btn).attr("sond");
							if (!platform.isNull(sond)) {
								data += sond;
							}
							endDesc = endDesc + data + fgf2;
						});
						endDesc = endDesc.substring(0, endDesc.length - 1);
					}
					return endDesc;
				},
				cityInit : function() {
					$("#cityAlert").find("button").click(function() {
						var data = $(this).attr("data");
						if (!platform.isNull(data)) {
							platform.strategy.create.changeBtnStatus($(this));
						}
						$(this).attr("select", "false");
					})
				},
				changeBtnStatus : function(item) {
					if (item.hasClass("btn-default")) {
						item.attr("class", "btn btn-success");
						item.attr("select", "true");
					} else if (item.hasClass("btn-success")) {
						item.attr("class", "btn btn-default");
						item.attr("select", "false");
					}
				},
				init : function() {
					$(".strategy-param")
							.find(".selectAllButton")
							.click(
									function() {
										var buttonvalue = $(this).html();
										if (buttonvalue == '选择全部') {
											$(this).html('取消全部');
											var button = $(this).parent().find(
													'button');
											for (var int = 0; int < button.length; int++) {
												var name = $(button[int]).attr(
														"name");
												if (!platform.isNull(name)
														&& name == "sonCity") {
													$(button[int]).attr(
															"class",
															"sonCity btn btn-default");
													continue;
												}
												$(button[int]).attr("sonv", "");
												$(button[int]).attr("sond", "");
												$(button[int]).attr("select",
														"true");
												$(button[int]).attr('class',
														"btn btn-success");
											}
										} else {
											$(this).html('选择全部');
											var button = $(this).parent().find(
													'button');
											for (var int = 0; int < button.length; int++) {
												var name = $(button[int]).attr(
														"name");
												if (!platform.isNull(name)
														&& name == "sonCity") {
													$(button[int]).attr(
															"class",
															"sonCity btn btn-default");
													continue;
												}
												$(button[int]).attr("sonv", "");
												$(button[int]).attr("sond", "");
												$(button[int]).attr("select",
														"false");
												$(button[int]).attr('class',
														"btn btn-default");
											}
										}
									})
					$("button")
							.click(
									function() {
										var currentBtn = $(this);
										var data = currentBtn.attr("data");
										if (!platform.isNull(data)) {
											var name = currentBtn.attr("name");
											if (!platform.isNull(name)
													&& name == "sonCity") {
												var url = rootPath
														+ "/user/strategy/project/city.shtml";
												$
														.post(
																url,
																{
																	code : data
																},
																function(data) {
																	var province = currentBtn
																			.prev();
																	var sonIds = province
																			.attr("sonv");
																	var sonArr = [];
																	if (!platform
																			.isNull(sonIds)) {
																		sonArr = sonIds
																				.substring(
																						2)
																				.split(
																						'-');
																	}
																	var str = "<div id='cityAlert' type='' name='' class='col-sm-11' style='margin-top:20px;margin-left:10px'>";
																	$(data)
																			.each(
																					function(
																							index,
																							item) {
																						var isSelect = false;
																						for (var int = 0; int < sonArr.length; int++) {
																							var son = sonArr[int];
																							if (son == item.id) {
																								isSelect = true;
																								break;
																							}
																						}
																						str += "<button type='button' style='margin-right:5px' data='"
																								+ item.id;
																						if (isSelect) {
																							str += "' class='btn btn-success'>";
																						} else {
																							str += "' class='btn btn-default'>";
																						}
																						str += item.name
																								+ "</button>";
																					});
																	str += "</div>";
																	layer
																			.open({
																				type : 1,
																				title : '城市信息',
																				area : [
																						'600px',
																						'300px' ], // 宽高
																				content : str,
																				btn : [
																						'取消',
																						'确定' ],
																				yes : function(
																						index,
																						layero) {
																					layer
																							.close(index);
																				},
																				btn2 : function(
																						index,
																						layero) {
																					var buttons = $(
																							"#cityAlert")
																							.find(
																									"button[class='btn btn-success']");
																					var thisValue = platform.strategy.create
																							.getValue(
																									"#cityAlert",
																									buttons,
																									">>",
																									"-");
																					province
																							.attr(
																									"sonv",
																									thisValue);
																					var thisDesc = platform.strategy.create
																							.getDesc(
																									"#cityAlert",
																									buttons,
																									">>",
																									"-");
																					province
																							.attr(
																									"sond",
																									thisDesc);
																					if (!platform
																							.isNull(thisValue)) {
																						province
																								.attr(
																										"select",
																										"true");
																						province
																								.attr(
																										"class",
																										"btn btn-default");
																						currentBtn
																								.attr(
																										"class",
																										"sonCity btn btn-success");
																					} else {
																						province
																								.attr(
																										"select",
																										"false");
																						currentBtn
																								.attr(
																										"class",
																										"sonCity btn btn-default");
																					}
																				}
																			});
																	platform.strategy.create
																			.cityInit();
																}, 'json');
											} else {
												platform.strategy.create
														.changeBtnStatus(currentBtn);
												// 点击省份清除城市信息
												currentBtn.attr("sonv", "");
												currentBtn.attr("sond", "");
												var son = currentBtn.next();
												if (!platform.isNull(son)) {
													son.attr("class",
															"sonCity btn btn-default");
												}
											}
										}

									});
					$("#submitForm1")
							.click(
									function() {
										var arr = [ ".sex", ".device",
												".stage", ".province",
												".netType",".valid",".fromType" ];
										var value = "";
										for ( var index in arr) {
											var buttons = $(arr[index]).find(
													"button[select='true']");
											var thisValue = platform.strategy.create
													.getValue(arr[index],
															buttons, "=", "|");
											if (!platform.isNull(thisValue)) {
												value = value + thisValue + "&";
											}
										}
										value = value.substring(0,
												value.length - 1);
										var valueDesc = "";
										for ( var index in arr) {
											var buttons = $(arr[index]).find(
													"button[select='true']");
											var thisValue = platform.strategy.create
													.getDesc(arr[index],
															buttons, "=", "|");
											if (!platform.isNull(thisValue)) {
												valueDesc = valueDesc
														+ thisValue + "且";
											}
										}
										valueDesc = valueDesc.substring(0,
												valueDesc.length - 1);
										var strategyNames = $("#strategyName")
												.val();
										if (platform.isNull(strategyNames)) {
											layer.msg("请填写名称");
											return;
										}
										if (platform.isNull(valueDesc)
												|| platform.isNull(value)) {
											layer.msg("请选择策略信息");
											return;
										}
										var idDesc = $("#id").val();
										var parents = $(this).parents(
												"#openDiv");
										if (parents.length == 1) {
											idDesc = "";
										}
										var param = {
											strategyName : strategyNames,
											strategyData : value,
											strategyDataDesc : valueDesc,
											id : idDesc
										};
										platform.apply
												.request(
														rootPath
																+ "/user/strategy/project/create.shtml",
														this, param);
									});
				}
			}
		},
		validate : function(that) {
			var required = $(that).attr("required");
			if (required == "required") {
				var isPass = true;
				var id = $(that).attr("id");
				var value = $(that).val();
				var holder = $(that).attr("placeholder");
				var msg = "该数据项";
				if (!platform.isNull(holder)) {
					msg = holder;
				}
				if (platform.isNull(value)) {
					isPass = false;
					layer.tips(msg + "是必填项", "#" + id);
				}
				var type = $(that).attr("type");
				if (type == "number") {
					if (value < 0) {
						isPass = false;
						layer.tips(msg + "必须大于等于0", id);
					}
				}
				if (!isPass) {
					$(that).addClass("has-feedback main-error");
				} else {
					$(that).removeClass("has-feedback main-error");
				}
			}
		},
		fileUpload : {
			upload : function(url, selecter, param) {
				platform.myAjaxFileUpload(url, selecter, param,
						platform.fileUpload.uploadBackS,
						platform.fileUpload.uploadBackE);
			},
			uploadBackS : function(data, status) {
				if (!platform.isNull(data.msg)) {
					platform.alertmsg(data.msg);
				}
				if (!platform.isNull(data.data)) {
					$("#keyUrl").val(data.data.keyUrl);
				}
			},
			uploadBackE : function(data, status, e) {
				platform.alertmsg("上传失败");
			},

		},
		getType : function() {
			var type = $("#window-content").find("#typeV").find(
					"option:selected").val();
			if (platform.isNull(type)) {
				return "&typeV=0";
			} else {
				return "&typeV=" + type;
			}
		},

		getDateRange : function() {
			var Range = document.getElementById("date-range5");
			if(Range==null){
				return "";
			}
			var dateRange=Range.value;
			if (platform.isNull(dateRange)) {
				return "&dateRange=";
			} else {
				return "&dateRange=" + dateRange;
			}
		},
		flushWindow : function(url) {
			window.location.href = platform.getRequestParam(url);
		},
		frame : function() {
			$("#window-content").off("blur", "input").on("blur", "input",
					function() {
						platform.validate(this);
					});
			$("#window-content").off("click", ".uvsubmit").on("click",
					".uvsubmit", function() {
						$("#sideNav").find("li").each(function(index, item) {
							if ($(item).hasClass("select-hover")) {
								var url = $(item).find("a").attr("url");
								if (!platform.isNull(url)) {
									platform.flushWindow(url);
									// platform.doGet(url);
								}
							}
						});
					});
			$("#window-content").off("click", "#create").on("click", "#create",
					function() {
						var url = $(this).attr("url");
						platform.doGet(url);
					});
			$("#sideNav")
					.find("li")
					.unbind("click")
					.click(
							function() {
								var url = $(this).children().attr("url");
								if (platform.isNull(url)) {
									return;
								}
								platform.flushWindow(url);
								// platform.doGet(url);
								$("#sideNav")
										.find("li")
										.each(
												function(index, item) {
													if ($(item).hasClass(
															"select-hover")) {
														$(item).removeClass(
																"select-hover");
														$(item)
																.find("a")
																.attr("style",
																		"padding-left: 30%; font-size: 13px");
													}
												});
								$(this).addClass("select-hover");
								$(this)
										.find("a")
										.attr("style",
												"padding-left: 30%; font-size: 13px;color:white");
							});
			$("#window-content").off("click", ".delete").on("click", ".delete",
					function() {
						platform.deleteObj(this);
					})
			$("#window-content").off("click", ".update").on("click", ".update",
					function() {
						var url = $(this).attr("url");
						window.open(url);
					})
			$("#window-content").off("click", ".topage").on("click", ".topage",
					function() {
						var url = $(this).attr("url");
						platform.doGet(url);
					})
			$("#window-content").off("click", ".page-header li a").on("click",
					".page-header li a", function() {
						var url = $(this).attr("url");
						platform.doGet(url);
					})
		},
		activity : {
			create : {
				init : function() {
					$("#wallet")
							.off("click", "img")
							.on(
									"click",
									"img",
									function() {
										if (this.className == "add") {
											var clone = $(this).parent()
													.clone();
											$(clone).find("input").each(
													function(index, item) {
														$(item).val("");
													});
											$("#wallet").append(clone);
											$(this)
													.prop(
															"src",
															rootPath
																	+ "/resources/image/activity/image/sc.png");
											$(this).prop("class", 'minus');
										} else if (this.className == "minus") {
											$(this).parent().remove();
										}
									});
					$("#activityForm")
							.find("input[name='activityType']")
							.click(
									function() {
										var value = $(this).val();
										if (value == 0) {
											$("#lot").removeClass("hide")
													.show();
											$("#wallet").hide();
											/*
											 * $("#hongbaodiv").hide();
											 * $("#chouqiandiv").show();
											 */

										} else {
											$("input[name='outLot']:checked")
													.removeAttr('checked');
											$("input[name='randomLot']:checked")
													.removeAttr('checked');
											$("#lot").hide();
											$("#wallet").removeClass("hide")
													.show();
											/*
											 * $("#chouqiandiv").hide();
											 * $("#hongbaodiv").show();
											 */
										}
									});
					$("#activityForm").find(".sbumit").click(
							function() {
								var url = $("#activityForm").attr("action");
								var param = {};
								var typeCheckd = $(
										"input[name='activityType']:checked")
										.val();
								if (typeCheckd == 1) {
									param.walletJson = platform.activity.create
											.getWalletParam();
								}
								param.activityName = $(".activity-form").find(
										"input[name='activityName']").val();
								param.activityType = typeCheckd;
								param.outLotType = $(
										"input[name='outLot']:checked").val();
								param.randomLotType = $(
										"input[name='randomLot']:checked")
										.val();
								param.id = $("#id").val();
								platform.apply.request(url, this, param);
							});
				},
				getWalletParam : function() {
					var divs = $("#wallet").find("div");
					var arr = [];
					$(divs).each(
							function(index, item) {
								var inputs = $(item).find("input");
								var json = platform.activity.create
										.getWalletJson(inputs);
								arr.push(json);
							});
					return JSON.stringify(arr);
				},
				getWalletJson : function(inputs) {
					var resultString = "{";
					$(inputs).each(
							function(index, item) {
								var name = $(item).attr("name");
								var value = $(item).val();
								resultString = resultString + "'" + name + "':"
										+ value + ","
							});
					var json = resultString.substring(0,
							resultString.length - 1)
							+ "}";
					return eval('(' + json + ')');
				}
			},
			list : {
				init : function() {
					$(".fd_page li").off("click", "a").on(
							"click",
							"a",
							function() {
								var page = $(this).attr("assignPage");
								if(platform.isNull(page)){
									return;
								}
								platform.load(platform.activity.list
										.getRequestFormsUrl(page));
							});
				},
				getRequestFormsUrl : function(page) {
					var url = rootPath
							+ "/user/activity/type/list.shtml?current=" + page;
					return url;
				}
			},

		},

		object : function() {
			// 点击全部取消选中电子奖实物奖，点击电子或者实物取消其他两个
			$(".buttonPadding").click(function() {
				$(".buttonPadding").removeClass("buttonColor");
				$(this).addClass("buttonColor");
			})
			$(document).ready(function() {
					    $("#loading").hide();
				 });
			$(".buttonPadding").click(
					function() {
						$("#loading").show();
						var url = rootPath + "/account/object.shtml?isCount=true&startDate="
								+ $("#prize-search-date-range").val()
								+ "&prizeType=" + $(".buttonColor").val()
						platform.flushWindow(url);
					});
		},

		getTableTrHeight : function() {
			var mytable = document.getElementById("headTable");
			for (var int = 0; int < mytable.rows.length - 1; int++) {
				var h = mytable.rows[int]
			}
		},
		projectPrize : {
			load : function() {
				$(".buttons").find("button").click(function() {
					var url = $(this).attr("url");
					platform.doGet(url);
				});
			}
		},
		lamp : {
			page : function() {
				$(".search .fd_page li").find("a").click(function() {
					var page = $(this).attr("assignPage");
					if(platform.isNull(page)){
						return;
					}
					platform.doGet(platform.getRequestLampUrl(page,"list"));
				});
				$(".searchTotal .fd_page li").find("a").click(function() {
					var page = $(this).attr("assignPage");
					if(platform.isNull(page)){
						return;
					}
					platform.doGet(platform.getRequestLampUrl(page,"total"));
				});
			}
		},
		forms : {
			page : function() {
				$(".fd_page li").find("a").click(function() {
					var page = $(this).attr("assignPage");
					if(platform.isNull(page)){
						return;
					}
					platform.doGet(platform.getRequestFormsUrl(page), "#pages");
				});
			}
		},
		deleteObj : function(that) {
			var url = $(that).attr("url");
			var index = layer.confirm('确定删除吗？', {
				btn : [ '确定', '取消' ]
			}, function() {
				platform.flushWindow(url);
				/*
				 * $("#window-content").load(url, function() {
				 * layer.close(index); });
				 */
			}, function() {
			});
		},
		inLoad : function(url, item, param) {
			var index = layer.load(2, {
				shade : [ 0.1, '#fff' ]
			});
			if (platform.isNull(param)) {
				$(item).load(url, function() {
					layer.close(index);
				});
			} else {
				$(item).load(url, param, function() {
					layer.close(index);
				});
			}
		},
		alertDiv : function(areaId, width, height, title) {
			var index = layer.open({
				title : title,
				type : 1,
				closeBtn : 1,
				anim : 2,
				shadeClose : true, // 开启遮罩关闭
				skin : 'layui-layer-rim', // 加上边框
				area : [ width + 'px', height + 'px' ], // 宽高
				content : '<div id="' + areaId
						+ '" style="padding:20px"></div>'
			});
			return index;
		},
		alertSubmitDiv : function(title, divId, areaId, width, height, yesBack) {
			var index = layer.open({
				type : 1,
				title : title,
				shadeClose : true, // 开启遮罩关闭
				skin : 'layui-layer-rim', // 加上边框
				area : [ width + 'px', height + 'px' ], // 宽高
				id : divId, // 设定一个id，防止重复弹出
				resize : false,
				btn : [ '提交', '返回' ],
				btnAlign : 'c',
				content : '<div id="' + areaId
						+ '" style="padding:20px"></div>',
				yes : yesBack
			});
			return index;
		},
		alertmsg : function(msg, index) {
			layer.alert(msg, {
				time : 0,
				btn : [ '确定' ],
				yes : function(index) {
					layer.close(index);
				}
			})
		},
		ajaxPost : function(url, json, successBack) {
			$.ajax({
				type : "POST",
				url : url,
				data : json,
				dataType : "json",
				success : successBack
			});
		},
		changeApp : {
			uploadBackS : function(data, status) {
				if (!platform.isNull(data.msg)) {
					platform.alertmsg(data.msg);
				}
				if (!platform.isNull(data.data)) {
					$("#changeAppDivParam").find("#keyUrl").val(
							data.data.keyUrl);
				}
			},
			init : function() {
				$("#changeAppDivParam").off("change", "#keyFile").on(
						"change",
						"#keyFile",
						function() {
							var url = $("#changeAppDivParam").find("#keyUrl")
									.val();
							platform.myAjaxFileUpload(rootPath
									+ "/user/activity/changeUploadKey.shtml",
									this, {
										keyUrl : url
									}, platform.changeApp.uploadBackS,
									platform.fileUpload.uploadBackE);
						})
			},
			callback : function(index) {
				var json = platform.getFormJson("#changeAppDivParam");
				platform.ajaxPost(rootPath + "/user/activity/changeApp.shtml",
						json, platform.changeApp.postBack);
			},
			postBack : function(data) {
				if (data.status != 200) {
					layer.msg(data.msg);
				} else {
					layer.closeAll();
					layer.msg("修改成功");
				}
			}
		},
		apply : {
			list : {
				init : function() {
					$(".viewUrl").click(function() {
						var url = $(this).attr("url");
						layer.alert(url, {
							skin : 'layui-layer-molv' // 样式类名
							,
							closeBtn : 0
						});
					})
					$(".alertdiv")
							.click(
									function() {
										var param = {
											id : $(this).attr("activityId"),
											appSecret : $(this).attr(
													"appSecret"),
											appId : $(this).attr("appId"),
											keyUrl : $(this).attr("appUrl")
										};
										platform.alertSubmitDiv("修改公众号",
												"changeAppDiv",
												"changeAppDivParam", 450, 400,
												platform.changeApp.callback);
										platform
												.inLoad(
														rootPath
																+ "/user/activity/changeApp/page.shtml",
														"#changeAppDivParam",
														param);
									})
					/**
					 * 高级查询
					 */
					$("#activityApplyFindButton")
							.click(
									function() {
										var theactivityName = $(
												"#theactivityName").val();
										var theOrganCode = $("#theOrganCode")
												.val();

										var url = rootPath
												+ "/user/activity/list.shtml?theactivityName="
												+ theactivityName
												+ "&theOrganCode="
												+ theOrganCode
										platform.doGet(url);
									})
				//过渡策略高级查询					
				$("#activityApplyFindButtonForTransition")
							.click(
									function() {
										var theactivityName = $(
												"#theactivityName").val();
										var theOrganCode = $("#theOrganCode")
												.val();
										var islml = $("#islml").val();
										var url = rootPath
												+ "/user/activity/listForTransition.shtml?theactivityName="
												+ theactivityName
												+ "&theOrganCode="
												+ theOrganCode+"&islml="+islml
										platform.doGet(url);
									})

					/**
					 * 更改关联组织机构
					 */
					$(".table-striped")
							.find(".changeOrgan")
							.click(
									function() {
										var activityId = $(this).attr('name');
										$("#checkTheOrgan").find(
												"img[name='" + projectCode
														+ "']").css('display',
												'block');
										var index = layer
												.open({
													type : 1,
													skin : 'layui-layer-demo',
													closeBtn : 0,
													anim : 2,
													title : false,
													area : [ '450px', '300px' ],
													shadeClose : true,
													btn : [ '确定', '取消' ],
													content : $("#theOrganList")
															.html(),

													// 点击确定
													yes : function() {
														layer.close(index);
														var organCode = $(
																'.yesCheck')
																.attr('name');

														var url = rootPath
																+ "/user/activity/changeOrgan.shtml";
														$
																.post(
																		url,
																		{
																			id : activityId,
																			organCode : organCode
																		},
																		function(
																				data) {
																			layer
																					.alert(
																							data['result'],
																							{
																								skin : 'layui-layer-lan',
																								closeBtn : 0,
																								anim : 4
																							// 动画类型
																							});

																		},
																		'json')
													}
												});
									})

					$(document).on(
							'click',
							'.checkTheOrgan',
							function() {
								// 首先查看是否有已经选中的
								var obj = $(".yesCheck")
								var ylength = obj.length
								if (ylength >= 1) {
									$(obj).css('display', 'none');
									$(obj).addClass('noCheck').removeClass(
											'noCheck');
									$(this).parent().find("img").css('display',
											'block');
									$(this).parent().find("img").addClass(
											'yesCheck').removeClass('noCheck');
								} else {
									$(this).parent().find("img").css('display',
											'block');
									$(this).parent().find("img").addClass(
											'yesCheck').removeClass('noCheck')
								}

							});

					$(".fd_page li").off("click", "a")
							.on(
									"click",
									"a",
									function() {
										var theactivityName = $(
												"#theactivityName").val();
										var theOrganCode = $("#theOrganCode")
												.val();
										var page = $(this).attr("assignPage");
										if(platform.isNull(page)){
											return;
										}
										platform.doGet(platform.apply.list
												.getRequestFormsUrl(page,
														theactivityName,
														theOrganCode));
									})
									
									
						//项目申请--过渡策略--分页			
						$(".fd_page_Transition li").off("click", "a")
							.on(
									"click",
									"a",
									function() {
										var theactivityName = $(
												"#theactivityName").val();
										var theOrganCode = $("#theOrganCode")
												.val();
										var page = $(this).attr("assignPage");
										if(platform.isNull(page)){
											return;
										}
										platform.doGet(platform.apply.list
												.getRequestFormsUrlTransition(page,
														theactivityName,
														theOrganCode));
									})
									
									
					$(".new").find("button").click(function() {
						var url = $(this).attr("url");
						platform.doGet(url);
					})
				},
				getRequestFormsUrl : function(page, theactivityName,
						theOrganCode) {
					var url = rootPath + "/user/activity/list.shtml?current="
							+ page + "&theactivityName=" + theactivityName
							+ "&theOrganCode=" + theOrganCode;
					return url;
				},
				getRequestFormsUrlTransition : function(page, theactivityName,
						theOrganCode) {
					 var islml = $("#islml").val();
					var url = rootPath + "/user/activity/listForTransition.shtml?current="
							+ page + "&theactivityName=" + theactivityName
							+ "&theOrganCode=" + theOrganCode+"&islml="+islml;
					return url;
				}
				
				
			},
			request : function(url, that, param) {
				var parents = $(that).parents("#openDiv");
				if (parents.length == 1) {
					url = url.substring(0, url.lastIndexOf("/") + 1)
							+ "createa.shtml";
					if (!platform.required("#openDiv")) {
						return;
					}
					$.ajax({
						type : "POST",
						url : url,
						data : param,
						dataType : "json",
						success : function(data) {
							if (data.data.isUpdate == 'isUpdate') {
								$(
										"#currentSelect option[value='"
												+ data.data.id + "']").attr(
										"selected", "selected");
							} else {
								$(
										"<option value='" + data.data.id + "'>"
												+ data.data.name + "</option>")
										.appendTo("#currentSelect");
								$(
										"#currentSelect option[value='"
												+ data.data.id + "']").attr(
										"selected", "selected");
								$("#currentSelect").parent().find(".chosen-single").find("span").text(data.data.name);
							}
							var index = $("#currentSelect").attr("index");
							layer.close(index);
						}
					});
				} else {
					platform.doPost(url, param);
				}
			},
			create : {
				init : function() {
					$("#keyFile").change(
							function() {
								platform.fileUpload.upload(rootPath
										+ "/user/activity/uploadkey.shtml",
										'#keyFile', {
											keyUrl : $("#keyUrl").val()
										});
							});
					$("#startTime").keydown(function() {
						$(this).val();
					});
					$("#endTime").keydown(function() {
						$(this).val();
					});
					$("#accurate")
							.off("click", ".checkbox-inline a")
							.on(
									"click",
									".checkbox-inline a",
									function() {

										$("#currentSelect").removeAttr("id");
										$(this).parent().parent().find(
												"select").attr("id",
												"currentSelect");

										var page = $(this).attr("page");
										if(page=="tjjpcl"){
											var jpclDiv=$(this).parent().parent();
											var cloneDiv=jpclDiv.clone();
											cloneDiv.find(".btn-info").attr("page","scjpcl");
											cloneDiv.find(".btn-info").html("删除");
										
											cloneDiv.find("select").removeAttr("index");
											cloneDiv.find("select").removeAttr("id");
											cloneDiv.find(".chosen-container").remove()
											jpclDiv.find("select").removeAttr("id");
											jpclDiv.parent().append(cloneDiv);
											$('.container').chosen();
											cloneDiv.find(".chosen-container").attr("style","width:205px")
											return;
										}else if (page=="scjpcl"){
											$(this).parent().parent().remove();
											return;
										}
										var url = "";
										var title = $(this).html();
										var currentValue = $("#currentSelect")
												.val();
										if (platform.isNull(currentValue)
												&& (title == "查看" || title == "修改")) {
											layer.msg("请选择条目！");
											return;
										}
										var loopArr = [];
										loopArr
												.push([
														"rqdx",
														"/user/strategy/activity/apply/create.shtml",
														"/user/strategy/apply/update.shtml",
														"/user/strategy/apply/view.shtml",
														"人群定向" ]);
										loopArr
												.push([
														"yxhd",
														"/user/activity/type/apply/create.shtml",
														"/user/activity/apply/type/update.shtml",
														"/user/activity/apply/type/view.shtml",
														"营销活动" ]);
										loopArr
												.push([
														"hdlx",
														"/user/activity/apply/activityType.shtml",
														"/user/activity/toApplyEditPrizeAcivityType.shtml",
														"/user/activity/toApplyEditPrizeAcivityType.shtml?type=view",
														"活动类型" ]);
										loopArr
												.push([
														"jplx",
														"/user/prize/type/apply/create.shtml",
														"/user/prize/type/update.shtml",
														"/user/prize/type/view.shtml",
														"奖品类型" ]);
										loopArr
												.push([
														"jpcl",
														"/user/prizestrategy/apply/toAddStrategy.shtml",
														"/user/prizestrategy/toEditStranegyApply.shtml",
														"/user/prizestrategy/apply/view.shtml",
														"奖品策略" ]);
										var operate = [ "添加", "修改", "查看" ];
										out: for ( var i in loopArr) {
											var paramArr = loopArr[i];
											for ( var i in paramArr) {
												if (page == paramArr[0]) {
													if (title == operate[0]) {
														url = rootPath
																+ paramArr[1];
													} else if (title == operate[1]) {
														url = rootPath
																+ paramArr[2];
													} else if (title == operate[2]) {
														url = rootPath
																+ paramArr[3];
													}
													title = title + paramArr[4];
													break out;
												}
											}
										}
										var index = platform.alertDiv(
												"openDiv", 1200, 600, title);
										$("#currentSelect")
												.attr("index", index);
										var param = {
											id : currentValue
										};
										if (title.indexOf(operate[0]) > -1) {
											param = null;
										}
										if (!platform.isNull(currentValue)) {
											platform.inLoad(url, "#openDiv",
													param);
										} else {
											platform.inLoad(url, "#openDiv");
										}
									});
					
					
					//---------------------//过渡策略项目申请入口
					$("#accurateForTransition")
					.off("click", ".checkbox-inline a")
					.on(
							"click",
							".checkbox-inline a",
							function() {

								$("#currentSelect").removeAttr("id");
								$(this).parent().parent().find(
										"select").attr("id",
										"currentSelect");

								var page = $(this).attr("page");
								if(page=="tjjpcl"){
									var jpclDiv=$(this).parent().parent();
									var cloneDiv=jpclDiv.clone();
									cloneDiv.find(".btn-info").attr("page","scjpcl");
									cloneDiv.find(".btn-info").html("删除");
								
									cloneDiv.find("select").removeAttr("index");
									cloneDiv.find("select").removeAttr("id");
									cloneDiv.find(".chosen-container").remove()
									jpclDiv.find("select").removeAttr("id");
									jpclDiv.parent().append(cloneDiv);
									$('.container').chosen();
									cloneDiv.find(".chosen-container").attr("style","width:205px")
									return;
								}else if (page=="scjpcl"){
									$(this).parent().parent().remove();
									return;
								}
								var url = "";
								var title = $(this).html();
								var currentValue = $("#currentSelect")
										.val();
								if (platform.isNull(currentValue)
										&& (title == "查看" || title == "修改")) {
									layer.msg("请选择条目！");
									return;
								}
								var loopArr = [];
								loopArr
										.push([
												"rqdx",
												"/user/strategy/activity/apply/create.shtml",
												"/user/strategy/apply/update.shtml",
												"/user/strategy/apply/view.shtml",
												"人群定向" ]);
								loopArr
										.push([
												"yxhd",
												"/user/activity/type/apply/create.shtml",
												"/user/activity/apply/type/update.shtml",
												"/user/activity/apply/type/view.shtml",
												"营销活动" ]);
								loopArr
										.push([
												"hdlx",
												"/user/activity/apply/activityType.shtml",
												"/user/activity/toApplyEditPrizeAcivityType.shtml",
												"/user/activity/toApplyEditPrizeAcivityType.shtml?type=view",
												"活动类型" ]);
								loopArr
										.push([
												"jplx",
												"/user/prize/type/apply/create.shtml",
												"/user/prize/type/update.shtml",
												"/user/prize/type/view.shtml",
												"奖品类型" ]);
								loopArr
										.push([
												"jpcl",
												"/user/prizestrategy/apply/toAddStrategyForTransition.shtml",
												"/user/prizestrategy/toEditStranegyApplyForTransition.shtml",
												"/user/prizestrategy/apply/viewForTrantion.shtml",
												"奖品策略" ]);
								var operate = [ "添加", "修改", "查看" ];
								out: for ( var i in loopArr) {
									var paramArr = loopArr[i];
									for ( var i in paramArr) {
										if (page == paramArr[0]) {
											if (title == operate[0]) {
												url = rootPath
														+ paramArr[1];
											} else if (title == operate[1]) {
												url = rootPath
														+ paramArr[2];
											} else if (title == operate[2]) {
												url = rootPath
														+ paramArr[3];
											}
											title = title + paramArr[4];
											break out;
										}
									}
								}
								var index = platform.alertDiv(
										"openDiv", 1200, 600, title);
								$("#currentSelect")
										.attr("index", index);
								var param = {
									id : currentValue
								};
								if (title.indexOf(operate[0]) > -1) {
									param = null;
								}
								if (!platform.isNull(currentValue)) {
									platform.inLoad(url, "#openDiv",
											param);
								} else {
									platform.inLoad(url, "#openDiv");
								}
							});
					//----------------------
					$(".form-group")
							.find("input[type='text']")
							.change(
									function() {
										var index = $(this).attr("index");
										var thisValue = $(this).val();
										if (index < 4
												&& !platform.isNull(thisValue)) {
											index++;
											var input = $(".form-group").find(
													"input[index='" + index
															+ "']");
											input.removeAttr("disabled");
										}
										if (platform.isNull(thisValue)) {
											index++;
											for (var index; index < 5; index++) {
												var input = $(".form-group")
														.find(
																"input[index='"
																		+ index
																		+ "']");
												input.attr("disabled",
														"disabled");
												input.val("");
											}
										}

									});
					$(".form-group").find("input[type='text']").focus(
							function() {
								var index = $(this).attr("index");
								var thisValue = $(this).val();
								if (index < 4) {
									index++;
									var input = $(".form-group").find(
											"input[index='" + index + "']");
									input.removeAttr("disabled");
								}

							});
					$(".form-group")
							.find("input[type='text']")
							.blur(
									function() {
										var index = $(this).attr("index");
										var thisValue = $(this).val();
										if (index < 4
												&& platform.isNull(thisValue)) {
											index++;
											for (var index; index < 5; index++) {
												var loop = $(".form-group")
														.find(
																"input[index='"
																		+ index
																		+ "']");
												loop.attr("disabled",
														"disabled");
												loop.val("");
											}
										}

									});
					$("#accurate").off("change", "select").on("change",
							"select", function() {
								var selects = $(this).val();
								if (!platform.isNull(selects)) {
									$(this).removeClass("main-error");
								}
							});
					
					$("#accurateForTransition").off("change", "select").on("change",
							"select", function() {
								var selects = $(this).val();
								if (!platform.isNull(selects)) {
									$(this).removeClass("main-error");
								}
							});
					
					$("#applyForm").find("input").change(function() {
						var input = $(this).val();
						if (!platform.isNull(input)) {
							$(this).removeClass("main-error");
						}
					});
					$("#accurate").off("change", "input[type='radio']").on(
							"change",
							"input[type='radio']",
							function() {
								var selects = $(this).parents(".form-group")
										.find(".use-select");
								if ($(this).val() == 1) {
									selects.removeAttr("disabled");
								} else {
									selects.attr("disabled", "disabled");
								}
							});
					$("#accurateForTransition").off("change", "input[type='radio']").on(
							"change",
							"input[type='radio']",
							function() {
								var selects = $(this).parents(".form-group")
										.find(".use-select");
								if ($(this).val() == 1) {
									selects.removeAttr("disabled");
								} else {
									selects.attr("disabled", "disabled");
								}
							});
					
					
					$("#accurate")
							.off("click", "a")
							.on(
									"click",
									"a",
									function() {
										if ($(this).hasClass("btn-primary")) {// 再来一条
											var container = $(this).parents(
													"#accurate .maincontainer")
													.clone();
											/* container.find(".btn-primary").remove(); */
											container.find(".hide")
											.removeClass("hide");
											container.find(".chosen-container").remove();
											container.find(".container").attr("style","width: 205px;")
											container.find(".container").chosen();
											container.find(".chosen-container").attr("style","width:205px")
											container.find(".first-group")
													.removeClass("hidden");
											container.find("input[name='id']")
													.attr("value", "");
											container
													.find(".first-group")
													.find(
															"input[name='isDefault']")
													.val(1);
											container
													.find(".first-group")
													.find("select option:first")
													.prop("selected",
															'selected');
											container.find("select")
													.removeClass("main-error");
											container.find(".btn-danger")
													.removeClass("hidden");
											$("#accurate").append(container);
											$(this).next().remove();
											if ($(this).parent().find(
													".btn-info").length > 0) {
												$(this).next().remove();
											}
											if ($(this).parent().find(
													".btn-warning").length > 0) {
												$(this).next().remove();
											}
											$(this).remove();
											var param = container.offset();
											$("html,body").animate(
													{
														scrollTop : param.top
																- 100 + "px"
													}, 500);
										} else if ($(this).hasClass("submit")) {// 提交
											var thisVal = $("#applyForm").find(
													"input[name='endDomain']")
													.val();
											if (!platform.isNull(thisVal)) {
												var reg = new RegExp(
														"[0-9a-zA-Z\.\_]");
												var isTrue = reg.test(thisVal);
												if (!isTrue) {
													$("input[name='endDomain']")
															.addClass(
																	"main-error");
													layer.msg("请输入英文简拼");
													return;
												}
											}
											var json = platform
													.getFormJson("#applyForm");
											var arr = [];
											$("#accurate").find(".maincontainer").each(function(index,item) {
												var row = $(item).find(".row");
												var param={};
												$(row).each(function(rowIndex,rowItem){
													var type=$(rowItem).attr("type");
													if(!platform.isNull(type) && type=="jpcl"){
														var arr=[]
														var rowParam={};
														$(rowItem).find("select").each(function(jpclIndex,jpclItem){
															var value=$(jpclItem).val();
															if(!platform.isNull(value)){
																arr.push(value);
															}
														})
														if(arr.length>1){
															rowParam={'strategyPrizes':arr};
														}else{
															rowParam={'strategyPrizes':arr[0]};
														}
														param=$.extend({},param,rowParam);
													}else{
														var rowJson = platform.getFormJson(rowItem);
														if(!platform.isNull(rowJson)){
															param=$.extend({},param,rowJson);
														}
													}
												})
												arr.push(param);
											});
											json.accurate = JSON.stringify(arr);
											var url = $("#applyForm").attr(
													"url");
											if ($(this).hasClass("btn-info")) {
												url = url.substring(0, url
														.lastIndexOf("/") + 1)
														+ "review.shtml";
												var reviewCallback = function(
														data, status) {
													if (data.status == 200) {
														platform.doPostO(url,
																json);
													} else {
														platform
																.alertmsg(data.msg);
													}
												}
												platform
														.myAjaxFileUpload(
																rootPath
																		+ "/user/activity/uploadkeyto15.shtml",
																'#keyFile',
																{
																	keyUrl : $(
																			"#keyUrl")
																			.val()
																},
																reviewCallback,
																platform.fileUpload.uploadBackE);
											} else {
												platform.doPostO(url, json);
											}
										} else if ($(this).hasClass(
												"btn-danger")) {// 删除
											var container = $(this).parents(
													"#accurate").find(
													".maincontainer");
											if (container.length > 1) {
												var add = '<a class="btn btn-primary main-mr main-margin-top width-100">增加定向</a>';
												var success = '<a class="btn btn-success submit main-mr main-margin-top width-100">完成</a>';
												var review = '<a class="btn btn-info main-mr main-margin-top width-100">审核通过</a>';
												var danger = '<a class="btn btn-warning main-margin-top main-mr width-100">不通过</a>';
												var prev = $(this)
														.parents(
																"#accurate .maincontainer")
														.prev(".maincontainer");
												var index = $(this)
														.parents(
																"#accurate .maincontainer")
														.next(".maincontainer")
														.index();
												if (index == -1) {
													prev.find(".btn-danger")
															.before(add)
															.before(success);
												}
												if ($(this).parent().find(
														".btn-info").length > 0) {
													prev.find(".btn-danger")
															.before(review)
												}
												if ($(this).parent().find(
														".btn-warning").length > 0) {
													prev.find(".btn-danger")
															.before(danger)
												}
												$(this)
														.parents(
																"#accurate .maincontainer")
														.remove();
												var param = prev.offset();
												$("html,body")
														.animate(
																{
																	scrollTop : param.top
																			- 100
																			+ "px"
																}, 500);
											}
										} else if ($(this).hasClass(
												"btn-warning")) {// 不通过
											var url = $("#applyForm").attr(
													"url");
											url = url.substring(0, url
													.lastIndexOf("/") + 1)
													+ "failed.shtml";
											var json = {
												id : $("#id").val()
											};
											platform.doPost(url, json);
										} else if ($(this).hasClass("geturl")) {// 获得URL
											var url = $("#applyForm").attr(
													"url");
											url = url.substring(0, url
													.lastIndexOf("/") + 1)
													+ "getUrl.shtml";
											var idVal = $("#id").val();
											if (platform.isNull(idVal)) {
												layer.msg("请先保存活动信息");
												return;
											}
											var json = {
												id : idVal
											};
											$.ajax({
												type : "POST",
												url : url,
												data : json,
												dataType : "json",
												success : function(data) {
													layer.msg(data.data.url, {
														time : 5000,
														icon : 6
													});
												}
											});
										}
									});
					
					//---------------过渡策略
					$("#accurateForTransition")
					.off("click", "a")
					.on(
							"click",
							"a",
							function() {
								if ($(this).hasClass("btn-primary")) {// 再来一条
									var container = $(this).parents(
											"#accurateForTransition .maincontainer")
											.clone();
									/* container.find(".btn-primary").remove(); */
									container.find(".hide")
									.removeClass("hide");
									container.find(".chosen-container").remove();
									container.find(".container").attr("style","width: 205px;")
									container.find(".container").chosen();
									container.find(".chosen-container").attr("style","width:205px")
									container.find(".first-group")
											.removeClass("hidden");
									container.find("input[name='id']")
											.attr("value", "");
									container
											.find(".first-group")
											.find(
													"input[name='isDefault']")
											.val(1);
									container
											.find(".first-group")
											.find("select option:first")
											.prop("selected",
													'selected');
									container.find("select")
											.removeClass("main-error");
									container.find(".btn-danger")
											.removeClass("hidden");
									$("#accurateForTransition").append(container);
									$(this).next().remove();
									if ($(this).parent().find(
											".btn-info").length > 0) {
										$(this).next().remove();
									}
									if ($(this).parent().find(
											".btn-warning").length > 0) {
										$(this).next().remove();
									}
									$(this).remove();
									var param = container.offset();
									$("html,body").animate(
											{
												scrollTop : param.top
														- 100 + "px"
											}, 500);
								} else if ($(this).hasClass("submit")) {// 提交
									var thisVal = $("#applyForm").find(
											"input[name='endDomain']")
											.val();
									if (!platform.isNull(thisVal)) {
										var reg = new RegExp(
												"[0-9a-zA-Z\.\_]");
										var isTrue = reg.test(thisVal);
										if (!isTrue) {
											$("input[name='endDomain']")
													.addClass(
															"main-error");
											layer.msg("请输入英文简拼");
											return;
										}
									}
									var json = platform
											.getFormJson("#applyForm");
									var arr = [];
									$("#accurateForTransition").find(".maincontainer").each(function(index,item) {
										var row = $(item).find(".row");
										var param={};
										$(row).each(function(rowIndex,rowItem){
											var type=$(rowItem).attr("type");
											if(!platform.isNull(type) && type=="jpcl"){
												var arr=[]
												var rowParam={};
												$(rowItem).find("select").each(function(jpclIndex,jpclItem){
													var value=$(jpclItem).val();
													if(!platform.isNull(value)){
														arr.push(value);
													}
												})
												if(arr.length>1){
													rowParam={'strategyPrizes':arr};
												}else{
													rowParam={'strategyPrizes':arr[0]};
												}
												param=$.extend({},param,rowParam);
											}else{
												var rowJson = platform.getFormJson(rowItem);
												if(!platform.isNull(rowJson)){
													param=$.extend({},param,rowJson);
												}
											}
										})
										arr.push(param);
									});
									json.accurate = JSON.stringify(arr);
									var url = $("#applyForm").attr(
											"url");
									if ($(this).hasClass("btn-info")) {
										url = url.substring(0, url
												.lastIndexOf("/") + 1)
												+ "review.shtml";
										var reviewCallback = function(
												data, status) {
											if (data.status == 200) {
												platform.doPostO(url,
														json);
											} else {
												platform
														.alertmsg(data.msg);
											}
										}
										platform
												.myAjaxFileUpload(
														rootPath
																+ "/user/activity/uploadkeyto15.shtml",
														'#keyFile',
														{
															keyUrl : $(
																	"#keyUrl")
																	.val()
														},
														reviewCallback,
														platform.fileUpload.uploadBackE);
									} else {
										platform.doPostO(url, json);
									}
								} else if ($(this).hasClass(
										"btn-danger")) {// 删除
									var container = $(this).parents(
											"#accurateForTransition").find(
											".maincontainer");
									if (container.length > 1) {
										var add = '<a class="btn btn-primary main-mr main-margin-top width-100">增加定向</a>';
										var success = '<a class="btn btn-success submit main-mr main-margin-top width-100">完成</a>';
										var review = '<a class="btn btn-info main-mr main-margin-top width-100">审核通过</a>';
										var danger = '<a class="btn btn-warning main-margin-top main-mr width-100">不通过</a>';
										var prev = $(this)
												.parents(
														"#accurateForTransition .maincontainer")
												.prev(".maincontainer");
										var index = $(this)
												.parents(
														"#accurateForTransition .maincontainer")
												.next(".maincontainer")
												.index();
										if (index == -1) {
											prev.find(".btn-danger")
													.before(add)
													.before(success);
										}
										if ($(this).parent().find(
												".btn-info").length > 0) {
											prev.find(".btn-danger")
													.before(review)
										}
										if ($(this).parent().find(
												".btn-warning").length > 0) {
											prev.find(".btn-danger")
													.before(danger)
										}
										$(this)
												.parents(
														"#accurateForTransition .maincontainer")
												.remove();
										var param = prev.offset();
										$("html,body")
												.animate(
														{
															scrollTop : param.top
																	- 100
																	+ "px"
														}, 500);
									}
								} else if ($(this).hasClass(
										"btn-warning")) {// 不通过
									var url = $("#applyForm").attr(
											"url");
									url = url.substring(0, url
											.lastIndexOf("/") + 1)
											+ "failed.shtml";
									var json = {
										id : $("#id").val()
									};
									platform.doPost(url, json);
								} else if ($(this).hasClass("geturl")) {// 获得URL
									var url = $("#applyForm").attr(
											"url");
									url = url.substring(0, url
											.lastIndexOf("/") + 1)
											+ "getUrl.shtml";
									var idVal = $("#id").val();
									if (platform.isNull(idVal)) {
										layer.msg("请先保存活动信息");
										return;
									}
									var json = {
										id : idVal
									};
									$.ajax({
										type : "POST",
										url : url,
										data : json,
										dataType : "json",
										success : function(data) {
											layer.msg(data.data.url, {
												time : 5000,
												icon : 6
											});
										}
									});
								}
							});
					
				}
			}
		},
		setIndexChecked : function() {
			$("#sideNav").find("li").each(
								function(index, item) {
								var url = $(item).find("a").attr("url");
								var currentUrl = location.href
										.substring(rootPath.length);
//								var index = currentUrl.indexOf("?");
								var hoverUrl = currentUrl;
//								if (index > 0) {
//									hoverUrl = currentUrl.substring(0, index);
//								}
								if (!platform.isNull(url)
										&& url.indexOf(hoverUrl) > 0) {
									platform.changeMenu(item);
									$(this).addClass("select-hover");
									$(item).find("a").attr("style","padding-left: 30%; font-size: 13px;color:white");
								}
							});
		},
		prizeSetting : {
			load : function() {
				$(".submit").find("button").click(
						function() {
							var prizeSetingNameVar = $("#prizeSettingName")
									.val();
							var virtualPrizeVar = platform
									.getCheckBoxParam("prize");
							var objectPrizeVar = platform.getGroupParam(
									"#object-prize", ".add-area");
							var idValue = $("#id").val();
							var param = {
								id : idValue,
								prizeSetingName : prizeSetingNameVar,
								virtualPrize : virtualPrizeVar,
								objectPrize : objectPrizeVar
							};
							var url = $("#prizeSetingName").attr("url");
							platform.apply.request(url, this, param);
						});
				$(document).off("change", 'input[type=number]').on("change",
						'input[type=number]', function() {
							if (!platform.isPostiveNumber($(this).val())) {
								$(this).val(0);
								platform.warn('请输入大于等于0的数字', this);
							}
						});
				$(document).off("blur", 'input[type=number]').on("blur",
						'input[type=number]', function() {
							if (!/^\d+$/.test($(this).val())) {
								$(this).val(0);
							}
						});
				$(document)
						.off("click", ".inline-div img")
						.on(
								"click",
								".inline-div img",
								function() {
									var className = $(this).attr("class");
									if (className == "add") {
										var selected = $("#select").children()
												.clone();
										var clone = $(this)
												.parents(".add-area").clone();
										$(clone).find("input")
												.each(
														function(index, item) {
															var name = $(item)
																	.attr(
																			"name");
															if (name == "prizeName") {
																$(item)
																		.after(
																				selected);
																$(item)
																		.remove();
																$(selected)
																		.editableSelect();
															}
															$(item).val("");
														});
										$("#object-prize").append(clone);
										$(this)
												.prop(
														"src",
														rootPath
																+ "/resources/image/activity/image/sc.png");
										$(this).prop("class", 'minus');
									} else if (className == "minus") {
										var length = $("#object-prize").find(
												".add-area").length;
										if (length > 1) {
											$(this).parents(".add-area")
													.remove();
										}
									}
								});
			},
			page : function() {

			}
		},
		isPostiveNumber : function(number) {
			var bool = isNaN(number);
			if (!bool && number >= 0) {
				return true;
			}
		},
		warn : function(msg, selecter) {
			layer.tips(msg, selecter, {
				tips : [ 1, '#f19e3c' ],
				time : 4000
			});
		},
		getCheckBoxParam : function(name) {
			var temp = "";
			$('input[name="' + name + '"]:checked').each(function() {
				temp = temp + $(this).val() + ";";
			});
			return temp;
		},
		getJsonParam : function(id, selecter) {
			var divs = $(id).find(selecter);
			var arr = [];
			$(divs).each(function(index, item) {
				var json = platform.getFormJson(item);
				if (!platform.isNull(json)) {
					arr.push(json);
				}
			});
			return JSON.stringify(arr);
		},
		getInputsArrJson : function(inputs,key) {
			var resultString = "{"+key+":";
			var arr=[];
			for ( var i in inputs) {
				var value = $(inputs[i]).val();
				arr.push(value);
			}
			resultString+=JSON.parse(arr);
			resultString+="}";
			var json = eval('(' + jsonString + ')');
			return json;
		},
		getInputsJson : function(inputs) {
			var resultString = "{";
			for ( var i in inputs) {
				resultString += platform.getGroupJson(inputs[i]);
			}
			if (resultString.length <= 1) {
				return null;
			}
			var jsonString = resultString.substring(0, resultString.length - 1)
					+ "}";
			var json = eval('(' + jsonString + ')');
			return json;
		},
		getGroupParam : function(id, selecter) {
			var divs = $(id).find(selecter);
			var arr = [];
			$(divs).each(function(index, item) {
				var json = platform.getFormJson(item);
				if (!platform.isNull(json)) {
					arr.push(json);
				}
			});
			return JSON.stringify(arr);
		},
		clearForm : function(item) {
			var inputs = platform.getForm(item);
			platform.clearValue(inputs);
		},
		clearValue : function(inputs){
			$(inputs).each(function(index, item) {
				var value = $(item).val("");
			});
		},
		getFormJson : function(item) {
			var inputs = platform.getForm(item);
			var json = platform.getInputsJson(inputs);
			return json;
		},
		getForm : function(item) {
			var arr = [];
			arr.push($(item).find("textarea"));
			arr.push($(item).find("input"));
			arr.push($(item).find("select"));
			return arr;
		},
		getGroupJson : function(inputs) {
			resultString = "";
			$(inputs).each(
					function(index, item) {
						var name = $(item).attr("name");
						var value = "";
						var radiovalue = $(item).val();
						//选中的复选框的值
						if(item.type=="checkbox"){
							if(item.checked){
								value = $(item).val();
							}else{
								value="2";
							}
						}else if(item.type=="radio"){
							if(item.checked){
								value = $(item).val();
							}
						} 
						else{
							value = $(item).val();
						}
				        //获取选中的单选框的值
						
						
						
						if(value!=null&&value!=""){
						if(value.indexOf('\n') >=0){
							value=value.replace(/\n/g,"<br />");
						}
						}
						
						if (!platform.isNull(value)) {
							resultString = resultString + "\"" + name + "\":\""
									+ value + "\","
						}
						
					});
			return resultString;
		},
		getFormParam : function(id) {
			$(id).serialize();
		},
		getRequestLampUrl : function(page,type) {
			return rootPath + "/account/lamp.shtml?isCount=true&current=" + page+"&type="+type;
		},
		getRequestSourceUrl : function(page,MaterialSourcesName,BrandsName) {
			return rootPath + "/user/materialsource/sourcelist.shtml?isCount=true&current=" + page
			+"&MaterialSourcesName=" + MaterialSourcesName + "&BrandsName="+ BrandsName;
		},
		getRequestFormsUrl : function(page) {
			return rootPath + "/account/forms.shtml?isCount=true&current=" + page
					+ "&stage=" + $("#stage").val() + "&province="
					+ $("#province").val() + "&device=" + $("#device").val()
					+ "&sex=" + $("#sex").val() + "&date="
					+ $("#date-range2").val() + "&" + platform.getProjectCode()+platform.getType();
		},
		isNull : function(obj) {
			if (obj != undefined && obj != null && obj != "") {
				return false;
			}
			return true;
		},
		getRequestParam : function(url) {
			if (url.indexOf("isCount=true") > -1) {
				var requestParam = Math.floor(Math.random() * 100) + "&"
						+ platform.getParam();
				if (url.indexOf("?") > 0) {
					requestParam = "&r=" + requestParam;
				} else {
					requestParam = "?r=" + requestParam;
				}
				return url + requestParam;
			}
			return url;
		},
		getParam : function() {
			return platform.getProjectCode() + platform.getType()
					+ platform.getDateRange();
		},
		getProjectCode : function() {
			var project = document.getElementById("projectCode");
			if (platform.isNull(project)) {
				project = parent.document.getElementById("projectCode");
			}
			var projectCode = project.value;
			var isEnd=projectCode.endsWith(",");
			var index = projectCode.lastIndexOf(",");
			if (isEnd==true && index != -1) {
				projectCode = projectCode.substring(0, index);
			}
			return "projectCode=" + projectCode;
		},
		getDefaultElement : function(element) {
			if (platform.isNull(element)) {
				return "#window-content";
			}
			return element;
		},
		scrollTop : function(num) {
			if (platform.isNull(num)) {
				num = 0
			}
			document.documentElement.scrollTop = num;
		},
		toCache :function(){
			$.ajax({
				type : "post",
				dataType : "json",
				url : rootPath + '/account/toCache.shtml',
				data : platform.getParam(),
				success : function(data) {
				}
			});
		},
		load : function(url, element) {
			var src = platform.getRequestParam(url);
			// platform.flushWindow(src);
			$.ajaxSetup({
				cache : false
			});
			element = platform.getDefaultElement(element);
			$(element).load(src);
			platform.scrollTop();
		},
		oldProjectCode : "",
		refushTree : function() {
			var treeObj = $.fn.zTree.getZTreeObj("treeDemo");
			/* treeObj.expandAll(false) */
			var nodes = treeObj.getCheckedNodes(true);
			var selectBatchId = "";
			for (var i = 0; i < nodes.length; i++) {
				if (nodes[i].isParent) {
					continue;
				}
				selectBatchId += nodes[i].id + ",";
			}
			$("#projectCode").val(selectBatchId);
			$("#menuArea").hide();
			if (selectBatchId != platform.oldProjectCode) {// 刷新页面
				platform.oldProjectCode = selectBatchId;
				platform.toCache();
				var url=location.href;
/*				$("#sideNav").find("li").each(
						function(index, item) {
							if ($(item).hasClass("select-hover")) {
								var url = $(item).find("a").attr("url");*/
								if (!platform.isNull(url)
										&& url.indexOf("isCount=true") > -1) {
									url=location.href.substring(0,location.href.indexOf("isCount=true")+12);
									platform.flushWindow(url);
								}
//							}
//						});
			}
		},
		doGet : function(url, element) {
			var src = platform.getRequestParam(url);
			element = platform.getDefaultElement(element);
			platform.myPost(src, "", element);
		},
		doPost : function(url, param, element) {
			var src = url;// platform.getRequestParam(url);
			element = platform.getDefaultElement(element);
			if (!platform.required(element)) {
				return;
			}
			platform.myPost(src, param, element);
		},
		doPostO : function(url, param, element) {
			element = platform.getDefaultElement(element);
			if (!platform.required(element)) {
				return;
			}
			platform.myPost(url, param, element);
		},
		myPost : function(src, param, element) {
			if (platform.isNull(param)) {
				window.location.href=src;
				return;
			}
			var temp = document.createElement("form");
			temp.action = src;
			temp.method = "post";
			temp.style.display = "none";
			for ( var x in param) {
				var opt = document.createElement("input");
				opt.name = x;
				opt.value = param[x];
				temp.appendChild(opt);
			}
			document.body.appendChild(temp);
			temp.submit();
			// return temp;
			/*
			 * } $.ajaxSetup({ cache : false }); var index = platform.close();
			 * $(element).load(src, param, function(response, status, xhr) {
			 * platform.open(index, response); }); platform.scrollTop();
			 */
		},

		close : function() {
			var width = $("#window-content").width() / 2 + 210;
			var height = document.documentElement.clientHeight / 2;
			var index = layer.load(2, {
				offset : [ height + "px", width + "px" ],
				shade : [ 0.1, '#fff' ]
			});
			$("#window-content").hide();
			/*
			 * $("#header").hide(); $("#content").hide();
			 */
			return index;
		},
		open : function(index, response) {
			layer.close(index);
			if (response.indexOf("<title>登录</title>") >= 0) {
				location.href = rootPath + "/account/login.shtml";
			} else {
				$("#window-content").show();
				/*
				 * $("#header").show(); $("#content").show();
				 */
			}
		},
		splitTitle : function() {
			var trlength = $("#prizeLabel tr").length;
			// 获取第一行的对象
			// var trOne = $('#prizeLabel tr:eq(1)');

			for (var i = 1; i < trlength; i++) {
				// 获取第一行第一列的对象
				var tdOne = $("#prizeLabel tr:eq(" + i + ") td:eq(2)");
				// 获取第一列的值
				var text = $(tdOne).text();
				var text1 = text.split("。");
				if (text1.length > 1) {
					var text11 = text1[0].split("，")
					if (!text11.length == 0) {
						var s1 = text11[0]
						var s2 = text11[1]
						$("#prizeLabel tr:eq(" + i + ") td:eq(2) #span1").text(
								s1 + "，");
						$("#prizeLabel tr:eq(" + i + ") td:eq(2) #span2").text(
								s2 + "。");
					}
					var text12 = text1[1].split("，")
					if (!text12.length == 0) {
						var s3 = text12[0]
						var s4 = text12[1]
						$("#prizeLabel tr:eq(" + i + ") td:eq(2) #span3").text(
								s3 + "，");
						$("#prizeLabel tr:eq(" + i + ") td:eq(2) #span4").text(
								s4 + "。");

					}
				}
			}
		},
		findAllMaterialSource:function(){
			$
			.post(
					rootPath + "/user/material/findAllMaterialSource.shtml",
					{},
					function(data) {
						var str="<option value='' selected>---请选择素材源---</option>";
						var sourceId = $("#prizeMaterialSource").val();
						$(data).each(
										function(index, dom) {
											if (sourceId == dom['id']) {
												 str += "<option selected='selected' value='"
														+ dom['id']
														+ "'>"
														+ dom['NAME']
														+ "</option>";
											} else {
													str += "<option value='"
														+ dom['id']
														+ "'>"
														+ dom['NAME']
														+ "</option>";
											}
											
										})
										$("#materialSourceId").html(str);
						$('.searchClass').chosen();
					})
		},
		
		findAllClassify : function() {
			$
					.post(
							rootPath + "/user/material/findClassifyAjax.shtml",
							{},
							function(data) {
								$(data)
										.each(
												function(index, dom) {

													var category = $(
															"#categoryForClassify")
															.val();
													if (category == dom['id']) {
														var str = "<option selected='selected' value='"
																+ dom['id']
																+ "'>"
																+ dom['className']
																+ "</option>";
													} else {
														var str = "<option value='"
																+ dom['id']
																+ "'>"
																+ dom['className']
																+ "</option>";
													}
													$("#prizeMaterialCategory")
															.append(str);
												})
							})
		},
		splitContent : function() {
			var trlength = $("#prizeLabel tr").length;
			for (var i = 1; i < trlength; i++) {
				var tdOne = $("#prizeLabel tr:eq(" + i + ") td:eq(3)");
				var text = $(tdOne).text();
				var text1 = text.split("，")
				for (var j = 0; j < text1.length; j++) {
					if (j < text1.length - 1) {
						$("#prizeLabel tr:eq(" + i + ") td:eq(3)").append(
								"<span>" + text1[j] + "，</span><br/>");
					} else {

						$("#prizeLabel tr:eq(" + i + ") td:eq(3)").append(
								"<span>" + text1[j] + "</span><br/>");
					}
				}

			}
		},

		findLabelType : function() {
			var url = rootPath + "/user/label/findLabelType.shtml"
			$.post(url, {}, function(data) {
				$(data).each(
						function(index, dom) {
							var type = $("#labeltype1").val();
							if (type == dom['itemId']) {
								var str = "<option selected='selected' value='"
										+ dom['itemId'] + "'>--"
										+ dom['itemName'] + "--</option>"
							} else {
								var str = "<option value='" + dom['itemId']
										+ "'>--" + dom['itemName']
										+ "--</option>"
							}
							$("#labeltype").append(str);
						});
			})
		},

		strToObj : function(str) {
			str = str.replace(/&/g, "','");
			str = str.replace(/=/g, "':'");
			str = "({'" + str + "'})";
			obj = eval(str);
			return obj;
		},

		getRequestActivityTypeUrl : function(page,typeName) {
			return rootPath + "/user/activity/activityType.shtml?current="
			+ page+"&typeName="+typeName;
		},
		getRequestClassifyUrl : function(page, className, payWill, isDefault) {
			return rootPath + "/prize/electicprize.shtml?current=" + page
					+ "&className=" + className + "&payWill=" + payWill
					+ "&isDefault=" + isDefault;
		},
		getRequestMaterialUrl : function(page, prizeName, prizeClassifyid,
				createTimeBeginAndEnd) {

			return rootPath + "/user/material/materiallist.shtml?current="
					+ page + "&prizeName=" + prizeName + "&prizeClassify.id="
					+ prizeClassifyid + "&createTimeBeginAndEnd="
					+ createTimeBeginAndEnd;
		},

		getRequestMaterialUrl2 : function(page2, prizeName, prizeClassifyid,
				createTimeBeginAndEnd, flag, organCode) {
			return rootPath + "/user/material/materiallist.shtml?current2="
					+ page2 + "&prizeName=" + prizeName + "&prizeClassify.id="
					+ prizeClassifyid + "&createTimeBeginAndEnd="
					+ createTimeBeginAndEnd + "&flag=" + flag + "&organCode="
					+ organCode;
		},

		getRequestRealPrizeUrl : function(page, prizeName, level, datestr) {
			return rootPath + "/prize/realprize.shtml?current=" + page
					+ "&prizeName=" + prizeName + "&level=" + level
					+ "&datestr=" + datestr;
		},
		getRequestLabellUrl : function(page, labeltitle, labeltype) {
			return rootPath + "/user/label/labellist.shtml?current=" + page
					+ "&label_title=" + labeltitle + "&type=" + labeltype;
		},
		getCodelUrl : function(page, date, project, select) {
			return rootPath + "/account/codeAnaly.shtml?current=" + page
					+ "&date=" + date + "&project=" + project + "&stage="
					+ select;
		},
		getCodelRateUrl : function(page, date, project, select) {
			return rootPath + "/account/codeRate.shtml?current=" + page
					+ "&date=" + date + "&project=" + project + "&stage="
					+ select;
		},
		getPublicManager : function(page, AppId, project) {
			return rootPath + "/account/publicmanager.shtml?current=" + page
					+ "&AppId=" + AppId + "&project=" + project;
		},
		getMaterialMangagerUrl : function(page, material, project) {
			return rootPath + "/user/material/materialmanager.shtml?current="
					+ page + "&material=" + material + "&project=" + project;
		},
		getRequestStrategyUrl : function(page, strategyName, theTime,
				projectName, theConnect, theOnLine) {
			return rootPath + "/user/prizestrategy/list.shtml?current=" + page
					+ "&strategyName=" + strategyName + "&theTime" + theTime
					+ "&projectName=" + projectName + "&theConnect="
					+ theConnect + "&theOnLine=" + theOnLine;
		},
		
		getRequestStrategyUrllml : function(page, strategyName, theTime,
				projectName, theConnect, theOnLine) {
			 var islml = $("#islml").val();
			return rootPath + "/user/prizestrategy/listForTransition.shtml?current=" + page
					+ "&strategyName=" + strategyName + "&theTime" + theTime
					+ "&projectName=" + projectName + "&theConnect="
					+ theConnect + "&theOnLine=" + theOnLine+"&islml="+islml;
		},
		getMaterialUrl : function(page, material, project) {
			return rootPath + "/user/prizestrategy/list.shtml?current=" + page
					+ "&strategyName=" + strategyName + "&theTime" + theTime
					+ "&projectName=" + projectName + "&theConnect="
					+ theConnect + "&theOnLine=" + theOnLine;
		},
		getRequestApplyUrl : function(page) {
			return rootPath + "/user/new/apply/activityCenter.shtml?current="
					+ page;
		},

		getRequestInnerUrl : function(page, dateStr,projectCode) {
			return rootPath + "/activity/innerport.shtml?isCount=false&current=" + page
					+ "&dateStr=" + dateStr+"&projectCode="+projectCode;
		},

		//风控数据
		getRequestRiskControlUrl:function( projectCode, projectName, riskGrade, page,  dateStr){
			return rootPath + "/riskControl/list.shtml?isCount=true&page=" + page
			+ "&dateStr=" + dateStr+"&riskGrade="+riskGrade;
		},
		getRequestRedPacketRecordUrl : function(page, type, redId,fromType) {
			return rootPath + "/account/redpacketcount.shtml?isCount=true&current=" + page
					+ "&type=" + type + "&redId=" + redId + "&fromType=" + fromType;
		},

		deleteError : function() {

			layer.alert("您不能删除有其他引用的信息（请检查是否有其他资源引用此资源）", {
				/* offset : [ '50%', '40%' ], */
				time : 0 // 不自动关闭
				,
				btn : [ '确定' ],
				yes : function(index) {
					layer.close(index);
				}
			})
		},

		// 查找商业模式
		findPatten : function() {
			var url = rootPath + "/prize/findPatten.shtml";
			var param = {};
			$.post(url, param, function(data) {
				var str = "";
				$(data).each(
						function(index, dom) {
							// var patten=${prizeClassify.patten}
							var patten = $("#thepatten").val();
							if (patten == dom['itemId']) {
								str += "<option selected='selected' value='"
										+ dom['itemId'] + "'>"
										+ dom['itemName'] + "</option>"
							} else {
								str += "<option value='" + dom['itemId'] + "'>"
										+ dom['itemName'] + "</option>"
							}

						})
				$("#patten").append(str);

			}, "json");
		},

		// 查询是否付费
		findPayWill : function() {
			var url = rootPath + "/prize/findPayWill.shtml";
			var param = {};
			$.post(url, param, function(data) {
				var str = "";
				$(data).each(
						function(index, dom) {
							var paywill = $("#prizeform").find("#thepaywill")
									.val();
							if (paywill == dom['itemId']) {
								str += "<option selected='selected' value='"
										+ dom['itemId'] + "'>"
										+ dom['itemName'] + "</option>"
							} else {
								str += "<option value='" + dom['itemId'] + "'>"
										+ dom['itemName'] + "</option>"
							}
						})
				$("#payWill").append(str);
			}, "json");
		},
		// 查询是否默认
		findIsDefault : function() {
			var url = rootPath + "/prize/findIsDefault.shtml";
			var param = {};
			$.post(url, param, function(data) {
				var str = "";
				$(data).each(
						function(index, dom) {
							var isDefault = $("#prizeform").find(
									"#theisDefault").val();
							if (isDefault == dom['itemId']) {
								str += "<option selected='selected' value='"
										+ dom['itemId'] + "'>"
										+ dom['itemName'] + "</option>"
							} else {
								str += "<option value='" + dom['itemId'] + "'>"
										+ dom['itemName'] + "</option>"
							}
						})
				$("#isDefault").append(str);
			}, "json");
		},
		/**
		 * 查询所有的电子奖分类
		 */
		findAllThePrizeClassify : function() {
			var url = rootPath
					+ "/user/prizestrategy/findAllPrizeMaterial.shtml";
			var param = {}
			var bigstr = "";
			$.post(
					url,
					param,
					function(data) {
					var carr = $("input[name='checkedIds']")
					$(data).each(
							function(index, dom) {
								var str = "";
								if(dom['isShow'] == 0){
									str += " <tr style='display:none;'>"
								}else{
									str += " <tr>"
								}
								if (carr.length > 1) {
									for (var i = 0; i < carr.length; i++) {
										// alert($(carr[i]).val()==dom['id'])
										if ($(carr[i])
												.val() == dom['id']) {
											var str1 = "<td style='width:10%;padding: 10px  !important;'><input type='checkbox' name='materialChecked' disabled='disabled' value="
													+ dom['id']
													+ "></td>"
											break;
										} else {
											var str1 = "<td style='width:10%;padding: 10px  !important;'><input type='checkbox' name='materialChecked' value="
													+ dom['id']
													+ "></td>"
										}
									}
								} else {
									var str1 = "<td style='width:10%;padding: 10px  !important;'><input type='checkbox' name='materialChecked' value="
											+ dom['id']
											+ "></td>"
								}
								str += str1
								/*str += "<td style='width:10%'>"
										+ (index + 1)
										+ "</td>"*/
								str += "<td style='width:19%;padding: 10px  !important;'>"
											+ dom['prizeName']
											+ "</td>"	
											
							
								/*		if(dom['sourceName']==null||
												dom['sourceName']==""){
											str += "<td style='width:13%'>"
												+ dom['prizeName']
												+ "</td>"
										}else{
											str += "<td style='width:13%'>"
												+ dom['sourceName']
												+ "</td>"
										}*/
							/*	str += "<td><img src="
										+ dom['logo8Url']
										+ " id='logoimg' style='width:30px;height:30px'></td>"*/
								if (dom['sourceName'] == null
										|| dom['sourceName'] == "") {
									str += "<td style='width:19%;padding: 10px  !important;'></td>"
								} else {
									str += "<td style='width:19%;padding: 10px  !important;'>"
											+ dom['sourceName']
											+ "</td>"
								}
								str += "<td style='width:16%;padding: 10px  !important;'>"
								    + dom['availableCount']
									+ "</td>"
								
								if(dom['sourceTypes'] == null){
									str += "<td style='width:16%;padding: 10px  !important;'>      </td>"
								}else{
								if (dom['sourceTypes'] == 0) {
									str += "<td style='width:16%;padding: 10px  !important;'>虚拟奖</td>"
								}
								
								if (dom['sourceTypes'] == 1) {
									str += "<td style='width:16%;padding: 10px  !important;'>实物奖</td>"
								}
								if (dom['sourceTypes'] == 2) {
									str += "<td style='width:16%;padding: 10px  !important;'>权益</td>"
								}
								if (dom['sourceTypes'] == 3) {
									str += "<td style='width:16%;padding: 10px  !important;'>红包</td>"
								}
								if (dom['sourceTypes'] == 4){
									str += "<td style='width:16%;padding: 10px  !important;'>运营定制</td>"
								}
								if (dom['sourceTypes'] == 5){
									str += "<td style='width:16%;padding: 10px  !important;'>客户定制</td>"
								}
								
								}
								
								if (dom['oldOrNew'] == 1){
									str += "<td  class=''  id='old1' style='width:14% ;padding: 10px  !important;'>内</td>"
								}
								if(dom['oldOrNew'] == 2){
									str += "<td  style='width:14%;padding: 10px  !important;' value=2>外</td>"
								}
								if (dom['isShow'] == 0){
									str += "<td  class=''  id='isShow' style='width:16% ;padding: 2px  !important; '>隐藏</td>"
								}
								if(dom['isShow'] == 1){
									str += "<td  style='width:16%;padding: 2px  !important; ' value=1>展示</td>"
								}
								/*
								 * if(dom['level']==1){
								 * str+="<td style='width:13%'>一等奖</td>"
								 * }else
								 * if(dom['level']==2){
								 * str+="<td style='width:13%'>二等奖</td>"
								 * }else
								 * if(dom['level']==3){
								 * str+="<td style='width:13%'>三等奖</td>"
								 * }else
								 * if(dom['level']==4){
								 * str+="<td style='width:13%'>普奖</td>"
								 * }else{ str+="<td style='width:13%'></td>" }
								 */

							/*	if (dom['name'] == null
										|| dom['name'] == '') {
									str += "<td style='width:30%'>通用奖品</td>";
								} else {
									str += "<td style='width:30%'>"
											+ dom['name']
											+ "</td>";
								}*/
								
								str += "</tr>";
								bigstr += str;
							});
			   
			    console.log(document.getElementById("bigstr"))
			
			   
//	    document.getElementById("prizeStranegyTbreal").innerHTML = bigstr;
//			document.getElementsByClassName("prizeStranegyTbreal")[0].innerHTML = bigstr;
			    $(".prizeStranegyTbreal").html(bigstr)
			      console.log(document.getElementById("prizeStranegyTbreal"))

		}, "json");
		},

		lable : {
			page : function() {
				$(".fd_page li").find("a").click(
						function() {
							var page = $(this).attr("assignPage"); 
							if(platform.isNull(page)){
								return;
							}
							var labeltitle = $("#label_title").val();
							var labeltype = $("#labeltype").val();
							platform.doGet(platform.getRequestLabellUrl(page,
									labeltitle, labeltype));
						});
			},
			list : function() {
						/**
						 * 签删除
						 */
						$("#prizeLabel")
								.find(".btn-warning")
								.click(
										function() {
											var id = $(this).attr("name");
											layer
													.confirm(
															'确定删除吗？',
															{

																btn : [ '确定',
																		'取消' ],
																yes : function(
																		index) {
																	layer
																			.close(index);
																	platform
																			.doGet(rootPath
																					+ "/user/label/deletePrizeActivityLabel.shtml?id="
																					+ id);
																}
															// 按钮
															}, function() {
																return;
															});
										}),

						/**
						 * 跳转到签的更新页面
						 */
						$("#prizeLabel")
								.find(".btn-success")
								.click(
										function() {
											var id = $(this).attr("name");
											platform
													.doGet(rootPath
															+ '/user/label/toEditPrizeLabel.shtml?id='
															+ id)
										})

				/**
				 * 跳转到签添加页面
				 */
				$("#labelAddButton").click(
						function() {
							platform.doGet(rootPath
									+ "/user/label/toAddActivityLabel.shtml");
						})
						
						$(document).ready(function() {
					    $("#loading").hide();
				 });

				/**
				 * 根据条件查询
				 */
				$("#prizeLabelCdButton").click(
						function() {
							// 获取表单提交的参数
							var param = platform
									.getFormJson("#prizeLabelCdForm");
							$("#loading").show();
							var url = platform.JsonToGet(rootPath
									+ "/user/label/labellist.shtml", param);
							platform.flushWindow(url);
						})
			},
			add : function() {
				/**
				 * 保存更新签
				 */
				$("#labelSaveButton")
						.click(
								function() {
									// 获取表单提交的参数
									var param = platform
											.getFormJson("#activityLabelForm");
									var flag = $("#flag").val();
									if (flag == "") {
										// 说明是新增
										platform
												.doPost(
														rootPath
																+ "/user/label/savePrizeActivityLabel.shtml",
														param);
									} else if (flag == "edit") {
										// 说明是更新
										platform
												.doPost(
														rootPath
																+ "/user/label/editPrizeActivityLabel.shtml",
														param);
									}
								})
			},
		},
		materialCountBytTime:{
			page:function(){
				$(".fd_page li").find("a").click(function() {
					var page = $(this).attr("assignPage");
					if(platform.isNull(page)){
						return;
					}
					var param=platform.getFormJson("#sourceFormPort");
					platform.doPost(rootPath+ "/activity/materialSourceCount.shtml?currents="+page,param);
				}),
			$("#returnPage").click(function(){
				var param=platform.getFormJson("#sourceFormPort");
				platform.doPost(rootPath+"/activity/returnPage.shtml",param);
			})
			$("#materialSourcePv").click(function(){
				//alert(111)
				var param=platform.getFormJson("#sourceFormPort");
					platform.doPost(rootPath+ "/activity/materialSourceCount.shtml",param);
			})
			}
		},
		materialCountByYear:{
			page:function(){
				$(".fd_page li").find("a").click(function() {
					var param=platform.getFormJson("#sourceCountForm");
					var page = $(this).attr("assignPage");
					if(platform.isNull(page)){
						return;
					}
					platform.doPost(rootPath+ "/activity/findMaterialSourceByYear.shtml?current="+page,param);
				}),
				$(document).ready(function() {
					    $("#loading").hide();
				 });
				$("#materialSourceByYearButton").click(function(){
						var param=platform.getFormJson("#sourceCountForm");
						$("#loading").show();
						platform.doPost(rootPath+ "/activity/findMaterialSourceByYear.shtml",param);
				}),
				$("#materialSourceByDay").click(function(){
					platform.doPost(rootPath+ "/activity/materialSourceCountByTime.shtml");
				}),
				$("#formsCountList").find(".btn-success").click(
						function() {
							var url = rootPath
							+ "/activity/findMaterialSourceByMonth.shtml";
					var str = $(this).attr("name");
					//alert(str);
					var strs= new Array(); 
					strs=str.split(",");
					var param = {"year":strs[0],"sourceId":strs[1]};
					var bigstr = "";
					$.post(
									url,
									param,
									function(data) {
										$(data).each(
														function(index, dom) {
															var str = "";
															str += "<tr>"
															str += "<td style='width:20%;margin-right: 50px'>"
																	+ (index + 1)
																	+ "</td>"
															str += "<td style='width:20%;margin-right: 50px;'>"
																	+ dom['months']
																	+ "</td>"
															if (dom['sourceName'] == null
																	|| dom['sourceName'] == '') {
																str += "<td style='width:20%;margin-right: 50px;'></td>";
															} else {
																str += "<td style='width:20%;margin-right: 50px'>"
																		+ dom['sourceName']
																		+ "</td>";
															}
															str += "<td style='width:20%;margin-right: 50px'>"
																	+ dom['pvCounts']
																	+ "</td>"
															str += "<td style='width:20%;margin-right: 50px'>"
																		+ dom['uvCounts']
																		+ "</td>"
															str += "</tr>";
															bigstr += str;
														});
										document.getElementById("countSourceByMonths").innerHTML = bigstr;
										var contentHtml = $("#countSourceDiv").html();
										var index = layer.open({
											type : 1,
											title : '按月统计',
											skin : 'layui-layer-rim', // 加上边框
											area : [ '700px', '400px' ], // 宽高
											content : contentHtml,
										});
										$("#countSourceDiv").attr(
												"layIndex", index);
									},"json");
			})
			}
			},
		materialCount:{
			page:function(){
				$(".fd_page li").find("a").click(function() {
					//alert(11);
					var param=platform.getFormJson("#sourceFormCheck");
					var page = $(this).attr("assignPage");
					if(platform.isNull(page)){
						return;
					}
					platform.doPost(rootPath+ "/activity/materialSourceCountByTime.shtml?current="+page,param);
					//platform.doGet(platform.getMaterialCountUrl(page));
				}),
				$(".table").find(".btn-primary").click(function(){
					//alert(111)
					var pageNumber=$("#showPageNumber").val();
					var timeRange=$("#showtimeRange").val();
					var sourceBackId=$("#showSourceId").val();
					//alert(sourceBackId)
					//alert(timeRange)
					if(timeRange=="undefined"){
						timeRange=null;
					}
					var str = $(this).attr("name");
					var strs= new Array(); 
					strs=str.split(",");
					platform.doGet(rootPath+ "/activity/materialSourceCount.shtml?sourceId="+strs[1]+"&countDate="+strs[0]+"&pageNumber="+pageNumber+"&timeRange="+timeRange+"&sourceBackId="+sourceBackId);
				}),
				$("#materialSourceCdButton").click(function(){
					//alert(11);
					var param=platform.getFormJson("#sourceFormCheck");
					platform.doPost(rootPath+ "/activity/materialSourceCountByTime.shtml",param);
				})				
			},
			queryPage:function(){
				var param=platform.getFormJson("#sourceFormPort");
				platform.doPost(rootPath+ "/activity/materialSourceCount.shtml",param);
			}
		},
		material : {
			addMaterial:function(){
				$("#materialSourceButton").click(function(){
					var param=platform.getFormJson("#materialSourceForm");
					platform.doPost(rootPath+ "/user/materialsource/saveorupdate.shtml",param);

				})
			},
			findAllPageType:function(){
				var url= rootPath + "/user/materialsource/findAllPageType.shtml";
				var pageType = $("#pageType").val();
				if(pageType==""){
					pageType=6;
				}
				$.post(url, {}, function(data) {
					var str="<option value='' selected>---请选择---</option>";
					$(data).each(
							function(index, dom) {
									if (pageType == dom['itemId']) {
									str+="<option value='" + dom['itemId']
											+ "' selected>" + dom['itemName']
											+ "</option>"
									//$("#sourcePageType").append(str);
								} else {
									str+= "<option value='" + dom['itemId']
											+ "'>" + dom['itemName'] + "</option>"
								}
							})
							$("#sourcePageType").html(str);
				}, 'json');
			},
			findAllOrgan : function() {
				var url = rootPath + "/user/material/findAllOrgan.shtml";
				var organCode = $("#materialOrganCode11").val();

				$.post(url, {}, function(data) {
					$(data).each(
							function(index, dom) {

								if (organCode == dom['code']) {
									var str = "<option value='" + dom['code']
											+ "' selected>" + dom['name']
											+ "</option>"
									$("#prizeMaterialOrgan").append(str);
								} else {
									var str = "<option value='" + dom['code']
											+ "'>" + dom['name'] + "</option>"
									$("#prizeMaterialOrgan").append(str);
								}
							})
							//调用下拉搜索功能js
							$('.searchQdClass').chosen();
				}, 'json');
			},
			changeRed : function() {
				/**
				 * 素材源的分页
				 *
				 */
				$(".fd_page li").find("a").click(function() {
					//alert(11);
					var page = $(this).attr("assignPage");
					if(platform.isNull(page)){
						return;
					}
					var BrandsName=$("#BrandsName").val();
					var MaterialSourcesName=$("#MaterialSourcesName").val();
					platform.doGet(platform.getRequestSourceUrl(page,MaterialSourcesName,BrandsName));
				})
				/**
				 * 根据条件查询素材
				 */
				$("#SourcesBrandCdButton").click(
						function() {
							// 获取表单提交的参数
							var param = platform
									.getFormJson("#SourcesBrandCdForm");
							var url = platform.JsonToGet(rootPath
									+ "/user/materialsource/sourcelist.shtml",
									param);
							platform.flushWindow(url);
							// alert(JSON.stringify(param))
						})
				/**
				 * 删除素材源
				 */
				$(".table").find(".btn-danger").click(
						function() {
					var id = $(this).attr("name");
					layer
							.confirm(
									'确定删除吗？',
									{
										btn : [ '确定', '取消' ],
										yes : function(index) {
											layer.close(index);
											var url = rootPath+ "/user/materialsource/deleteMaterialSource.shtml";
											var param = {
												id : id
											};
											$
													.post(
															url,
															param,
															function(data) {
																if (!data.message) {
																	layer
																			.alert(
																					'您不能删除素材中正在使用的素材源',
																					{
																						/*
																						 * offset : [
																						 * '50%',
																						 * '40%' ],
																						 */
																						time : 0 // 不自动关闭
																						,
																						btn : [ '确定' ],
																						yes : function(
																								index) {
																							layer
																									.close(index);
																						}
																					});
																} else {
																	platform.doGet(rootPath+"/user/materialsource/sourcelist.shtml");
																}
															});
										}
									// 按钮
									}, function() {
										return;
									});
				})
				
				
				/**
				 * 修改素材源
				 */
				$(".table").find(".btn-success").click(
								/*function() {
					var id = $(this).attr("name");
					//alert(id);
					platform.doGet(rootPath+'/user/materialsource/toEditSource.shtml?id='+id);
				}*/),
				$("#toAddMaterialSourceButton").click(
							function() {
								platform.doGet(rootPath+'/user/materialsource/toSaveSource.shtml')
							}),
				$("#thetype").change(function() {
					var val = $(this).val();
					if (val == 3) {
						$("#redPackageDiv").css('display', 'block');
						$("#redPackageDiv").attr("required", "required");

					} else {
						$("#redPackageDiv").css('display', 'none');

						$("#redPackageDiv").removeAttr("required");

					}

				})
			},

			page : function() {
				$(".material1 li").find("a")
						.click(
								function() {
									var page = $(this).attr("assignPage");
									if(platform.isNull(page)){
										return;
									}
									var prizeName = $("#prizeName").val();
									var prizeClassifyid = $(
											"#prizeMaterialCategory").val();
									var createTimeBeginAndEnd = $(
											"#date-range2").val();
									platform.doGet(platform
											.getRequestMaterialUrl(page,
													prizeName, prizeClassifyid,
													createTimeBeginAndEnd));
								});
			},

			page2 : function() {
				$(".material2 li").find("a")
						.click(
								function() {
									var page2 = $(this).attr("assignPage");
									if(platform.isNull(page2)){
										return;
									}
									var prizeName = $("#prizeName").val();
									var prizeClassifyid = $(
											"#prizeMaterialCategory").val();
									var createTimeBeginAndEnd = $(
											"#date-range2").val();
									var organCode = $("#materialWithOrgan")
											.val();
									var flag = 'withQudao';
									platform.doGet(platform
											.getRequestMaterialUrl2(page2,
													prizeName, prizeClassifyid,
													createTimeBeginAndEnd,
													flag, organCode));
								});

			},

			uploadBackLogo : function(data, status) {
				if (!platform.isNull(data.msg)) {
					platform.alertmsg(data.msg);
				}
				if (!platform.isNull(data.data)) {
					$("#logo8Url").val(data.data.keyUrl);
					$("#logoimg").attr('src',
							"http://" + data.data.host + data.data.keyUrl);
				}
			},

			uploadBackLogo10 : function(data, status) {
				if (!platform.isNull(data.msg)) {
					platform.alertmsg(data.msg);
				}
				if (!platform.isNull(data.data)) {
					$("#logo10Url").val(data.data.keyUrl);
					$("#turnimg").attr('src',
							"http://" + data.data.host + data.data.keyUrl);
				}
			},

			uploadBackDoc : function(data, status) {
				if (!platform.isNull(data.msg)) {
					platform.alertmsg(data.msg);
				}
				if (!platform.isNull(data.data)) {
					$("#theDocUrl").val(data.data.keyUrl);
				}
			},

			upload : function() {
				$("#logoFile").on(
						"change",
						function() {
							//判断校验，限定上传图片的尺寸为148*148
							var MyTest = document.getElementById("logoFile").files[0];
							var reader = new FileReader();
							reader.readAsDataURL(MyTest);
							reader.onload = function(theFile) {
							var image = new Image();
							   image.src = theFile.target.result;
							   image.onload = function() {
								   if(this.width!=148||this.height!=148){
										 alert("logo图片的尺寸应该是148x148")
									 }else if(this.width==148||this.height==148){
										 platform.myAjaxFileUpload(rootPath
													+ "/user/upload/picture.shtml",
													"#logoFile", {
														logo8Url : $("#logo8Url").val()
													}, platform.material.uploadBackLogo,
													platform.fileUpload.uploadBackE);
									 }else{
										 alert("请选择格式为*.jpg、*.png的图片");
									 }
								   };
								};
						})
			},

			uploadTurn : function() {
				$("#turnplateFile").on(
						"change",
						function() {
							//判断校验，限定上传图片的尺寸为148*148
							var MyTest = document.getElementById("turnplateFile").files[0];
							var reader = new FileReader();
							reader.readAsDataURL(MyTest);
							reader.onload = function(theFile) {
							var image = new Image();
							   image.src = theFile.target.result;
							   image.onload = function() {
								   if(this.width!=142||this.height!=142){
										 alert("logo图片的尺寸应该是142x142")
									 }else if(this.width==142||this.height==142){
										 platform.myAjaxFileUpload(rootPath
													+ "/user/upload/picture.shtml",
													"#turnplateFile", {
														logo10Url : $("#logo10Url").val()
													}, platform.material.uploadBackLogo10,
													platform.fileUpload.uploadBackE);
									 }else{
										 alert("请选择格式为*.jpg、*.png的图片");
									 }
								   };
								};
							/*platform.myAjaxFileUpload(rootPath
									+ "/user/upload/picture.shtml",
									"#turnplateFile", {
										logo10Url : $("#logo10Url").val()
									}, platform.material.uploadBackLogo10,
									platform.fileUpload.uploadBackE);*/
						})
			},

			uploadTheDoc : function() {
				$("#theDocFile").on(
						"change",
						function() {
							platform.myAjaxFileUpload(rootPath
									+ "/user/upload/doc.shtml", "#theDocFile",
									{
										theDocUrl : $("#theDocUrl").val()
									}, platform.material.uploadBackDoc,
									platform.fileUpload.uploadBackE);
						})
			},

			findAllOrgan2 : function() {
				var url = rootPath + "/user/material/findAllOrgan.shtml";
				$.post(url, {}, function(data) {
					$(data).each(
							function(index, dom) {
								var strn = "<option value='" + dom['code']
										+ "'>" + dom['name'] + "</option>"
								$("#OrganForm").append(strn);
								var organCode = $("#materialWithOrgan").val();
								if (organCode == dom['code']) {
									var str = "<option value='" + dom['code']
											+ "' selected>" + dom['name']
											+ "</option>"
									$("#prizeMaterialOrganForm").append(str);
								} else {
									var str = "<option value='" + dom['code']
											+ "'>" + dom['name'] + "</option>"
									$("#prizeMaterialOrganForm").append(str);
								}
							})
				}, 'json');
			},
			getOrganAndCode : function() {
				var param = $("#materialWithOrgan").val();
				// var param=platform.getFormJson("#prizeMaterialCdForm");
				// alert(param);
				if (param == null || param == "") {
					return;
				}
				// var organCode=param['organCode'];
				var url = rootPath
						+ "/user/material/findAllProjectByOrgan.shtml";
				$.post(url, {
					organCode : param
				}, function(data) {
					var str = "<option value=''>--所属项目--</option>"
					if (data == null || data == "") {
						str += "<option value='' selected>" + "未开启项目"
								+ "</option>"
						$("#prizeMaterialProjectForm").html(str);
						return;
					}
					$(data).each(
							function(index, dom) {
								var projectCodes = $("#materialWithProject")
										.val();
								if (projectCodes == dom['code']) {
									str += "<option value='" + dom['code']
											+ "' selected>" + dom['name']
											+ "</option>";
								} else {
									str += "<option value='" + dom['code']
											+ "'>" + dom['name'] + "</option>";
								}
								$("#prizeMaterialProjectForm").html(str);
							})
				}, 'json');
			},
			list : function() {

				/**
				 * 跳转素材更新页
				 */
				$(".table")
						.find(".btn-success")
						.click(
								/*function() {

									var id = $(this).attr("name");

									platform
											.doGet(rootPath
													+ '/user/material/toEditPrizeMaterial.shtml?id='
													+ id)

								}*/)

				$(".table").find(".theNetss").mouseover(function() {
					var tre = $(this).parent();
					var thevalue = $(tre).find(".theurl").val();

					layer.tips(thevalue, this, {
						tips : [ 1, '#0099CC' ],
						time : 4000
					});
				})

				$(".table").find(".thesloganss").mouseover(function() {
					var tre = $(this).parent();
					var thevalue = $(tre).find(".theslogan").val();

					layer.tips(thevalue, this, {
						tips : [ 1, '#0099CC' ],
						time : 4000
					});
				})

				/*
				 * $(".table").find(".theOrganss").mouseover(function(){ var
				 * tre=$(this).parent(); var
				 * thevalue=$(tre).find(".theOrgan").val(); if(thevalue==null ||
				 * thevalue==""){ layer.tips('该素材未指定渠道',this ,{ tips: [1,
				 * '#0099CC'], time: 4000 }); }else{ layer.tips(thevalue,this ,{
				 * tips: [1, '#0099CC'], time: 4000 }); } })
				 */
				/**
				 * 查找当前素材使用的项目
				 */
				$(".table")
						.find(".btn-primary")
						.click(
								function() {
									var id = $(this).attr("name");
									var url = rootPath
											+ "/user/material/findProjectByMaterialId.shtml"
									$
											.post(
													url,
													{
														id : id
													},
													function(data) {
														// alert(data['message'])
														if (data['message'] == 'ok') {
															var str = "";
															$(data['list'])
																	.each(
																			function(
																					index,
																					dom) {
																				var endTime = "";
																			
																				var d = new Date(
																						dom['createTime'])
																				str += "<tr>";
																				str += "<td class=''>"
																						+ dom['name']
																						+ "</td>";
																				str += "<td scope='row'>"
																						+ d
																								.toLocaleString()
																						+ "</td>";
																				str += "<td class=''>"
																						+ dom['code']
																						+ "</td>";
																				str += "</tr>";
																			});
															$("#usingbody")
																	.html(str)

															var index = layer
																	.open({
																		title : '素材用途',
																		type : 1,
																		btn : [ "确认" ],
																		yes : function(
																				index,
																				layero) {
																			layer
																					.close(index)
																		},
																		skin : 'layui-layer-rim',
																		area : [
																				'40%',
																				'50%' ],
																		scrollbar : false,
																		content : $(
																				'#using')
																				.html(),
																		cancel : function(
																				index,
																				layero) {
																			layer
																					.close(index)
																		}
																	});
														} else {
															layer
																	.alert(data['message'])
														}
													}, 'json')
								})
				Date.prototype.toLocaleString = function() {
					return this.getFullYear() + "年" + (this.getMonth() + 1)
							+ "月" + this.getDate() + "日 ";
				}
				/**
				 * 素材复制
				 */
				var indexs = "";
				$(document).on('click','#copyButton',function() {
									var id = $("#materialId").val();
									var param = platform.getFormJson("#copyForm");
									// alert(JSON.stringify(param))
									
									var skipUrl = param['skipUrl'];
									//alert(skipUrl)
									var organCode = param['organCode'];
									// alert(organCode);
									if (skipUrl == "" || skipUrl == null) {
										layer.alert("请输入素材链接");
										return;
									}
									if(organCode==""||organCode==null){
										layer.alert("请选择渠道");
										return;
									}
									platform
											.doGet(rootPath
													+ "/user/material/copyMaterialByUrlAndCom.shtml?id="
													+ id + "&organCode="
													+ organCode + "&skipUrl="
													+ skipUrl);
									layer.close(indexs);
								})
				/**
				 * 素材复制弹框 ///
				 */
				$(".table").find(".btn-info").click(function() {
					var id = $(this).attr("name");
					$("#materialId").val(id);
					var url=rootPath
					+ "/user/material/findMaterialById.shtml";
					$.post(
							url,
							{"id":id},
							function(data) {
								var skipurl=data['skipUrl'];
								$("#copyForm").find("#skipUrlForCopy").val(skipurl);
							},'json')
								var indexs = layer.open({
									title : '素材复制',
									type : 1,
									skin : 'layui-layer-rim',
									area : [ '40%', '40%' ],
									scrollbar : false,
									content : $('#copy').html(),
									cancel : function(index, layero) {
										layer.close(indexs)
									}
								});
				})
				
				
				
				
				/**
				 * 素材删除
				 */
				$(".table")
						.find(".btn-danger")
						.click(
								function() {
									var id = $(this).attr("name");
									layer
											.confirm(
													'确定删除吗？',
													{
														btn : [ '确定', '取消' ],
														yes : function(index) {
															layer.close(index);
															var url = rootPath
																	+ "/user/material/deletePrizeMaterial.shtml";
															var param = {
																id : id
															};
															$
																	.post(
																			url,
																			param,
																			function(
																					data) {
																				if (data == "deleteErrorWithStrategy") {
																					layer
																							.alert(
																									'您不能删除线上产品正在应用的素材,请从奖品策略中下架该产品',
																									{
																										/*
																										 * offset : [
																										 * '50%',
																										 * '40%' ],
																										 */
																										time : 0 // 不自动关闭
																										,
																										btn : [ '确定' ],
																										yes : function(
																												index) {
																											layer
																													.close(index);
																										}
																									});
																				} else {
																					platform
																							.doGet(rootPath
																									+ "/user/material/materiallist.shtml");
																				}
																			});
														}
													// 按钮
													}, function() {
														return;
													});
								})
				/**
				 * 跳转到素材添加页面
				 */
				$("#toAddMaterialButton")
						.click(
								function() {
									platform
											.doGet(rootPath
													+ '/user/material/toAddPrizeMaterial.shtml')
								})
				/**
				 * 根据条件查询素材
				 */
								
				$("#prizeMaterialCdButton").click(
						function() {
							// 获取表单提交的参数
							var param = platform
									.getFormJson("#prizeMaterialCdForm");
							var url = platform.JsonToGet(rootPath
									+ "/user/material/materiallist.shtml",
									param);
							platform.flushWindow(url);
							// alert(JSON.stringify(param))
						})

				/**
				 * 选择公司之后联动项目的下拉框
				 */
				$("#prizeMaterialOrganForm")
						.change(
								function() {
									var param = platform
											.getFormJson("#prizeMaterialCdForm");
									var organCode = param['organCodes'];
									var url = rootPath
											+ "/user/material/findAllProjectByOrgan.shtml";
									$
											.post(
													url,
													{
														organCode : organCode
													},
													function(data) {
														var str = "<option value=''>--所属项目--</option>"
														if (data == null
																|| data == "") {
															str += "<option value='' selected>"
																	+ "未开启项目"
																	+ "</option>"
															$(
																	"#prizeMaterialProjectForm")
																	.html(str);
															return;
														}
														$(data)
																.each(
																		function(
																				index,
																				dom) {
																			var projectCodes = $(
																					"#materialWithProject")
																					.val();
																			if (projectCodes == dom['code']) {
																				str += "<option value='"
																						+ dom['code']
																						+ "' selected>"
																						+ dom['name']
																						+ "</option>";
																			} else {
																				str += "<option value='"
																						+ dom['code']
																						+ "'>"
																						+ dom['name']
																						+ "</option>";
																			}
																			$(
																					"#prizeMaterialProjectForm")
																					.html(
																							str);
																		})
													}, 'json');
								})

				/**
				 * 设置开启
				 */
				/*
				 * $("#prizeMaterial").find(".btn-primary").click(function(){
				 * var id=$(this).attr("name");
				 * platform.doGet(rootPath+"/user/material/setOpen.shtml?id="+id); })
				 */

				/**
				 * 设置停用
				 */
				$("#prizeMaterial").find(".btn-warning").click(
						function() {
							var id = $(this).attr("name");
							var url = rootPath
									+ "/user/material/setClose.shtml"
							var param = {
								id : id
							}
							$.post(url, param, function(data) {
								if (data == 'error') {
									layer.alert('有项目正在使用该奖品，不可停用！', {
										offset : [ '50%', '40%' ],
										time : 0 // 不自动关闭
										,
										btn : [ '确定' ],
										yes : function(index) {
											layer.close(index);
										}
									})
								}
							});
							platform.doGet(rootPath
									+ "/user/material/materiallist.shtml");
						})
			},
			add : function() {
				/**
				 * 素材的添加和更新
				 */
				$("#prizeMaterialButton")
						.click(
								function() {
									// 获取表单提交的参数
									var param = platform
											.getFormJson("#prizeMaterialForm");
									//链接有异常
									var skipUrl = param.skipUrl;
									if((skipUrl.split('http://').length-1 )>=2 || (skipUrl.split('https://').length-1 )>=2 
											|| (skipUrl.indexOf("http://") != -1	&& skipUrl.indexOf("https://") != -1)){
										alert("链接有异常，请检查链接--"+param.skipUrl);
									}
									else{	
										/*
										 * var
										 * param=$("#prizeMaterialForm").serialize();
										 * param = decodeURIComponent(param,true);
										 * param = encodeURI(encodeURI(param));
										 */
										var flag = $("#flag").val();
										if (flag == "") {
											var url = rootPath
													+ "/user/material/savePrizeMaterial.shtml"
											platform.doPost(url, param);
										} else if (flag == "edit") {
											// 说明是更新
											platform
													.doPost(
															rootPath
																	+ "/user/material/editPrizeMaterial.shtml",
															param);
										}
									}
								
									
								})

				$("#thetype").change(function() {
					/*
					 * var val=$("#thetype").val(); if(val==1){
					 * $("#prizeMaterialCategory").prop('disabled','disabled');
					 * $("#prizeMaterialCategory").val("");
					 * //$("#categorydiv").html(""); }else if(val==0){
					 * $("#prizeMaterialCategory").removeProp('disabled'); }
					 */
				})
				$("#prizeMaterialButtonImg").click(function() {
					// 获取表单提交的参数
					var param = $("#material_id").val();
					platform.doPost(rootPath+ "/user/material/prizeMaterialPicEdit.shtml",{'material_id':param});
				})
			}
		},

		realPrize : {
			page : function() {
				$(".fd_page li").find("a").click(
						function() {
							var page = $(this).attr("assignPage");
							if(platform.isNull(page)){
								return;
							}
							var prizeName = $("#realPrizeName").val();
							var level = $("#level").val();
							var datestr = $("#datestr").val();
							platform.doGet(platform.getRequestRealPrizeUrl(
									page, prizeName, level, datestr));
						});
			},
			list : function() {
				$("#realPrizeFindCdBuutton")
						.click(
								function() {
									// 获取表单提交的参数
									var param = platform
											.getFormJson("#realPrizeCdform");
									platform.doPost(rootPath
											+ "/prize/realprize.shtml", param);
								});
			},
			add : function() {
				$("#realPrzieButton").click(
						function() {
							var param = platform.getFormJson("#realPrizeForm");
							var flag = $("#flag").val();
							if (flag == "") {
								// 说明是新增
								platform.doPost(rootPath
										+ "/realPrize/saveRealPrize.shtml",
										param);
							} else if (flag == "edit") {
								// 说明是更新
								platform.doPost(rootPath
										+ "/realPrize/editRealPrize.shtml",
										param);
							}
						});
			}
		},

		activityType : {

			page : function() {
				$(".fd_page li").find("a").click(function() {
					var page = $(this).attr("assignPage");
					if(platform.isNull(page)){
						return;
					}
					var typeName = document.getElementById("typeName").value;
					platform.doGet(platform.getRequestActivityTypeUrl(page,typeName));
				});
			},
			uploadBackRulePicture : function(data, status) {
				if (!platform.isNull(data.msg)) {
					platform.alertmsg(data.msg);
				}
				if (!platform.isNull(data.data)) {
					$("#rulesUrl").val(data.data.keyUrl);
				}
			},
			/**
			 * logo回调
			 */
			uploadBackLogo : function(data, status) {
				if (!platform.isNull(data.msg)) {
					platform.alertmsg(data.msg);
				}
				if (!platform.isNull(data.data)) {
					$("#logoUrl").val(data.data.keyUrl);
				}
			},
			/**
			 * 上传活动规则
			 */
			uploadrule : function() {
				$("#rulePictureFile")
						.off("change")
						.on(
								"change",
								function() {

									platform
											.myAjaxFileUpload(
													rootPath
															+ "/user/upload/picture.shtml",
													"#rulePictureFile",
													{
														rulesUrl : $(
																"#rulesUrl")
																.val()
													},
													platform.activityType.uploadBackRulePicture,
													platform.fileUpload.uploadBackE);
								});
			},

			upload : function() {
				$("#logoFile").on(
						"change",
						function() {
							platform.myAjaxFileUpload(rootPath
									+ "/user/upload/picture.shtml",
									"#logoFile", {
										logoUrl : $("#logoUrl").val()
									}, platform.activityType.uploadBackLogo,
									platform.fileUpload.uploadBackE);
						})
			},

			downloadLogo : function() {
				$("#downloadLogo").click(
						function() {
							var id = $("#downloadLogo").attr("name");
							window.location.href(rootPath
									+ "/user/activity/downLoadLogo.shtml?id="
									+ id);
						});
			},

			add : function() {
				/**
				 * 输入活动规则改变文本
				 */

				$("#outLet").find("input[name='ruleStrTemp']").blur(function() {
					var theval = $(this).attr('placeholder')
					var flag1;
					var flag2;
					var flag3;
					var flag4;
					if (theval == '活动截止时间') {

						$("#ruleStrDate").html($(this).val());
					} else if (theval == '主办单位') {
						var reslut = fucCheckLength($(this).val());
						if (reslut > 40) {
							layer.tips("长度不能超过25", this, {

							});
							flag2 = false;
						} else {
							flag2 = true;
						}
						$("#ruleStrFrom").html($(this).val())
					} else if (theval == '活动热线') {
						$("#ruleStrPhone").html($(this).val())
					} else if (theval == '最终解释权单位') {
						var reslut = fucCheckLength($(this).val());
						if (reslut > 40) {
							layer.tips("长度不能超过25", this, {

							});
							flag4 = false;
						} else {
							flag4 = true;
						}
						$("#ruleStrBy").html($(this).val())
					}

				})

				$("#addActivityTypeButton")
						.click(
								function() {
									// 获取表单提交的参数
									var str1 = $("#ruleStr1").val();
									var str2 = $("#ruleStr2").val();
									var str3 = $("#ruleStr3").val();
									var str4 = $("#ruleStr4").val();
									var thev = str1 + "," + str2 + "," + str3
											+ "," + str4;

									$('#ruleStrHidden').val(thev);
									var reslut = fucCheckLength($("#ruleStr2")
											.val());
									var reslut2 = fucCheckLength($("#ruleStr4")
											.val());
									var flag1;
									var flag2;
									if (reslut > 40) {
										flag1 = false;
										layer.tips("长度不能超过25", $("#ruleStr2"),
												{

												});
									} else {
										flag1 = true;
									}
									if (reslut2 > 40) {
										flag2 = false;
										layer.tips("长度不能超过25", $("#ruleStr4"),
												{

												});
									} else {
										flag2 = true;
									}

									var param = platform
											.getFormJson("#activityTypeForm");
									var flag = $("#flag").val();
									if (flag == "" || flag == null) {
										// 说明是新增

										if (flag1 && flag2) {
											platform.apply
													.request(
															rootPath
																	+ "/user/activity/savePrizeActivityType.shtml",
															this, param);
										}
									} else if (flag == "edit") {
										// 说明是更新
										if (flag1 && flag2) {
											platform.apply
													.request(
															rootPath
																	+ "/user/activity/editPrizeActivityType.shtml",
															this, param);
										}
									}
								})

				/**
				 * 跳转更新
				 */
				$("#activityTypeTb")
						.find(".btn-success")
						.click(
								function() {
									var id = $(this).attr("name");
									platform
											.doGet(rootPath
													+ '/user/activity/toEditPrizeAcivityType.shtml?id='
													+ id)

								})

				$("#activityTypeTb")
						.find(".btn-warning")
						.click(
								function() {
									var id = $(this).attr("name");
									layer
											.confirm(
													'确定删除吗？',
													{
														btn : [ '确定', '取消' ],
														yes : function(index) {
															layer.close(index);
															platform
																	.doGet(rootPath
																			+ "/user/activity/deletePrizeActivityType.shtml?id="
																			+ id);
														}
													// 按钮
													}, function() {
														return;
													});
								})

				/**
				 * 选中形式
				 */
				$("#myTabContent")
						.find("input[name='typeRadio']")
						.click(
								function() {
									var thevalue = $(
											'#myTabContent input[name="typeRadio"]:checked ')
											.val();
									$("#thetypeid").html(
											"<input type='hidden' name='prizeType' value="
													+ thevalue + ">");
								})
			},
			list:function(){
				/**
				 * 根据活动形式查询
				 */
				$("#activityFormButton")
				.click(
						function() {
							// 获取表单提交的参数 增加查询的条件 公司 以及项目
							var typeName = document
							.getElementById("typeName").value;
							platform
							.doGet(rootPath
									+ "/user/activity/activityType.shtml?typeName="+typeName
									);
						})
			}
		},

		prizeCategory : {

			page : function() {
				// 在键盘按下并释放及提交后验证提交表单
				$(".fd_page li").find("a").click(
						function() {
							var page = $(this).attr("assignPage");
							if(platform.isNull(page)){
								return;
							}
							var className = $("#prizeform").find("#className")
									.val();

							var payWill = $("#prizeform").find("#thepaywill")
									.val();
							var isDefault = $("#prizeform").find("#isDefault")
									.val();
							platform.doGet(platform.getRequestClassifyUrl(page,
									className, payWill, isDefault));
						});
			},
			list : function() {
				$("#prizeCategory")
						.find(".btn-success")
						.click(
								function() {
									var url = rootPath
											+ "/prize/toEditPrizeCategory.shtml"
									var id = $(this).attr('name');
									$.post(url, {
										id : id
									}, function(data) {
										$("#prizeCategoryForm").find(
												"#className").val(
												data['className']);
										if (data['patten'] == 1) {
											$("#prizeCategoryForm").find(
													"#patten").find(
													"option[value='1']").attr(
													"selected", true);
										} else if (data['patten'] == 2) {
											$("#prizeCategoryForm").find(
													"#patten").find(
													"option[value='2']").attr(
													"selected", true);
										} else if (data['patten'] == 3) {
											$("#prizeCategoryForm").find(
													"#patten").find(
													"option[value='3']").attr(
													"selected", true);
										} else if (data['patten'] == 4) {
											$("#prizeCategoryForm").find(
													"#patten").find(
													"option[value='4']").attr(
													"selected", true);
										}

										if (data['payWill'] == 1) {
											$("#prizeCategoryForm").find(
													"#payWill11").find(
													"option[value='1']").attr(
													"selected", true);
										} else if (data['payWill'] == 2) {
											$("#prizeCategoryForm").find(
													"#payWill11").find(
													"option[value='2']").attr(
													"selected", true);
										}

										if (data['isDefault'] == 1) {
											$("#isDefault11").find(
													"option[value='1']").attr(
													"selected", true);
										} else if (data['isDefault'] == 2) {
											$("#isDefault11").find(
													"option[value='2']").attr(
													"selected", true);
										}

									}, 'json');

									layer
											.open({
												type : 1,
												title : false // 不显示标题栏
												,
												closeBtn : false,
												area : [ '650px', '400px' ],
												shade : 0.8,
												id : 'LAY_layuipro' // 设定一个id，防止重复弹出
												,
												resize : false,
												btn : [ '提交', '返回' ],
												btnAlign : 'c',
												moveType : 1 // 拖拽模式，0或者1
												,
												content : $("#addCategory")
														.html(),
												yes : function(index) {

													var param = platform
															.getFormJson("#prizeCategoryForm");
													var className = param['className'];
													/*
													 * var
													 * className=$("#prizeCategoryForm").find(".class1").val();
													 */
													var payWill = param['payWill11'];
													var isDefault = param['isDefault11']

													//alert(className)
													if (className == null
															|| className == "") {
														layer.msg('分类名称不能为空');
														$("#prizeCategoryForm")
																.find(".class1")
																.addClass(
																		"has-feedback main-error")

													} else {
														$("#prizeCategoryForm")
																.find(".class1")
																.removeClass(
																		"has-feedback main-error")
														platform
																.doGet(rootPath
																		+ "/prize/editPrizeCategory.shtml?className="
																		+ className
																		+ "&payWill="
																		+ payWill
																		+ "&isDefault="
																		+ isDefault
																		+ "&theid="
																		+ id);
														layer.close(index);
													}

												},
												success : function(layero) {

												}
											});
								})

				$("#toaddCategory")
						.click(
								function() {

									layer
											.open({
												type : 1,
												title : false // 不显示标题栏
												,
												closeBtn : false,
												area : [ '700px', '500px' ],
												shade : 0.8,
												id : 'LAY_layuipro' // 设定一个id，防止重复弹出
												,
												resize : false,
												btn : [ '提交', '返回' ],
												btnAlign : 'c',
												moveType : 1 // 拖拽模式，0或者1
												,
												content : $("#addCategory")
														.html(),
												yes : function(index) {
													var flag = $("#flag").val();
													var param = platform
															.getFormJson("#prizeCategoryForm");
													var className = param['className'];
													var payWill = param['payWill11'];
													var isDefault = param['isDefault11']
													if (flag == "") {

														if (className == null
																|| className == "") {
															layer
																	.msg('分类名称不能为空');
															$(
																	"#prizeCategoryForm")
																	.find(
																			".class1")
																	.addClass(
																			"has-feedback main-error")

														} else {
															$(
																	"#prizeCategoryForm")
																	.find(
																			".class1")
																	.removeClass(
																			"has-feedback main-error")
															platform
																	.doGet(rootPath
																			+ "/prize/savePrizeCategory.shtml?className="
																			+ className
																			+ "&payWill="
																			+ payWill
																			+ "&isDefault="
																			+ isDefault);
															layer.close(index);
														}

													}
												},
												success : function(layero) {

												}
											});

								})

				$("#prizeCategory")
						.find(".btn-danger")
						.click(
								function() {
									var id = $(this).attr("name");
									layer
											.confirm(
													'确定删除吗？',
													{
														btn : [ '确定', '取消' ],
														yes : function(index) {
															layer.close(index);
															var url = rootPath
																	+ "/prize/deletePrizeCategory.shtml";
															var param = {
																id : id
															};
															$
																	.post(
																			url,
																			param,
																			function(
																					data) {
																				if (data == "deleteError") {
																					platform
																							.deleteError();
																				} else {
																					platform
																							.doPost(rootPath
																									+ "/prize/electicprize.shtml");
																				}
																			});
														}
													// 按钮
													}, function() {
														return;
													});
								})

				/**
				 * 根据条件查询
				 */
								$(document).ready(function() {
					    $("#loading").hide();
				 });
				$("#prizeCategoryCdButton").click(
						function() {
							// 获取表单提交的参数
                            
							var className = $("#prizeform").find("#className")
									.val();
							var payWill = $("#prizeform").find("#payWill")
									.val();
							var isDefault = $("#prizeform").find("#isDefault")
									.val();
							$("#loading").show();
							platform.doGet(rootPath
									+ "/prize/electicprize.shtml?className="
									+ className + "&payWill=" + payWill
									+ "&isDefault=" + isDefault);
						})
			},

			add : function() {
				/*
				 * $("#prizeCategorySubmitButton").click(function(){ //获取表单提交的参数
				 * var param=platform.getFormJson("#prizeCategoryForm"); var
				 * flag=$("#flag").val(); if(flag==""){ //说明是新增
				 * platform.doPost(rootPath+"/prize/savePrizeCategory.shtml",param);
				 * }else if(flag=="edit"){ //说明是更新
				 * platform.doPost(rootPath+"/prize/editPrizeCategory.shtml",param); } })
				 */}
		},
		prizeStrategy :{
			query:function(){
				$(document).on('click', '#queryParam #prizeStrategyCdButtons', function(){
					var param=platform.getFormJson("#queryParam");
					var sprizeNameByCd = param['sprizeNameByCd'];
					var sorganCodesByCd = param['sorganCodesByCd'];
					var timeIsOver=  param['timeIsOver'];
					var nei = $("#nei").val();
					var wai = $("#wai").val();
					var url = rootPath+"/user/prizestrategy/findAllPrizeMaterial.shtml";
					var bigstrs = "";
					$.post(
							url,
							{'sprizeNameByCd':sprizeNameByCd,'sorganCodesByCd':sorganCodesByCd,'timeIsOver':timeIsOver},
							function(data) {
							if(data==null||data==""){
								$("#queryParam").find("table").eq(1).html("");
							return;
							}
						           var carr = $("input[name='checkedIds']")
						           $(data).each(
											function(index, dom) {
												var str = "";
													if(dom['isShow'] == 0){
														str += " <tr style='display:none;'>"
													}else{
														
														str += " <tr>"
													}
												if (carr.length > 1) {
													for (var i = 0; i < carr.length; i++) {
														// alert($(carr[i]).val()==dom['id'])
														if ($(carr[i])
																.val() == dom['id']) {
															var str1 = "<td style='width:10%;padding: 10px  !important;'><input type='checkbox' name='materialChecked' disabled='disabled' value="
																	+ dom['id']
																	+ "></td>"
															break;
														} else {
															var str1 = "<td style='width:10%;padding: 10px  !important;'><input type='checkbox' name='materialChecked' value="
																	+ dom['id']
																	+ "></td>"
														}
													}
												} else {
													var str1 = "<td style='width:10%;padding: 10px  !important;'><input type='checkbox' name='materialChecked' value="
															+ dom['id']
															+ "></td>"
												}
												str += str1
												/*str += "<td style='width:10%'>"
														+ (index + 1)
														+ "</td>"*/
												str += "<td style='width:19%;padding: 10px  !important;'>"
															+ dom['prizeName']
															+ "</td>"	
															
											
												/*		if(dom['sourceName']==null||
																dom['sourceName']==""){
															str += "<td style='width:13%'>"
																+ dom['prizeName']
																+ "</td>"
														}else{
															str += "<td style='width:13%'>"
																+ dom['sourceName']
																+ "</td>"
														}*/
											/*	str += "<td><img src="
														+ dom['logo8Url']
														+ " id='logoimg' style='width:30px;height:30px'></td>"*/
												if (dom['sourceName'] == null
														|| dom['sourceName'] == "") {
													str += "<td style='width:19%;padding: 10px  !important;'></td>"
												} else {
													str += "<td style='width:19%;padding: 10px  !important;'>"
															+ dom['sourceName']
															+ "</td>"
												}
												str += "<td style='width:16%;padding: 10px  !important;'>"
												    + dom['availableCount']
													+ "</td>"
												
												if(dom['sourceType'] == null){
													str += "<td style='width:16%;padding: 10px  !important;'>      </td>"
												}else{
												if (dom['sourceType'] == 0) {
													str += "<td style='width:16%;padding: 10px  !important;'>虚拟奖</td>"
												}
												
												if (dom['sourceType'] == 1) {
													str += "<td style='width:16%;padding: 10px  !important;'>实物奖</td>"
												}
												if (dom['sourceType'] == 2) {
													str += "<td style='width:16%;padding: 10px  !important;'>权益</td>"
												}
												if (dom['sourceType'] == 3) {
													str += "<td style='width:16%;padding: 10px  !important;'>红包</td>"
												}
												if (dom['sourceType'] == 4){
													str += "<td style='width:16%;padding: 10px  !important;'>运营定制</td>"
												}
												if (dom['sourceType'] == 5){
													str += "<td style='width:16%;padding: 10px  !important;'>客户定制</td>"
												}
												
												}
												
												if (dom['oldOrNew'] == 1){
													str += "<td  class=''  id='old1' style='width:16% ;padding: 10px  !important;'>内</td>"
												}
												if(dom['oldOrNew'] == 2){
													str += "<td  style='width:16%;padding: 10px  !important;' value=2>外</td>"
												}
												if (dom['isShow'] == 0){
													str += "<td  class=''  id='isShow' style='width:16% ;padding: 2px  !important;  '>隐藏</td>"
												}
												if(dom['isShow'] == 1){
													str += "<td  style='width:16%;padding: 2px  !important; ' value=1>展示</td>"
												}
												/*
												 * if(dom['level']==1){
												 * str+="<td style='width:13%'>一等奖</td>"
												 * }else
												 * if(dom['level']==2){
												 * str+="<td style='width:13%'>二等奖</td>"
												 * }else
												 * if(dom['level']==3){
												 * str+="<td style='width:13%'>三等奖</td>"
												 * }else
												 * if(dom['level']==4){
												 * str+="<td style='width:13%'>普奖</td>"
												 * }else{ str+="<td style='width:13%'></td>" }
												 */

											/*	if (dom['name'] == null
														|| dom['name'] == '') {
													str += "<td style='width:30%'>通用奖品</td>";
												} else {
													str += "<td style='width:30%'>"
															+ dom['name']
															+ "</td>";
												}*/
												
												str += "</tr>";
												bigstrs += str;
											});
							   
							    console.log(document.getElementById("bigstrs"))
							
							   
//					    document.getElementById("prizeStranegyTbreal").innerHTML = bigstr;
//							document.getElementsByClassName("prizeStranegyTbreal")[0].innerHTML = bigstr;
							    $(".prizeStranegyTbreal").html(bigstrs)
							      console.log(document.getElementById("prizeStranegyTbreal"))

						}, "json");
				})
				
				$(document).on('change',".collectionClass",function(){
					 var type=$(this).val();
					 var tableIndex=$("#tab-1").find("table").index($(this).parent().parent())
					 if(type==2){
						$(this).parent().find(".constantType").hide();
						$(this).parent().parent().find(".weightorsort").html("顺序编号");
						$(this).parent().parent().find(".reduceweightorsort").html("多次顺序");
						$($("#tab-1").find("table:eq("+tableIndex+")").find("tbody").find("tr")).each(function(index,dom){
							$(this).find(".class10").attr("name","mlist["+tableIndex+"].plist["+index+"].sort");
							$(this).find(".class14").attr("name","mlist["+tableIndex+"].plist["+index+"].moreSort");
						})
					 }if(type==1){
						$(this).parent().find(".constantType").show();
						$(this).parent().parent().find(".weightorsort").html("权重");
						$(this).parent().parent().find(".reduceweightorsort").html("多次递减");
						$($("#tab-1").find("table:eq("+tableIndex+")").find("tbody").find("tr")).each(function(index,dom){
							$(this).find(".class10").attr("name","mlist["+tableIndex+"].plist["+index+"].weight");
							$(this).find(".class14").attr("name","mlist["+tableIndex+"].plist["+index+"].moreWeight");
						})
					 }
					 
				})
			},
			
			findAllOrgan3 : function() {
				var url = rootPath + "/user/material/findAllOrgan.shtml";
				$.post(url, {}, function(data) {
					var organCodes = $("#materialWithOrgans").val();
					$(data).each(
							function(index, dom) {
								if (organCodes == null
										|| typeof (organCodes) == 'undefined') {
									// alert(2222);
									var strn = "<option value='" + dom['code']
											+ "'>" + dom['name'] + "</option>"
									$("#prizeMaterialOrganForms").append(strn);
								} else {
									if (organCodes == dom['code']) {
										var str = "<option value='"
												+ dom['code'] + "' selected>"
												+ dom['name'] + "</option>"
										$("#prizeMaterialOrganForms").append(
												str);
									} else {
										var str = "<option value='"
												+ dom['code'] + "'>"
												+ dom['name'] + "</option>"
										$("#prizeMaterialOrganForms").append(
												str);
									}
								}
							})
				}, 'json');
			},
			page : function() {
				$(".fd_page li").find("a").click(
						function() {
							var projectName = $("#projectName").val();
							var strategyName = $("#strategyName").val();
							var theTime = $("#date-range2").val();
							var page = $(this).attr("assignPage");
							if(platform.isNull(page)){
								return;
							}
							/*var theConnect = document
									.getElementById("theConnect").value;*/
							var theConnect = null;
							/*var theOnLine = document
									.getElementById("theOnLine").value;*/
							var theOnLine = null;
							platform.doGet(platform.getRequestStrategyUrl(page,
									strategyName, theTime, projectName,
									theConnect, theOnLine));
						});
				
				$(".sfd_page_lml li").find("a").click(
						function() {
							var projectName = $("#projectName").val();
							var strategyName = $("#strategyName").val();
							var theTime = $("#date-range2").val();
							var page = $(this).attr("assignPage");
							if(platform.isNull(page)){
								return;
							}
							/*var theConnect = document
									.getElementById("theConnect").value;*/
							var theConnect = null;
							/*var theOnLine = document
									.getElementById("theOnLine").value;*/
							var theOnLine = null;
							platform.doGet(platform.getRequestStrategyUrllml(page,
									strategyName, theTime, projectName,
									theConnect, theOnLine));
						});
			},
			
			list : function() {
				//原有策略页面添加按钮
				$("#toAddStrategyButton")
						.click(
								function() {
									// 跳转添加策略界面
									platform
											.doGet(rootPath
													+ "/user/prizestrategy/toAddStrategy.shtml");
								});
				
				//------过渡策略按钮
				$("#toAddStrategyButtonForTransition")
				.click(
						function() {
						contentHtml=$('#add').html()
						 var indexs = layer.open({
								title : '新建策略',
								type : 1,
								skin : 'layui-layer-rim',
								area : [ '40%', '30%' ],
								scrollbar : false,
								content : "<div id='addlayer'>"+contentHtml+"</div>",
								cancel : function(index, layero) {
									layer.close(indexs)
								}
							});
						});
				
				/**
				 * 新增策略
				 */
				var indexs = "";
				$(document).on('click','#addlayer #addButton',function() {
						var param=platform.getFormJson("#addlayer");
						if (param == "" || param == null) {
							layer.alert("请输入策略名称");
							return;
						}
						var strategyName =param['strategyNameAdd'];
									platform
											.doGet(rootPath+ "/user/newPrizestrategy/toAddForTransition.shtml?strategyName="+strategyName);
									layer.close(indexs);
								})
				/**
				 * 查询已上线的策略
				 */
				$("#toChangeFind1")
						.click(
								function() {
									var projectName = document
											.getElementById("projectName").value;
									var strategyName = document
											.getElementById("strategyName").value;
									var theTime = document
											.getElementById("date-range2").value;
									platform
											.doGet(rootPath
													+ "/user/prizestrategy/list.shtml?theOnLine="
													+ "isTrue"
													+ "&projectName="
													+ projectName
													+ "&strategyName="
													+ strategyName
													+ "&theTime=" + theTime);
									$("#theOnLine").val("isTrue");
								});
				/**
				 * 查询通用的策略
				 */
				$("#toChangeFind2")
						.click(
								function() {
									var projectName = document
											.getElementById("projectName").value;
									var strategyName = document
											.getElementById("strategyName").value;
									var theTime = document
											.getElementById("date-range2").value;
									platform
											.doGet(rootPath
													+ "/user/prizestrategy/list.shtml?theConnect="
													+ "isTrue"
													+ "&projectName="
													+ projectName
													+ "&strategyName="
													+ strategyName
													+ "&theTime=" + theTime);
									$("#theConnect").val("isTrue");
								});

				$("#prizeStranegyTb")
						.find(".btn-warning")
						.click(
								function() {
									var id = $(this).attr("name");
									layer
											.confirm(
													'确定删除吗？',
													{
														btn : [ '确定', '取消' ],
														yes : function(index) {
															layer.close(index);
															var url = rootPath
																	+ "/user/prizestrategy/deletePrizeCategoryById.shtml";
															var param = {
																id : id
															};
															$
																	.post(
																			url,
																			param,
																			function(
																					data) {
																				if (data == "deleteError") {
																					platform
																							.deleteError();
																				} else {
																					platform
																							.doPost(rootPath
																									+ "/user/prizestrategy/list.shtml");
																				}
																			});
														}
													// 按钮
													}, function() {
														return;
													});
								})
								
								$(".deleteStrategyButtonForTransition")
						.click(
								function() {
									var id = $(this).attr("name");
									layer
											.confirm(
													'确定删除吗？',
													{
														btn : [ '确定', '取消' ],
														yes : function(index) {
															layer.close(index);
															var url = rootPath
																	+ "/user/prizestrategy/deletePrizeCategoryById.shtml";
															var param = {
																id : id
															};
															$
																	.post(
																			url,
																			param,
																			function(
																					data) {
																				if (data == "deleteError") {
																					platform
																							.deleteError();
																				} else {
																					platform
																							.doPost(rootPath
																									+ "/user/prizestrategy/listForTransition.shtml");
																				}
																			});
														}
													// 按钮
													}, function() {
														return;
													});
								})
								
								$(document).ready(function() {
					    $("#loading").hide();
				 });

				/**
				 * 根据条件查询
				 */
				$("#prizeStrategyCdButton")
						.click(
								function() {
									// 获取表单提交的参数 增加查询的条件 公司 以及项目
									var projectName = document
											.getElementById("projectName").value;
									var strategyName = document
											.getElementById("strategyName").value;
									var theTime = document
											.getElementById("date-range2").value;
									/*var theConnect = document
											.getElementById("theConnect").value;*/
									var theConnect = null;
									/*var theOnLine = document
											.getElementById("theOnLine").value;*/
									var theOnLine = null;
									$("#loading").show();
									platform
											.doGet(rootPath
													+ "/user/prizestrategy/list.shtml?projectName="
													+ projectName
													+ "&strategyName="
													+ strategyName
													+ "&theTime=" + theTime
													+ "&theConnect="
													+ theConnect
													+ "&theOnLine=" + theOnLine);
								})
					/*			
				 * 根据条件查询----过渡策略页面
				 */
				$("#prizeStrategyCdButtonForTransition")
						.click(
								function() {
									// 获取表单提交的参数 增加查询的条件 公司 以及项目
									var projectName = document
											.getElementById("projectName").value;
									var strategyName = document
											.getElementById("strategyName").value;
									var theTime = document
											.getElementById("date-range2").value;
									var setisLML = document
										.getElementById("setisLML").value;
									/*var theConnect = document
											.getElementById("theConnect").value;*/
									var theConnect = null;
									/*var theOnLine = document
											.getElementById("theOnLine").value;*/
									var theOnLine = null;
									$("#loading").show();
									platform
											.doGet(rootPath
													+ "/user/prizestrategy/listForTransition.shtml?projectName="
													+ projectName
													+ "&strategyName="
													+ strategyName
													+ "&theTime=" + theTime
													+ "&theConnect="
													+ theConnect
													+ "&theOnLine=" + theOnLine
											+"&islml="+setisLML);
								})


				/**
				 * 跳转更新
				 */
				$("#prizeStranegyTb")
						.find(".btn-success")
						.click(
								/*function() {
									var id = $(this).attr("name");
									platform
											.doGet(rootPath
													+ "/user/prizestrategy/toEditStranegy.shtml?id="
													+ id);
								}*/)
								$(".table")
						.find(".btn-primary")
						.click(
								function() {
									var id = $(this).attr("name");
									var url = rootPath
											+ "/user/prizestrategy/findUseingProjectById.shtml"
									$
											.post(
													url,
													{
														id : id
													},
													function(data) {
														// alert(data['message'])
														if (data['message'] == 'ok') {
															var str = "";
															$(data['list'])
																	.each(
																			function(
																					index,
																					dom) {
																				var endTime = "";
																			
																				var d = new Date(
																						dom['createTime'])
																				str += "<tr>";
																				str += "<td class=''>"
																						+ dom['name']
																						+ "</td>";
																				str += "<td scope='row'>"
																						+ d
																								.toLocaleString()
																						+ "</td>";
																				str += "<td class=''>"
																						+ dom['code']
																						+ "</td>";
																				str += "</tr>";
																			});
															$("#cusingbody")
																	.html(str)

															var index = layer
																	.open({
																		title : '策略用途',
																		type : 1,
																		btn : [ "确认" ],
																		yes : function(
																				index,
																				layero) {
																			layer
																					.close(index)
																		},
																		skin : 'layui-layer-rim',
																		area : [
																				'40%',
																				'50%' ],
																		scrollbar : false,
																		content : $(
																				'#cusing')
																				.html(),
																		cancel : function(
																				index,
																				layero) {
																			layer
																					.close(index)
																		}
																	});
														} else {
															layer
																	.alert(data['message'])
														}
													}, 'json')
								})
				Date.prototype.toLocaleString = function() {
					return this.getFullYear() + "年" + (this.getMonth() + 1)
							+ "月" + this.getDate() + "日 ";
				}
								
				/**
				 * 素材复制弹框 ///
				 */
				$(".table").find(".btn-info").click(function() {
					var id = $(this).attr("name");
					$("#strategyId").val(id);
					var url=rootPath
					+ "/user/prizestrategy/findByprizestrategyPrizeId.shtml";
					$.post(
							url,
							{"id":id},
							function(data) {
								
								var strategyName=data.strategyName;
								$("#copyForm").find("#strategyNameCopy").val(strategyName);
							},'json')
								var indexs = layer.open({
									title : '策略复制',
									type : 1,
									skin : 'layui-layer-rim',
									area : [ '40%', '40%' ],
									scrollbar : false,
									content : $('#copy').html(),
									cancel : function(index, layero) {
										layer.close(indexs)
									}
								});
				})
				
				/**
				 * 素材复制
				 */
				var indexs = "";
				$(document).on('click','#copyButton',function() {
									var id = $("#strategyId").val();
									var param = platform.getFormJson("#copyForm");
									// alert(JSON.stringify(param))
									
									var strategyName = param['strategyName'];
									//alert(skipUrl)
									// alert(organCode);
									if (strategyName == "" || strategyName == null) {
										layer.alert("请输入策略名称");
										return;
									}
									platform
											.doGet(rootPath
													+ "/user/prizestrategy/copyPrizestrategyPrizeIdForTransition.shtml?id="
													+ id + "&strategyName="
													+ strategyName);
									layer.close(indexs);
								})
								
								
								
								$(document).on('click','#copyButtonForTransition',function() {
									var id = $("#strategyId").val();
									var param = platform.getFormJson("#copyForm");
									// alert(JSON.stringify(param))
									
									var strategyName = param['strategyName'];
									//alert(skipUrl)
									// alert(organCode);
									if (strategyName == "" || strategyName == null) {
//										layer.alert("请输入策略名称");
										alert("请输入策略名称");
										return;
									}
									platform
											.doGet(rootPath
													+ "/user/prizestrategy/copyPrizestrategyPrizeIdForTransition.shtml?id="
													+ id + "&strategyName="
													+ strategyName);
									layer.close(indexs);
								})
			},

			checklength : function() {
				var length = document.getElementById("prizeMaterialTableAdd").rows.length;
				if (length <= 1) {
					$("#noValueTips").show();
				} else {
					$("#noValueTips").hide();
				}
			},
			//过渡策略common页面所用
			checklength : function() {
				var str =$("#collectionDiv").children().length; 
				if (str<=0) {
					$("#noValueTips").show();
				} else {
					$("#noValueTips").hide();
				}
			},
			/**
			 * 获得拼接的串
			 * 
			 * @param index
			 * @param options
			 */
			getStrategyType : function(index, options) {
				var strategyType1 = "<td class='strategyType'><select name='mlist[";
				var strategyType2 = "].strategyType' type='text' class='form-control select2 class6' style='width: 100px;padding:0 0;height:25px;'>";
				var strategyType3 = "</select></td>";
				return strategyType1 + index + strategyType2 + options
						+ strategyType3;
			},
			/**
			 * 获得策略类型对应的条目
			 */
			getOptions : function(id) {
				var options = "";
				$.ajax({
					type : "post",
					url : rootPath
							+ "/user/prizestrategy/getStrategyType.shtml",
					data : {
						'key' : id
					},
					async : false,
					dataType : "json",
					success : function(data) {
						if (data.status == 200) {
							var items = data.data;
							$(items).each(
									function(index, item) {
										options += "<option value='" + item.id
												+ "'>" + item.itemName
												+ "</option>";
									})
						}
					}
				});
				return options;
			},
			/**
			 * 获得策略类型头部
			 */
			getStrategyTypeHeader : function() {
				var str = "<td class='stHeader' style='width:9%'><span style='display: inline-block; width: 10px; "
						+ "height: 10px; background: #ff774e; margin-right: 5px;'></span>策略类型</td>";
				return str;
			},
			/**
			 * 检测定时器是否已经存在
			 */
			validateTimer:function(url,param){
				var flag=0;
				$.ajax({
				type : "POST",
				url : url,
				async:false,
				data : param,
				dataType : "json",
				success : function(data){
					if(data.status==500){
						 layer.msg(data.msg, {icon: 2})
						 flag=1
						 return;
					}else{
						return;
					}
				}
				})
				return flag;
			},



			/**
			 * 保存数量重置或者是权重重置
			 */
			saveReset:function(urlx,paramx,index,islml,id){

				$.ajax({
					type : "POST",
					url : urlx,
					data : paramx,
					dataType : "json",
					success : function(data){
						if(data.status==200){
							//by lgj
							$(".setImg span").eq(index).attr("flag",'true');
							//layer.msg('提交成功', {icon: 1})
							// window.location.href = rootPath+ "/prizesResetList.shtml?prizeManagerId="+id+"&islml="+islml;
							window.open(rootPath+ "/prizesResetList.shtml?prizeManagerId="+id+"&islml="+islml)
						}else{
							layer.msg(data.msg, {icon: 2})
							//console.log($(this))
						}
					}
				})

			},
			/**
			 * 保存定时器的相关信息
			 */
			saveJob:function(urlx,paramx,index,islml){
				$.ajax({
					type : "POST",
					url : urlx,
					data : paramx,
					dataType : "json",
					success : function(data){
						if(data.status==200){
							$(".setImg span").eq(index).attr("flag",'false');
							 layer.msg('提交成功', {icon: 1})
							  //console.log($(this))
						}else{
							layer.msg(data.msg, {icon: 2})
							  //console.log($(this))
						}
						}
					})
				
			},
			add : function() {
				$("#specific")
						.change(
								function() {
									var id = $(this).val();
									if (id == 0) {
										$("#prizeMaterialTableAdd").find(
												".stHeader").remove();
										$("#prizeMaterialTableAdd").find(
												".strategyType").remove();
										return;
									}
									var stHeader = $("#prizeMaterialTableAdd")
											.find(".stHeader");
									if (!platform.isNull(stHeader)
											&& stHeader.length > 0) {
										return;
									}
									var options = platform.prizeStrategy
											.getOptions(id);
									var trs = $("#prizeMaterialTableAdd").find(
											"tr");
									$(trs)
											.each(
													function(index, item) {
														var lastTd = $(item)
																.find("td:last");
														if (index == 0) {
															$(lastTd)
																	.before(
																			platform.prizeStrategy
																					.getStrategyTypeHeader());
														} else {
															$(lastTd)
																	.before(
																			platform.prizeStrategy
																					.getStrategyType(
																							index - 1,
																							options));
														}
													})
								});
				$("#checkRealButton").off('click').on(
						'click',
						function() {
							
							platform.findAllThePrizeClassify()
							var carr = $("input[name='checkedIds']")
							var length = carr.length;
							layer.msg('已选择了' + length + "个奖品，最多还可选择"
									+ (10 - length) + "个奖品",
									{
										time : 0 // 不自动关闭
										,
										btn : [ '去选择', '不要了' ],
										maxWidth : 192,
										yes : function(index) {
											layer.close(index);
											var contentHtml = $(
													"#realPrizeDiv3").html();
											var index = layer.open({
												type : 1,
												title : '选择奖品',
												skin : 'layui-layer-rim', // 加上边框
												area : [ '952px', '600px' ], // 宽高
												content : "<div id='queryParam'>"+contentHtml+"</div>",
											});
											$("#realPrizeDiv3").attr(
													"layIndex", index);
										}
									});
						})
						
						//过渡策略部分---添加奖品
						$(document).off("click",".checkRealButton").on("click",".checkRealButton",function(){
						var tableIndex= $(this).parents("table").index();
						
							platform.findAllThePrizeClassify();
											var contentHtml = $(
													"#realPrizeDiv3").html();
											var index = layer.open({
												type : 1,
												title : '选择奖品',
												skin : 'layui-layer-rim', // 加上边框
												area : [ '920px', '600px' ], // 宽高
												content : "<div id='queryParam'>"+contentHtml+"</div>",
											});
											$("#realPrizeDiv3").attr(
													"layIndex", index);
											$("#realPrizeDiv3").attr(
													"tableIndex", tableIndex);
						})
						//定时器部分1
					$(document).off("click",".setImg span").on("click",".setImg span",function(){
					var id= $(this).attr("name");
					var index=$(this).index();
					var islml = $("#islml").val()
					console.log(islml);
					if($(this).attr("flag")=='false'){
						layer.msg('请勿重复新增', {icon: 2})
						return;
						//console.log($(this))
					}
					if(id==""||id==undefined||id==null){
						layer.msg("请先保存该条策略", {
							time : 5000,
							icon : 6
						});
					}
					var flag=0;
					if(index==0){
						var urls=rootPath+"/user/newPrizestrategy/validateTimer.shtml";
						params={
								prizeManagerId:id,
								type:1,
								islml:islml
						}
						flag= platform.prizeStrategy.validateTimer(urls,params);
					}
					if(index==1){
						var urls=rootPath+"/user/newPrizestrategy/validateTimer.shtml";
						params={
								prizeManagerId:id,
								type:2,
								islml:islml
						}
						flag=platform.prizeStrategy.validateTimer(urls,params);
					}
					if(flag>0){
						//return;
					}
					var param={'id':id,'islml':islml};
					var url=rootPath+ "/user/newPrizestrategy/findPrizeManagerByIds.shtml"
					$.ajax({
						type : "POST",
						url : url,
						async:false,
						data : param,
						dataType : "json",
						success : function(data) {
							var skipurl=data.skipUrl;
							if(index==0){
								// var str="<div id='layerTips'  class='layerTips'>"+
						     	//  "<h4>"+data.prizeName+"</h4><ul>"+
						     	//  "<li><span>重置时间</span><input plac class='layerCO class11 timeWidthH form-control layer-date' name='time' value='' placeholder='请输入24小时制时间' /></li>"+
						     	//  "<li><span>开始时间</span><input plac class='layerCO class11 timeWidthH form-control layer-date' name='startTime' value='' onclick='laydate()' /></li>"+
						     	//  "<li><span>结束时间</span><input plac class='layerCO class11 timeWidthH form-control layer-date' name='endTime' value='' onclick='laydate()' /></li>"+
						     	//  "<li><span>重置数量</span><input type='text' name='amount' value='' /></li><li><span>重置周期</span>"+
						     	//  "<input type='hidden' name='resetType' value='1' />"+
						     	//  "<input type='hidden' name='dataSourceType' value='"+islml+"' />"+
						     	//  "<input type='hidden' name='prizeName' value='"+data.prizeName+"' />"+
						     	//  "<input type='hidden' name='prizeManagerId' value='"+data.id+"' />"+
						     	//  "<select id='isTrue' name='cronType' type='text' class='select2 class6 setWidth' >"+
						     	//  "<option value='1' selected='selected'>每天</option>"+
						     	//  "<option value='2'>每周一</option>"+
						     	//  "<option value='3'>每个月一号</option>"+
						     	//  "<option value='4'>每周一到周五</option>"+
						     	//  "<option value='5'>每周六，周日</option></select> </li></ul></div>"
								var str ='<div class="layui-form"><span>请选择添加重置项：</span><div style="width:120px;display: inline-block;"><select name="resetChoice" id="testSelect" style="width: 100px;height: 28px;border-radius: 3px;"><option value="1" selected>数量重置</option><option value="2">权重重置</option></select></div></div>'
						     	 layer.confirm(str, {
								  btn: ['取消','确定'] 
								},function (index) {
							    	layer.close(index);
								},function(index){
									 var resetChoiceVal = $('#testSelect option:selected').val()
									 var paramx={'id':id,'islml':islml,'resetType':resetChoiceVal};
									// var paramx=platform.getFormJson("#layerTips");
									//alert(JSON.stringify(paramx))
									//var urlx=rootPath+"/user/newPrizestrategy/saveOrUpdateJob.shtml";
									 var urlx=rootPath+"/user/newPrizestrategy/saveResetPrizeManager.shtml";
									//platform.prizeStrategy.saveJob(urlx,paramx,index,islml)
									 platform.prizeStrategy.saveReset(urlx,paramx,index,islml,id);
									 layer.close(index);

								});
							}else if(index==1){
								var str="<div id='layerTips'  class='layerTips'>"+
						     	 "<h4>"+data.prizeName+"</h4><ul>"+
						     	 "<li><span>生效时间</span><input plac class='layerCO class11 timeWidthH form-control layer-date' name='time' value='' placeholder='请输入24小时制时间' /></li>"+
						     	 "<li><span>失效时间</span><input plac class='layerCO class11 timeWidthH form-control layer-date' name='recoverTime' value='' placeholder='请输入24小时制时间' /></li>"+
						     	 "<li><span>开始时间</span><input plac class='layerCO class11 timeWidthH form-control layer-date' name='startTime' value='' onclick='laydate()' /></li>"+
						     	 "<li><span>结束时间</span><input plac class='layerCO class11 timeWidthH form-control layer-date' name='endTime' value='' onclick='laydate()' /></li>"+
						     	 "<li><span>生效权重</span><input type='text' name='strategyWeight' value='' /></li><li><span>重置周期</span>"+
						     	 "<input type='hidden' name='resetType' value='2' />"+
						     	"<input type='hidden' name='dataSourceType' value='"+islml+"' />"+
						     	 "<input type='hidden' name='prizeName' value='"+data.prizeName+"' />"+
						     	 "<input type='hidden' name='prizeManagerId' value='"+data.id+"' />"+
						     	"<input type='hidden' name='resetStatus' value='1' />"+
						     	 "<select id='isTrue' name='cronType' type='text' class='select2 class6 setWidth' >"+
						     	 "<option value='1' selected='selected'>每天</option>"+
						     	 "<option value='2'>每周一</option>"+
						     	 "<option value='3'>每个月一号</option>"+
						     	 "<option value='4'>每周一到周五</option>"+
						     	 "<option value='5'>每周六，周日</option></select> </li></ul></div>"
						     	 layer.confirm(str, {
								  btn: ['确定','取消'] 
								}, function(){
									var paramx=platform.getFormJson("#layerTips");
									var urlx=rootPath+"/user/newPrizestrategy/saveOrUpdateJob.shtml";
									platform.prizeStrategy.saveJob(urlx,paramx,islml)
								});
							}else{
								
				  layer.alert(skipurl, {
				    skin: 'layui-layer-molv'
				    ,closeBtn: 0
				    ,anim: 4 //动画类型
				  });

							}
							
							}
						})
				})
				
				 /**
				  * 点击应用进行修改定时任务
				  */
					//修改
	$(document).off("click",".setChange").on('click','.setChange',function(){
	var html=$(this).html()
	if(html=="应用"){
		var trHtmlText=$(this).parent().parent();
		var url=rootPath+"/user/newPrizestrategy/updateJob.shtml";
		var param=platform.getFormJson(trHtmlText);
		var islml = $("#islml").val()
		console.log(param);
		$.ajax({ 
			type : "POST",
			url : url,
			data : param,
			dataType : "json",
			success : function(data) {
				if(data.status==200 && data.data!=null){
					$(".setChange").html("修改")
					$(".setChange").parents('tr').find("input,select").attr("disabled",true)
					layer.msg("修改成功", {
						time : 5000,
						icon : 1
					});
				}else{
					layer.msg(data.msg, {
						time : 5000,
						icon : 2
					});
				}
			
			}
		
		})
		
	}else{
		$(this).html("应用")
		$(this).parents('tr').find("input,select").removeAttr("disabled");
	}
	})
	
		//上移
	$ ('.moveUp').click (function ()
        {
		var lengthpm=$("#tab-1").find("input:checkbox[name='pManager']:checked").length;
		var length= $("#tab-1").find("input:checkbox[name='collectionSet']:checked").length;
		if(lengthpm==0&&length==0){
			layer.msg("请勾选移动项！", {
				time : 5000,
				icon : 2
			});
			return false;
		}
		if(length>0){
			$("#tab-1").find("input:checkbox[name='collectionSet']:checked").each(function(){
				var tableIndex=$("#tab-1").find("table").index($(this).parent().parent());
				//alert(tableIndex)
				if(tableIndex==0){
					layer.msg("存在到顶位置！", {
    					time : 5000,
    					icon : 2
    				});
					return false;
				}
				var ptr=$("#tab-1").find("table").eq(tableIndex);
				ptr.prev().before(ptr)
				$($("#collectionDiv").find("table")).each(function(index,dom){
						var isweightorsort= $(this).find(".collectionClass").val();
						$(this).find(".sclass1").attr("name","mlist["+index+"].isWeightOrSort");
						$(this).find(".sclass2").attr("name","mlist["+index+"].unitSort");
						$(this).find(".sclass3").attr("name","mlist["+index+"].redKeep");
						$(this).find(".sclass4").attr("name","mlist["+index+"].swKeep");
						$(this).find(".sclass5").attr("name","mlist["+index+"].nextUnitWeight");
						$($("#tab-1").find("table:eq("+index+")").find("tbody").find("tr")).each(function(index1,dom){
							$(this).find(".class1").attr("name","mlist["+index+"].plist["+index1+"].prizeName");
							$(this).find(".class2").attr("name","mlist["+index+"].plist["+index1+"].sourceName");
							$(this).find(".class3").attr("name","mlist["+index+"].plist["+index1+"].prizeValue");
							$(this).find(".class4").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.id");
							$(this).find(".class5").attr("name","mlist["+index+"].plist["+index1+"].id");
							$(this).find(".class6").attr("name","mlist["+index+"].plist["+index1+"].isTrue");
							$(this).find(".class7").attr("name","mlist["+index+"].plist["+index1+"].prizeClassify.id");
							$(this).find(".class8").attr("name","mlist["+index+"].plist["+index1+"].isOneNum");
							$(this).find(".class9").attr("name","mlist["+index+"].plist["+index1+"].isSpecial");
							if(isweightorsort==1){
								$(this).find(".class10").attr("name","mlist["+index+"].plist["+index1+"].weight");
							}
							if(isweightorsort==2){
								$(this).find(".class10").attr("name","mlist["+index+"].plist["+index1+"].sort");
							}
							$(this).find(".class11").attr("name","mlist["+index+"].plist["+index1+"].logo8Url");
							$(this).find(".class12").attr("name","mlist["+index+"].plist["+index1+"].logo10Url");
							$(this).find(".class13").attr("name","mlist["+index+"].plist["+index1+"].skipUrl");
							if(isweightorsort==1){
								$(this).find(".class14").attr("name","mlist["+index+"].plist["+index1+"].moreWeight");
							}
							if(isweightorsort==2){
								$(this).find(".class14").attr("name","mlist["+index+"].plist["+index1+"].moreSort");
							}
							$(this).find(".class15").attr("name","mlist["+index+"].plist["+index1+"].prizeAmount");
							$(this).find(".class16").attr("name","mlist["+index+"].plist["+index1+"].sequenceId");
							$(this).find(".class17").attr("name","mlist["+index+"].plist["+index1+"].unitSort");
							$(this).find(".class18").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.sourceId");
							$(this).find(".class19").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.skipType");
							$(this).find(".class20").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.customId");
							$(this).find(".class21").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.appId");
							$(this).find(".class22").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.originalId");
							$(this).find(".class23").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.targetUrlType");
							$(this).find(".class24").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.labelType");
							
							//$(this).find(".prizeSort").val(index1+1);
						})
					})
			})
			return;
		}
		else{
			$("#tab-1").find("input:checkbox[name='pManager']:checked").each(function(){
				var uptr=$(this).parent().parent();
				var tableIndex=$("#tab-1").find("table").index($(this).parent().parent().parent().parent());
				//alert(tableIndex);
				if(tableIndex==0){
					layer.msg("存在到顶位置！", {
    					time : 5000,
    					icon : 2
    				});
					return false;
				}
				else{
					var pretrlength=$("#tab-1").find("table").eq(tableIndex-1).find("tbody tr").length;
					if(pretrlength==0){
						//$("#tab-1").find("table").eq(tableIndex-1).find("tbody").insertRow(0);
						//$("#tab-1").find("table").eq(tableIndex-1).find("tbody tr").after(uptr)
						var tbody=$("#tab-1").find("table").eq(tableIndex-1).find("tbody");
						uptr.appendTo(tbody);
						//uptr.remove();
					}else{
					$("#tab-1").find("table").eq(tableIndex-1).find("tbody tr").eq(pretrlength-1).after(uptr);
					}
					$(window).scrollTop($(this).offset().top - 300)
					$($("#collectionDiv").find("table")).each(function(index,dom){
						var isweightorsort= $(this).find(".collectionClass").val();
						$(this).find(".sclass1").attr("name","mlist["+index+"].isWeightOrSort");
						$(this).find(".sclass2").attr("name","mlist["+index+"].unitSort");
						$(this).find(".sclass3").attr("name","mlist["+index+"].redKeep");
						$(this).find(".sclass4").attr("name","mlist["+index+"].swKeep");
						$(this).find(".sclass5").attr("name","mlist["+index+"].nextUnitWeight");
						$($("#tab-1").find("table:eq("+index+")").find("tbody").find("tr")).each(function(index1,dom){
							$(this).find(".class1").attr("name","mlist["+index+"].plist["+index1+"].prizeName");
							$(this).find(".class2").attr("name","mlist["+index+"].plist["+index1+"].sourceName");
							$(this).find(".class3").attr("name","mlist["+index+"].plist["+index1+"].prizeValue");
							$(this).find(".class4").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.id");
							$(this).find(".class5").attr("name","mlist["+index+"].plist["+index1+"].id");
							$(this).find(".class6").attr("name","mlist["+index+"].plist["+index1+"].isTrue");
							$(this).find(".class7").attr("name","mlist["+index+"].plist["+index1+"].prizeClassify.id");
							$(this).find(".class8").attr("name","mlist["+index+"].plist["+index1+"].isOneNum");
							$(this).find(".class9").attr("name","mlist["+index+"].plist["+index1+"].isSpecial");
							if(isweightorsort==1){
								$(this).find(".class10").attr("name","mlist["+index+"].plist["+index1+"].weight");
							}
							if(isweightorsort==2){
								$(this).find(".class10").attr("name","mlist["+index+"].plist["+index1+"].sort");
							}
							$(this).find(".class11").attr("name","mlist["+index+"].plist["+index1+"].logo8Url");
							$(this).find(".class12").attr("name","mlist["+index+"].plist["+index1+"].logo10Url");
							$(this).find(".class13").attr("name","mlist["+index+"].plist["+index1+"].skipUrl");
							if(isweightorsort==1){
								$(this).find(".class14").attr("name","mlist["+index+"].plist["+index1+"].moreWeight");
							}
							if(isweightorsort==2){
								$(this).find(".class14").attr("name","mlist["+index+"].plist["+index1+"].moreSort");
							}
							$(this).find(".class15").attr("name","mlist["+index+"].plist["+index1+"].prizeAmount");
							$(this).find(".class16").attr("name","mlist["+index+"].plist["+index1+"].sequenceId");
							$(this).find(".class17").attr("name","mlist["+index+"].plist["+index1+"].unitSort");
							$(this).find(".class18").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.sourceId");
							$(this).find(".class19").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.skipType");
							$(this).find(".class20").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.customId");
							$(this).find(".class21").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.appId");
							$(this).find(".class22").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.originalId");
							$(this).find(".class23").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.targetUrlType");
							$(this).find(".class24").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.labelType");
							
							//$(this).find(".prizeSort").val(index1+1);
						})
					})
				}
			})
			
			
			
		}
//        	var insert = $('.table-1 tr :checkbox:checked').closest ('tr');
//        	if(insert.length==1 ){
//        		if(insert.index()==0){
//        			layer.msg("已经到顶了！", {
//    					time : 5000,
//    					icon : 2
//    				});
//        		}
//        		var tr = insert.prev ('tr');
//        		 tr.before(insert)
//        		 $(tr.parent().find("tr")).each(function(index,dom){
//		            	  $(this).find(".prizeSort").val(index+1)
//		            	  //$(this).find(".sequenceSort").val(index+1)
//		          })
//        	}else{
//        		var insertIndex = $ ('.table-1 tr :checkbox:checked').eq(0).closest ('tr');
//       			if(insertIndex.index()==0){
//        			layer.msg("存在第一个被选中！", {
//    					time : 5000,
//    					icon : 2
//    				});
//        		}else{
//        			var tr = insertIndex.prev ('tr');
//		            for(var i=0;i<insert.length;i++){
//		            	 tr.before(insert[i])
//		            }
//		            $(tr.parent().find("tr")).each(function(index,dom){
//		            	  $(this).find(".prizeSort").val(index+1)
//		            	  //$(this).find(".sequenceSort").val(index+1)
//		              })
//        		}
//	            
//           
//        	
			});
				
				//下移		
				 $ ('.moveDown').click (function ()
						                {
					 var lengthpm=$("#tab-1").find("input:checkbox[name='pManager']:checked").length;
						var length= $("#tab-1").find("input:checkbox[name='collectionSet']:checked").length;
						if(lengthpm==0&&length==0){
							layer.msg("请勾选移动项！", {
								time : 5000,
								icon : 2
							});
							return false;
						}
						if(length>0){
							$("#tab-1").find("input:checkbox[name='collectionSet']:checked").each(function(){
								var tableIndex=$("#tab-1").find("table").index($(this).parent().parent());
								var tablelength=$("#tab-1").find("table").length
								//alert(tableIndex)
								if(tableIndex==(tablelength-1)){
									layer.msg("存在到底位置！", {
				    					time : 5000,
				    					icon : 2
				    				});
									return false;
								}
								var ptr=$("#tab-1").find("table").eq(tableIndex);
								ptr.next().after(ptr)
								$($("#collectionDiv").find("table")).each(function(index,dom){
										var isweightorsort= $(this).find(".collectionClass").val();
										$(this).find(".sclass1").attr("name","mlist["+index+"].isWeightOrSort");
										$(this).find(".sclass2").attr("name","mlist["+index+"].unitSort");
										$(this).find(".sclass3").attr("name","mlist["+index+"].redKeep");
										$(this).find(".sclass4").attr("name","mlist["+index+"].swKeep");
										$(this).find(".sclass5").attr("name","mlist["+index+"].nextUnitWeight");
										$($("#tab-1").find("table:eq("+index+")").find("tbody").find("tr")).each(function(index1,dom){
											$(this).find(".class1").attr("name","mlist["+index+"].plist["+index1+"].prizeName");
											$(this).find(".class2").attr("name","mlist["+index+"].plist["+index1+"].sourceName");
											$(this).find(".class3").attr("name","mlist["+index+"].plist["+index1+"].prizeValue");
											$(this).find(".class4").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.id");
											$(this).find(".class5").attr("name","mlist["+index+"].plist["+index1+"].id");
											$(this).find(".class6").attr("name","mlist["+index+"].plist["+index1+"].isTrue");
											$(this).find(".class7").attr("name","mlist["+index+"].plist["+index1+"].prizeClassify.id");
											$(this).find(".class8").attr("name","mlist["+index+"].plist["+index1+"].isOneNum");
											$(this).find(".class9").attr("name","mlist["+index+"].plist["+index1+"].isSpecial");
											if(isweightorsort==1){
												$(this).find(".class10").attr("name","mlist["+index+"].plist["+index1+"].weight");
											}
											if(isweightorsort==2){
												$(this).find(".class10").attr("name","mlist["+index+"].plist["+index1+"].sort");
											}
											$(this).find(".class11").attr("name","mlist["+index+"].plist["+index1+"].logo8Url");
											$(this).find(".class12").attr("name","mlist["+index+"].plist["+index1+"].logo10Url");
											$(this).find(".class13").attr("name","mlist["+index+"].plist["+index1+"].skipUrl");
											if(isweightorsort==1){
												$(this).find(".class14").attr("name","mlist["+index+"].plist["+index1+"].moreWeight");
											}
											if(isweightorsort==2){
												$(this).find(".class14").attr("name","mlist["+index+"].plist["+index1+"].moreSort");
											}
											$(this).find(".class15").attr("name","mlist["+index+"].plist["+index1+"].prizeAmount");
											$(this).find(".class16").attr("name","mlist["+index+"].plist["+index1+"].sequenceId");
											$(this).find(".class17").attr("name","mlist["+index+"].plist["+index1+"].unitSort");
											$(this).find(".class18").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.sourceId");
											$(this).find(".class19").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.skipType");
											$(this).find(".class20").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.customId");
											$(this).find(".class21").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.appId");
											$(this).find(".class22").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.originalId");
											$(this).find(".class23").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.targetUrlType");
											$(this).find(".class24").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.labelType");
											//$(this).find(".prizeSort").val(index1+1);
										})
									})
							})
							return;
						}
						else{
							$("#tab-1").find("input:checkbox[name='pManager']:checked").each(function(){
								var uptr=$(this).parent().parent();
								var tableIndex=$("#tab-1").find("table").index($(this).parent().parent().parent().parent());
								var tablelength=$("#tab-1").find("table").length
								//alert(tableIndex);
								if(tableIndex==tablelength-1){
									layer.msg("存在到底位置！", {
				    					time : 5000,
				    					icon : 2
				    				});
									return false;
								}
								else{
									var pretrlength=$("#tab-1").find("table").eq(tableIndex+1).find("tbody tr").length;

									if(pretrlength==0){
										//$("#tab-1").find("table").eq(tableIndex-1).find("tbody").insertRow(0);
										//$("#tab-1").find("table").eq(tableIndex-1).find("tbody tr").after(uptr)
										var tbody=$("#tab-1").find("table").eq(tableIndex+1).find("tbody");
										uptr.appendTo(tbody);
										//uptr.remove();
									}else{
									$("#tab-1").find("table").eq(tableIndex+1).find("tbody tr").eq(pretrlength-1).after(uptr);
									}
									$(window).scrollTop($(this).offset().top - 300)
									$($("#collectionDiv").find("table")).each(function(index,dom){
										var isweightorsort= $(this).find(".collectionClass").val();
										$(this).find(".sclass1").attr("name","mlist["+index+"].isWeightOrSort");
										$(this).find(".sclass2").attr("name","mlist["+index+"].unitSort");
										$(this).find(".sclass3").attr("name","mlist["+index+"].redKeep");
										$(this).find(".sclass4").attr("name","mlist["+index+"].swKeep");
										$(this).find(".sclass5").attr("name","mlist["+index+"].nextUnitWeight");
										$($("#tab-1").find("table:eq("+index+")").find("tbody").find("tr")).each(function(index1,dom){
											$(this).find(".class1").attr("name","mlist["+index+"].plist["+index1+"].prizeName");
											$(this).find(".class2").attr("name","mlist["+index+"].plist["+index1+"].sourceName");
											$(this).find(".class3").attr("name","mlist["+index+"].plist["+index1+"].prizeValue");
											$(this).find(".class4").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.id");
											$(this).find(".class5").attr("name","mlist["+index+"].plist["+index1+"].id");
											$(this).find(".class6").attr("name","mlist["+index+"].plist["+index1+"].isTrue");
											$(this).find(".class7").attr("name","mlist["+index+"].plist["+index1+"].prizeClassify.id");
											$(this).find(".class8").attr("name","mlist["+index+"].plist["+index1+"].isOneNum");
											$(this).find(".class9").attr("name","mlist["+index+"].plist["+index1+"].isSpecial");
											if(isweightorsort==1){
												$(this).find(".class10").attr("name","mlist["+index+"].plist["+index1+"].weight");
											}
											if(isweightorsort==2){
												$(this).find(".class10").attr("name","mlist["+index+"].plist["+index1+"].sort");
											}
											$(this).find(".class11").attr("name","mlist["+index+"].plist["+index1+"].logo8Url");
											$(this).find(".class12").attr("name","mlist["+index+"].plist["+index1+"].logo10Url");
											$(this).find(".class13").attr("name","mlist["+index+"].plist["+index1+"].skipUrl");
											if(isweightorsort==1){
												$(this).find(".class14").attr("name","mlist["+index+"].plist["+index1+"].moreWeight");
											}
											if(isweightorsort==2){
												$(this).find(".class14").attr("name","mlist["+index+"].plist["+index1+"].moreSort");
											}
											$(this).find(".class15").attr("name","mlist["+index+"].plist["+index1+"].prizeAmount");
											$(this).find(".class16").attr("name","mlist["+index+"].plist["+index1+"].sequenceId");
											$(this).find(".class17").attr("name","mlist["+index+"].plist["+index1+"].unitSort");
											$(this).find(".class18").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.sourceId");
											$(this).find(".class19").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.skipType");
											$(this).find(".class20").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.customId");
											$(this).find(".class21").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.appId");
											$(this).find(".class22").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.originalId");
											$(this).find(".class23").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.targetUrlType");
											$(this).find(".class24").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.labelType");
											//$(this).find(".prizeSort").val(index1+1);
										})
									})
								}
							})
							
							
							
						}
//						                    var insert = $ ('.table-1 tr :checkbox:checked').closest ('tr');
//						                    if(insert.length==1){
//						                    	if(insert.index()==$('.table-1 tbody tr').length-1){
//						                    		layer.msg("已经到底了！", {
//						            					time : 5000,
//						            					icon : 2
//						            				});
//						                    	}
//						                    	var tr = insert.next ('tr');
//						                    	tr.after (insert);
//						                    	  $(tr.parent().find("tr")).each(function(index,dom){
//						    		            	  $(this).find(".prizeSort").val(index+1)
//						    		            	  //$(this).find(".sequenceSort").val(index+1)
//						    		              })
//						                    }else{
//						                    	 var insertIndex = $ ('.table-1 tr :checkbox:checked').eq(1).closest ('tr');
//						                    	 if(insertIndex.index()==$('.table-1 tbody tr').length-1){
//						                    		layer.msg("存在最后一个被选中！", {
//						            					time : 5000,
//						            					icon : 2
//						            				});
//						                    	}else{
//						                    		 var tr = insertIndex.next ('tr');
//						        		             for(var i=0;i<insert.length;i++){
//						        		              tr.after (insert);
//						        		             }
//						        		              $(tr.parent().find("tr")).each(function(index,dom){
//						        		            	  $(this).find(".prizeSort").val(index+1)
//						        		            	  //$(this).find(".sequenceSort").val(index+1)
//						        		              })
		//
//						                    	}
//						        	            
//						                    }
						                   
						                });
				 
					//删除定时器或者奖品
				
				 
				 
				 $(document).off('click','#deleteElement').on('click','#deleteElement',function(){
						var flag=$("#flag").val();
						layer.confirm('确定删除吗？',{
									btn : [ '确定', '取消' ],
									yes : function(index){
						if($("#tab-1").hasClass('active')){
							var length=$("#tab-1").find("input:checkbox[name='pManager']:checked").length;
							var colength=$("#tab-1").find("input:checkbox[name='collectionSet']:checked").length
							if(length<1&&colength<1){
								layer.msg("请选择删除项！", {
									time : 5000,
									icon : 2
								});
								return;
							}
							var array = new Array();
							if(colength>0){
								$("#tab-1").find("input:checkbox[name='collectionSet']:checked").each(function(index,dom){
										 var checkALL=$(this).parent().parent().find("tbody").find("input[type=checkbox]")
						        		    for(var i=0;i<checkALL.length;i++){
						        		        	checkALL[i].checked=true;
						        		    }
								})
								
								
							}
							$("#tab-1").find("input:checkbox[name='pManager']:checked").each(function(index,dom){
								var len= $(this).parent().parent().parent().find("tr:visible").length;
								if(len==1){
									$(this).parent().parent().parent().parent().remove();
									$($("#collectionDiv").find("table")).each(function(index,dom){
										var isweightorsort= $(this).find(".collectionClass").val();
										$(this).find(".sclass1").attr("name","mlist["+index+"].isWeightOrSort");
										$(this).find(".sclass2").attr("name","mlist["+index+"].unitSort");
										$(this).find(".sclass3").attr("name","mlist["+index+"].redKeep");
										$(this).find(".sclass4").attr("name","mlist["+index+"].swKeep");
										$(this).find(".sclass5").attr("name","mlist["+index+"].nextUnitWeight");
										$($("#tab-1").find("table:eq("+index+")").find("tbody").find("tr")).each(function(index1,dom){
											$(this).find(".class1").attr("name","mlist["+index+"].plist["+index1+"].prizeName");
											$(this).find(".class2").attr("name","mlist["+index+"].plist["+index1+"].sourceName");
											$(this).find(".class3").attr("name","mlist["+index+"].plist["+index1+"].prizeValue");
											$(this).find(".class4").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.id");
											$(this).find(".class5").attr("name","mlist["+index+"].plist["+index1+"].id");
											$(this).find(".class6").attr("name","mlist["+index+"].plist["+index1+"].isTrue");
											$(this).find(".class7").attr("name","mlist["+index+"].plist["+index1+"].prizeClassify.id");
											$(this).find(".class8").attr("name","mlist["+index+"].plist["+index1+"].isOneNum");
											$(this).find(".class9").attr("name","mlist["+index+"].plist["+index1+"].isSpecial");
											if(isweightorsort==1){
												$(this).find(".class10").attr("name","mlist["+index+"].plist["+index1+"].weight");
											}
											if(isweightorsort==2){
												$(this).find(".class10").attr("name","mlist["+index+"].plist["+index1+"].sort");
											}
											$(this).find(".class11").attr("name","mlist["+index+"].plist["+index1+"].logo8Url");
											$(this).find(".class12").attr("name","mlist["+index+"].plist["+index1+"].logo10Url");
											$(this).find(".class13").attr("name","mlist["+index+"].plist["+index1+"].skipUrl");
											if(isweightorsort==1){
												$(this).find(".class14").attr("name","mlist["+index+"].plist["+index1+"].moreWeight");
											}
											if(isweightorsort==2){
												$(this).find(".class14").attr("name","mlist["+index+"].plist["+index1+"].moreSort");
											}
											$(this).find(".class15").attr("name","mlist["+index+"].plist["+index1+"].prizeAmount");
											$(this).find(".class16").attr("name","mlist["+index+"].plist["+index1+"].sequenceId");
											$(this).find(".class17").attr("name","mlist["+index+"].plist["+index1+"].unitSort");
											$(this).find(".class18").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.sourceId");
											$(this).find(".class19").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.skipType");
											$(this).find(".class20").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.customId");
											$(this).find(".class21").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.appId");
											$(this).find(".class22").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.originalId");
											$(this).find(".class23").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.targetUrlType");
											$(this).find(".class24").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.labelType");
											//$(this).find(".prizeSort").val(index1+1);
										})
									})
								}else{
									var tableIndex=$("#tab-1").find("table").index($(this).parent().parent().parent().parent())
									$(this).parent().parent().remove();
									var isweightorsort=$("#tab-1").find("table:eq("+tableIndex+")").find(".collectionClass").val();
									//alert("没有完全删除的情况"+isweightorsort)
									$($("#tab-1").find("table:eq("+tableIndex+")").find("tbody").find("tr")).each(function(index,dom){
										$(this).find(".class1").attr("name","mlist["+tableIndex+"].plist["+index+"].prizeName");
										$(this).find(".class2").attr("name","mlist["+tableIndex+"].plist["+index+"].sourceName");
										$(this).find(".class3").attr("name","mlist["+tableIndex+"].plist["+index+"].prizeValue");
										$(this).find(".class4").attr("name","mlist["+tableIndex+"].plist["+index+"].prizeMaterial.id");
										$(this).find(".class5").attr("name","mlist["+tableIndex+"].plist["+index+"].id");
										$(this).find(".class6").attr("name","mlist["+tableIndex+"].plist["+index+"].isTrue");
										$(this).find(".class7").attr("name","mlist["+tableIndex+"].plist["+index+"].prizeClassify.id");
										$(this).find(".class8").attr("name","mlist["+tableIndex+"].plist["+index+"].isOneNum");
										$(this).find(".class9").attr("name","mlist["+tableIndex+"].plist["+index+"].isSpecial");
										if(isweightorsort==1){
											$(this).find(".class10").attr("name","mlist["+tableIndex+"].plist["+index+"].weight");
										}
										if(isweightorsort==2){
											$(this).find(".class10").attr("name","mlist["+tableIndex+"].plist["+index+"].sort");
										}
										$(this).find(".class11").attr("name","mlist["+tableIndex+"].plist["+index+"].logo8Url");
										$(this).find(".class12").attr("name","mlist["+tableIndex+"].plist["+index+"].logo10Url");
										$(this).find(".class13").attr("name","mlist["+tableIndex+"].plist["+index+"].skipUrl");
										if(isweightorsort==1){
											$(this).find(".class14").attr("name","mlist["+tableIndex+"].plist["+index+"].moreWeight");
										}
										if(isweightorsort==2){
											$(this).find(".class14").attr("name","mlist["+tableIndex+"].plist["+index+"].moreSort");
										}
										$(this).find(".class15").attr("name","mlist["+tableIndex+"].plist["+index+"].prizeAmount");
										$(this).find(".class16").attr("name","mlist["+tableIndex+"].plist["+index+"].sequenceId");
										$(this).find(".class17").attr("name","mlist["+tableIndex+"].plist["+index+"].unitSort");
										$(this).find(".class18").attr("name","mlist["+tableIndex+"].plist["+index+"].prizeMaterial.sourceId");
										$(this).find(".class19").attr("name","mlist["+tableIndex+"].plist["+index+"].prizeMaterial.skipType");
										$(this).find(".class20").attr("name","mlist["+tableIndex+"].plist["+index+"].prizeMaterial.customId");
										$(this).find(".class21").attr("name","mlist["+tableIndex+"].plist["+index+"].prizeMaterial.appId");
										$(this).find(".class22").attr("name","mlist["+tableIndex+"].plist["+index+"].prizeMaterial.originalId");
										$(this).find(".class23").attr("name","mlist["+tableIndex+"].plist["+index+"].prizeMaterial.targetUrlType");
										$(this).find(".class24").attr("name","mlist["+tableIndex+"].plist["+index+"].prizeMaterial.labelType");
										$(this).find(".prizeSort").val(index+1);
									})
									/*$($(this).parent().parent().parent().find("tr")).each(function(index,dom){
										alert("新");
										alert(index);
										$(this).find(".prizeSort").val(index+1)
										 $(this).find(".class1").attr("name","mlist[${"+tableIndex+"].plist["+index+"].prizeMaterial.prizeName");
										 
										 
						            	  //$(this).find(".sequenceSort").val(index+1)
						             })*/
						            
								}
								 if($(this).val()!="" && $(this).val()!=undefined && $(this).val()!=null){
									 array.push($(this).val())
								 }
							 });
							$("#tab-1").find("input:checkbox[name='collectionSet']:checked").each(function(){
								$(this).parent().parent().remove();
								$($("#collectionDiv").find("table")).each(function(index,dom){
									var isweightorsort= $(this).find(".collectionClass").val();
									$(this).find(".sclass1").attr("name","mlist["+index+"].isWeightOrSort");
									$(this).find(".sclass2").attr("name","mlist["+index+"].unitSort");
									$(this).find(".sclass3").attr("name","mlist["+index+"].redKeep");
									$(this).find(".sclass4").attr("name","mlist["+index+"].swKeep");
									$(this).find(".sclass5").attr("name","mlist["+index+"].nextUnitWeight");
									$($("#tab-1").find("table:eq("+index+")").find("tbody").find("tr")).each(function(index1,dom){
										$(this).find(".class1").attr("name","mlist["+index+"].plist["+index1+"].prizeName");
										$(this).find(".class2").attr("name","mlist["+index+"].plist["+index1+"].sourceName");
										$(this).find(".class3").attr("name","mlist["+index+"].plist["+index1+"].prizeValue");
										$(this).find(".class4").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.id");
										$(this).find(".class5").attr("name","mlist["+index+"].plist["+index1+"].id");
										$(this).find(".class6").attr("name","mlist["+index+"].plist["+index1+"].isTrue");
										$(this).find(".class7").attr("name","mlist["+index+"].plist["+index1+"].prizeClassify.id");
										$(this).find(".class8").attr("name","mlist["+index+"].plist["+index1+"].isOneNum");
										$(this).find(".class9").attr("name","mlist["+index+"].plist["+index1+"].isSpecial");
										if(isweightorsort==1){
											$(this).find(".class10").attr("name","mlist["+index+"].plist["+index1+"].weight");
										}
										if(isweightorsort==2){
											$(this).find(".class10").attr("name","mlist["+index+"].plist["+index1+"].sort");
										}
										$(this).find(".class11").attr("name","mlist["+index+"].plist["+index1+"].logo8Url");
										$(this).find(".class12").attr("name","mlist["+index+"].plist["+index1+"].logo10Url");
										$(this).find(".class13").attr("name","mlist["+index+"].plist["+index1+"].skipUrl");
										if(isweightorsort==1){
											$(this).find(".class14").attr("name","mlist["+index+"].plist["+index1+"].moreWeight");
										}
										if(isweightorsort==2){
											$(this).find(".class14").attr("name","mlist["+index+"].plist["+index1+"].moreSort");
										}
										$(this).find(".class15").attr("name","mlist["+index+"].plist["+index1+"].prizeAmount");
										$(this).find(".class16").attr("name","mlist["+index+"].plist["+index1+"].sequenceId");
										$(this).find(".class17").attr("name","mlist["+index+"].plist["+index1+"].unitSort");
										$(this).find(".class18").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.sourceId");
										$(this).find(".class19").attr("name","mlist["+index+"].plist["+index+"].prizeMaterial.skipType");
										$(this).find(".class20").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.customId");
										$(this).find(".class21").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.appId");
										$(this).find(".class22").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.originalId");
										$(this).find(".class23").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.targetUrlType");
										$(this).find(".class24").attr("name","mlist["+index+"].plist["+index1+"].prizeMaterial.labelType");
										
										//$(this).find(".prizeSort").val(index1+1);
									})
								})
							})
							if(array.length==0){
								layer.msg("删除成功", {
									time : 5000,
									icon : 1
								});
								return;
							}
							 //alert(JSON.stringify(array))
							 var url=rootPath+"/user/newPrizestrategy/deletePrizeManagerForTransition.shtml";
							 $.ajax({ 
									type : "POST",
									url : url,
									data : {'ids':JSON.stringify(array)},
									dataType : "json",
									success : function(data) {
										if(data.status==200 && data.data!=null){
											layer.msg("删除成功", {
												time : 5000,
												icon : 1
											});
										}else{
											layer.msg(data.msg, {
												time : 5000,
												icon : 2
											});
										}
									
									}
								
								})
						}
						else if($("#tab-2").hasClass('active')){
							var length=$("#tab-2").find("input:checkbox[name='job']:checked").length;
							if(length<1){
								layer.msg("请选择删除项！", {
									time : 5000,
									icon : 2
								});
								return;
							}
							var array = new Array();
							 $("#tab-2").find("input:checkbox[name='job']:checked").each(function(){
								 $(this).attr('checked',false);
								 $(this).parent().parent().remove();
								 if($(this).val()!=""&&$(this).val()!=undefined&&$(this).val()!=null){
									 array.push($(this).val())
								 }
							 })
							 if(array.length==0){
								 layer.msg("删除成功", {
										time : 5000,
										icon : 1
									});
								 return;
							 }
							 //alert(JSON.stringify(array))
							 var url=rootPath+"/user/newPrizestrategy/deleteCrontableJob.shtml";
							 $.ajax({ 
									type : "POST",
									url : url,
									data : {'ids':JSON.stringify(array)},
									dataType : "json",
									success : function(data) {
										if(data.status==200 && data.data!=null){
											layer.msg("删除成功", {
												time : 5000,
												icon : 1
											});
										}else{
											layer.msg(data.msg, {
												time : 5000,
												icon : 2
											});
										}
									
									}
								
								})
							
						}
						else if($("#tab-3").hasClass('active')){
							var length=$("#tab-3").find("input:checkbox[name='job']:checked").length;
							if(length<1){
								layer.msg("请选择删除项！", {
									time : 5000,
									icon : 2
								});
								return;
							}
							var array = new Array();
							 $("#tab-3").find("input:checkbox[name='job']:checked").each(function(){
								 $(this).parent().parent().remove();
								 if($(this).val()!=""&&$(this).val()!=undefined&&$(this).val()!=null){
									 array.push($(this).val())
								 }
							 })
							 if(array.length==0){
								 layer.msg("删除成功", {
										time : 5000,
										icon : 1
									});
								 return;
							 }
							 //alert(JSON.stringify(array))
							 var url=rootPath+"/user/newPrizestrategy/deleteCrontableJob.shtml";
							 $.ajax({ 
									type : "POST",
									url : url,
									data : {'ids':JSON.stringify(array)},
									dataType : "json",
									success : function(data) {
										if(data.status==200 && data.data!=null){
											layer.msg("删除成功", {
												time : 5000,
												icon : 1
											});
										}else{
											layer.msg(data.msg, {
												time : 5000,
												icon : 2
											});
										}
									
									}
								
								})
							
						}
						else{
							layer.msg("页面不存在可删除内容", {
								time : 5000,
								icon : 6
							});
							return;
						}
									}
						// 按钮
						}, function() {
										return;
									});
					})
				
						//保存位置以及logo图
	$(".using").click(function(){
		var id=$("#strategyPrizeId").val();
		if(id==""||id==undefined||id==null){
			layer.msg("请先保存该条策略", {
				time : 5000,
				icon : 6
			});
			return;
		}
		var flag= $(this).attr("flag");
		if(flag=="false"){
			layer.msg("请勿重复操作", {
				time : 5000,
				icon : 2
			});
			return;
		}
		$(this).attr("flag","false");
		var param=platform.getFormJson("#tab-4")
		param.strategyid=id;
		//alert(JSON.stringify(param))
		var url=rootPath+"/user/newPrizestrategy/saveorUpdatePosition.shtml";
		$.ajax({
						    type : "POST",
							url : url,
							data :param,
							cache: false, //关闭AJAX缓存
							dataType : "json",
							success : function(data) {
								if(data.status==200){
									$(".using").attr("flag","true");
									 layer.msg('应用成功', {icon: 1})
								}else{
									 layer.msg(data.msg, {icon: 2})
								}
								}
							})
		
	})
	
			/**
		 * 上传logo
		 */
	$(document).off("click",".clearPic").on('click','.clearPic',function(){
		$(this).parent().find("input").val("");
		var initPic=imgServer+"/2018/03/05/635c1ab8a11c4a43ac80b04e8c023077/205295561556513937.jpg";
		$(this).parent().find("img").attr("src",initPic);
	})
		/**
		 * 上传logo
		 */
	$(document).off("click",".uploadUrl").on('change','.uploadUrl',function(){
							var index= $(this).parent().parent().parent().index();
							if(index==0){
								return;
							}
							
							var id="#inputImage"+index;
							platform.myAjaxFileUpload(rootPath
									+ "/user/upload/picture.shtml", id,
									"", function(data){
								if(data.status==200){
									var keyUrl=data.data.keyUrl
									var host=data.data.host;
									$(id).parent().prev().val(keyUrl);
									$(id).parent().parent().find('img').attr('src',imgServer+keyUrl);
									platform.alertmsg("上传成功");
								}else{
									platform.alertmsg("上传失败");
								}
							},
									platform.fileUpload.uploadBackE);
						})
								   /**
		    * 新增或者修改位置奖品
		    */
			$(document).on('click','#savePosition',function(){
				var str="<tr><td ><span ></span>固定位置</td>";
				    str+="<td ><span ></span>展示Logo</td>";
				    str+="<td ><span ></span>递减权重</td>";
				    str+="<td ><span ></span>单次奖</td>";
				    str+="<td><span ></span>多次奖</td></tr>"; 
					var url= rootPath+"/user/newPrizestrategy/positionAmountForTransition.shtml";
					var id=$("#strategyPrizeId").val();
					if(id==""||id==undefined||id==null){
						layer.msg("请先保存策略", {
							time : 5000,
							icon : 6
						});
					}
					 $.ajax({
						    type : "POST",
							url : url,
							data :{'id':id},
							dataType : "json",
							success : function(data) {
								var hasPosition= data.positionList.length;
								var allAmount=data.positionAmuont;
								if(data.positionList!=null&&data.positionList!=""){
									$(data.positionList).each(function(index,dom){
										str+="<tr><td><input value='"+dom['position']+"' type=hidden name='mlist["+index+"].position'><input value='"+dom['id']+"' type=hidden name='mlist["+index+"].id'>位置"+dom['position']+"</td>";
										if(dom['logoUrl']!=null&&dom['logoUrl']!=""){
											str+="<td><img style='width: 50px; height: 50px; border-radius: 50%;margin:10px auto;display:block;' src='"+imgServer+dom['logoUrl']+"' alt='' /><input type='hidden' value='"+dom['logoUrl']+"' name='mlist["+index+"].logoUrl'><label title='上传Logo' for='inputImage' class='btn btn-primary' style='position:relative'>"
										}else{
											str+="<td><img style='width: 50px; height: 50px; border-radius: 50%;margin:10px auto;display:block;' src='"+imgServer+"/2018/03/05/635c1ab8a11c4a43ac80b04e8c023077/205295561556513937.jpg' alt='' /><input type='hidden' value='' name='mlist["+index+"].logoUrl'><label title='上传Logo' for='inputImage' class='btn btn-primary' style='position:relative'>"
										}
										str+="<input type='file' accept='image/*' name='file' id='inputImage"+(index+1)+"' class='uploadUrl' style='opacity:0;position:absolute;top:0;width:88px;'>上传Logo</label><button type='button' style='margin-left:20px;height:25px; width:50px; border:none; border-radius:4px;' class='btn-danger clearPic'>清空</button></td>"
										str+="<td><span><input class=' class12 setWidth' value='"+dom['reduceStrategy']+"' name='mlist["+index+"].reduceStrategy' type='number' min='0' ></span>%</td>"	
		                                if(dom['oneNum']==1){
		                                	str+="<td><input type='checkbox' value='1' name='mlist["+index+"].oneNum' checked='checked' /></td>";
		                                }else{
		                                	str+="<td><input type='checkbox' value='1' name='mlist["+index+"].oneNum' /></td>";
		                                }
										if(dom['twoNum']==1){
											str+="<td><input type='checkbox' checked='checked' value='1' name='mlist["+index+"].twoNum' /></td></tr>";
										}else{
											str+="<td><input type='checkbox' value='1' name='mlist["+index+"].twoNum' /></td></tr>";
										}
									})
								}
//								for (var a = 0; a <(allAmount-hasPosition); a++) {
//									str+="<tr><td><input value='"+(hasPosition+a+1)+"' type=hidden name='mlist["+(hasPosition+a)+"].position'>位置"+(hasPosition+a+1)+"</td>";
//									str+="<td><img style='width: 50px; height: 50px;margin:10px auto;display:block; border-radius: 50%;position:relative' src='"+imgServer+"/2018/03/05/635c1ab8a11c4a43ac80b04e8c023077/205295561556513937.jpg' alt=''/><input type='hidden' name='mlist["+(hasPosition+a)+"].logoUrl'><label title='上传Logo' for='inputImage' class='btn btn-primary' style='position:relative'>"
//									str+="<input type='file' accept='image/*' name='file' id='inputImage"+(hasPosition+a+1)+"' class='uploadUrl' style='opacity:0;position:absolute;top:0;width:88px;'> 上传Logo</label><button type='button' style='margin-left:20px; height: 25px; width:50px; border:none; border-radius:4px;' class='btn-danger clearPic'>清空</button></td>"
//									str+="<td><span><input class=' class12 setWidth' value='0' name='mlist["+(hasPosition+a)+"].reduceStrategy' type='number' min='0' ></span>%</td>"	
//	                                str+="<td><input type='checkbox' value='1' name='mlist["+(hasPosition+a)+"].oneNum' /></td>";
//									str+="<td><input type='checkbox' value='1' name='mlist["+(hasPosition+a)+"].twoNum' /></td></tr>";
//								}
								$(".moveUp").hide();
								$(".moveDown").hide();
								$("#deleteElement").hide();
								$("#tab-4").find("tbody").html(str);
								$("#tab-4").addClass("active").siblings().removeClass("active")
							}
					 })
				})
				
							 /**
			  * 整体策略
			  */
				$(document).on('click','#strategyAll',function(){
					$("#tab-1").addClass("active").siblings().removeClass("active")
					$(".moveUp").show();
					$(".moveDown").show();
					$("#deleteElement").show();
				})
				
				/**
				 * 重置修改权重
				 */
				$(document).on('click','#resetStrategy',function(){
				//$("#resetPrize").click(function (){
					var url= rootPath+"/user/newPrizestrategy/CrontaleJobWeight.shtml"
					var id=$("#strategyPrizeId").val();
					if(id==""||id==undefined||id==null){
						layer.msg("请先保存策略", {
							time : 5000,
							icon : 6
						});
						return;
					}
					param={'id':id};
					$.ajax({
						type : "POST",
						url : url,
						data : param,
						dataType : "json",
						success : function(data) {
							var str="";
							str+="<tr ><td ></td>"
								str+="<td ><span ></span>奖品名称</td>"
									str+="<td ><span ></span>集合类型</td>"
										str+="<td ><span ></span>起始时间</td>"
											str+="<td ><span ></span>结束时间</td>"
												str+="<td ><span ></span>生效时间</td>"
													str+="<td ><span ></span>失效时间</td>"
													str+="<td ><span ></span>生效策略</td>"
														str+="<td ><span></span>重置频率</td>"
															str+="<td ><span ></span>操作</td>"
																str+="</tr>"
							$(data).each(function(index,dom){
								
								//如果是1的话就是奖品数量重置   2.权重重置
								str+="<tr>";
								str+="<td><input type='checkbox' value='"+dom['id']+"' name='job' class='i-checks' /></td>";
								str+="<td >";
								str+=dom['prize_name']+"<input type='hidden' class='class4' name='prizeName' value='"+dom['prize_name']+"'>"+"<input type='hidden' name='resetType' value='"+dom['reset_type']+"'>"
								str+="</td>"
								str+="<td>"
								if(dom['isWeightOrSort']==1){
									str+="权重</td>"
								}
								else if(dom['isWeightOrSort']==2){
									str+="顺序</td>"
								}
					            str+="<td  class='setTime'>"
					            str+="<div class='input-group' >"
					            str+="<input placeholder='开始日期' name='startTime' value="+dom['startTime']+" class='timeValue form-control timeWidth layer-date start'  disabled='true'></div></td>"
								str+="<td  class='setTime'><div class='input-group' ><input value="+dom['endTime']+" placeholder='结束日期' name='endTime'  class='form-control timeWidth layer-date end'  disabled='true'></div></td>"	
								str+="<td class='setTime'><div class='input-group'  ><input value="+dom['time']+" name='time' class='class11 timeWidth form-control' disabled='true'></div></td>"
								str+="<td class='setTime'><div class='input-group'  ><input value="+dom['recoverTime']+" name='recoverTime' class='class11 timeWidth form-control' disabled='true'></div></td>"
								str+="<td><div class='input-group'  id='iconT'><input class='class12 setWidth' value='"+dom['strategyWeight']+"' name='strategyWeight' type='number' min='0' disabled='true'></div></td>"
								str+="<td><select id='isTrue' name='cronType' type='text' class='form-control select2 class6 setWidth' disabled='true'>"
								if(dom['cron_type']==1){
									str+="<option value='1' selected='selected'>每天</option>";
								}else{
									str+="<option value='1' >每天</option>";
								}
								if(dom['cron_type']==2){
									str+="<option value='2' selected='selected'>每周一</option>";
								}else{
									str+="<option value='2'>每周一</option>";
								}
								if(dom['cron_type']==3){
									str+="<option value='3' selected='selected'>每个月一号</option>";
								}else{
									str+="<option value='3'>每个月一号</option>";
								}
								if(dom['cron_type']==4){
									str+="<option value='4' selected='selected'>每周一到周五</option>";
								}else{
									str+="<option value='4'>每周一到周五</option>";
								}
								if(dom['cron_type']==5){
									str+="<option value='5' selected='selected'>每周六，周日</option>"
								}else{
									str+="<option value='5'>每周六，周日</option>"
								}
								str+="	</select></td>";
								str+="<td><input type='hidden' name='id' value='"+dom['id']+"'><span class='setChange'>修改</span></td> </tr>";
								
								
							})
							$(".moveUp").hide();
							$(".moveDown").hide();
							$("#deleteElement").show();
							$("#tab-3").find("tbody").html(str);
							$("#tab-3").addClass("active").siblings().removeClass("active")
							laydate({
					               elem: '#tab .layerCO', //目标元素。由于laydate.js封装了一个轻量级的选择器引擎，因此elem还允许你传入class、tag但必须按照这种方式 '#id .class'
								   istime: true,
								   format: 'YYYY/MM/DD',
								   istoday: false,
//					             event: 'focus' //响应事件。如果没有传入event，则按照默认的click
					           });
//					      laydate({
//					             elem: '#layerTips .layerCO', //目标元素。由于laydate.js封装了一个轻量级的选择器引擎，因此elem还允许你传入class、tag但必须按照这种方式 '#id .class'
//								   istime: true,
//								   format: 'YYYY/MM/DD hh:mm:ss',
//								   istoday: false,
////					             event: 'focus' //响应事件。如果没有传入event，则按照默认的click
//					         }); 
					       
					        var start = {
					            elem: '#tab .start',
					            format: 'YYYY/MM/DD',
					            max: '2099-06-16 23:59:59', //最大日期
					            istime: true,
					            istoday: false,
					            choose: function (datas) {
					            	
					                end.min = datas; //开始日选好后，重置结束日的最小日期
					                end.start = datas //将结束日的初始值设定为开始日
					            }
					            
					        };
					        var end = {
					            elem: '#tab .end',
					            format: 'YYYY/MM/DD',
					            min: laydate.now(),
					            max: '2099-06-16 23:59:59',
					            istime: true,
					            istoday: false,
					            choose: function (datas) {
					                start.max = datas; //结束日选好后，重置开始日的最大日期
					            }
					        };
					        laydate(start);
					        laydate(end);
						} 
				})
					
				})			
				
				/**
				 * 重置修改数量
				 */
				$(document).on('click','#resetPrize',function(){
				//$("#resetPrize").click(function (){
					var id=$("#strategyPrizeId").val();
					if(id==""||id==undefined||id==null){
						layer.msg("请先保存策略", {
							time : 5000,
							icon : 6
						});
						return;
					}
					var url= rootPath+"/user/newPrizestrategy/CrontaleJobPrize.shtml"
					param={'id':id};
					$.ajax({
						type : "POST",
						url : url,
						data : param,
						dataType : "json",
						success : function(data) {
							var str="";
							str+="<tr ><td ></td>"
								str+="<td ><span ></span>奖品名称</td>"
									str+="<td ><span ></span>奖品分类</td>"
										str+="<td ><span ></span>起始时间</td>"
											str+="<td ><span ></span>结束时间</td>"
												str+="<td ><span ></span>重置时间</td>"
													str+="<td ><span ></span>重置数量</td>"
														str+="<td ><span></span>重置频率</td>"
															str+="<td ><span ></span>操作</td>"
																str+="</tr>"
							$(data).each(function(index,dom){
								
								//如果是1的话就是奖品数量重置   2.权重重置
								str+="<tr>";
								str+="<td><input type='checkbox' value='"+dom['id']+"' name='job' class='i-checks' /></td>";
								str+="<td >";
								str+=dom['prize_name']+"<input type='hidden' class='class4' name='prizeName' value='"+dom['prize_name']+"'>"+"<input type='hidden' name='resetType' value='"+dom['reset_type']+"'>"
								str+="</td>"
								str+="<td>"
								str+=dom['className']+"</td>"
					            str+="<td  class='setTime'>"
					            str+="<div class='input-group' >"
					            str+="<input placeholder='开始日期' name='startTime' value="+dom['startTime']+" class='timeValue form-control timeWidth layer-date start'  disabled='true'></div></td>"
								str+="<td  class='setTime'><div class='input-group' ><input value="+dom['endTime']+" placeholder='结束日期' name='endTime'  class='form-control timeWidth layer-date end'  disabled='true'></div></td>"	
								str+="<td class='setTime'><div class='input-group'  ><input name='time' value="+dom['time']+" class='class11 timeWidth form-control' disabled='true'></div></td>"
								str+="<td><div class='input-group'  id='iconT'><input class='class12 setWidth' value='"+dom['amount']+"' name='amount' type='number' min='0' disabled='true'></div></td>"
								str+="<td><select id='isTrue' name='cronType' type='text' class='form-control select2 class6 setWidth' disabled='true'>"
								if(dom['cron_type']==1){
									str+="<option value='1' selected='selected'>每天</option>";
								}else{
									str+="<option value='1' >每天</option>";
								}
								if(dom['cron_type']==2){
									str+="<option value='2' selected='selected'>每周一</option>";
								}else{
									str+="<option value='2'>每周一</option>";
								}
								if(dom['cron_type']==3){
									str+="<option value='3' selected='selected'>每个月一号</option>";
								}else{
									str+="<option value='3'>每个月一号</option>";
								}
								if(dom['cron_type']==4){
									str+="<option value='4' selected='selected'>每周一到周五</option>";
								}else{
									str+="<option value='4'>每周一到周五</option>";
								}
								if(dom['cron_type']==5){
									str+="<option value='5' selected='selected'>每周六，周日</option>"
								}else{
									str+="<option value='5'>每周六，周日</option>"
								}
								str+="	</select></td>";
								str+="<td><input type='hidden' name='id' value='"+dom['id']+"'><span class='setChange'>修改</span></td> </tr>";
								
								
							})
							$(".moveUp").hide();
							$(".moveDown").hide();
							$("#deleteElement").show();
							$("#tab-2").find("tbody").html(str);
							$("#tab-2").addClass("active").siblings().removeClass("active")
							$("#resetPrize").attr('href','#tab-2');
							laydate({
					               elem: '#tab .layerCO', //目标元素。由于laydate.js封装了一个轻量级的选择器引擎，因此elem还允许你传入class、tag但必须按照这种方式 '#id .class'
								   istime: true,
								   format: 'YYYY/MM/DD',
								   istoday: false,
//					             event: 'focus' //响应事件。如果没有传入event，则按照默认的click
					           });
//					      laydate({
//					             elem: '#layerTips .layerCO', //目标元素。由于laydate.js封装了一个轻量级的选择器引擎，因此elem还允许你传入class、tag但必须按照这种方式 '#id .class'
//								   istime: true,
//								   format: 'YYYY/MM/DD hh:mm:ss',
//								   istoday: false,
////					             event: 'focus' //响应事件。如果没有传入event，则按照默认的click
//					         }); 
					       
					        var start = {
					            elem: '#tab .start',
					            format: 'YYYY/MM/DD',
					            max: '2099-06-16', //最大日期
					            istime: true,
					            istoday: false,
					            choose: function (datas) {
					            	
					                end.min = datas; //开始日选好后，重置结束日的最小日期
					                end.start = datas //将结束日的初始值设定为开始日
					            }
					            
					        };
					        var end = {
					            elem: '#tab .end',
					            format: 'YYYY/MM/DD',
					            min: laydate.now(),
					            max: '2099-06-16',
					            istime: true,
					            istoday: false,
					            choose: function (datas) {
					                start.max = datas; //结束日选好后，重置开始日的最大日期
					            }
					        };
					        laydate(start);
					        laydate(end);
						} 
				})
					
				})
								$("#theSumbitCloseTransiton").unbind("click").click(function(){
						var flag=$(this).attr("flag");
						if(flag=="false"){
							layer.msg("请勿重复点击····", {
								time : 5000,
								icon : 6
							});
							return;
						}
						var strategyName= $(".strategyName").val();
						if(strategyName==null||strategyName==""||strategyName==undefined){
							layer.msg("请先填写策略名称", {
								time : 5000,
								icon : 6
							});
							return;
						}
						var strategySex1= $(".strategySex1").attr("checked");
						var strategySex2=$(".strategySex2").attr("checked");
						if(!strategySex1&&!strategySex2){
							layer.msg("请勾选策略特性", {
								time : 5000,
								icon : 6
							});
							return;
						}
						var regPos =/^\d+$/;
						if(strategySex1){
							var oneNumPrize= $(".oneNumPrize").val();
							var oneCodeFirstNum=$(".oneCodeFirstNum").val();
							var todayNum=$(".todayNum").val();
							if(!regPos.test(oneNumPrize)||!regPos.test(oneCodeFirstNum)||!regPos.test(todayNum)){
								layer.msg("请先填写正确配置信息", {
									time : 5000,
									icon : 6
								});
								return;
							}
						}
						if(strategySex2){
							var numWithOutScan= $(".numWithOutScan").val();
							var withOutScanTotal=$(".withOutScanTotal").val();
							if(!regPos.test(numWithOutScan)||!regPos.test(withOutScanTotal)){
								layer.msg("请先填写正确配置信息", {
									time : 5000,
									icon : 6
								});
								return;
							}
						}
						$(this).attr("flag","false");
					// 获取表单提交的参数
					var param = platform
							.getFormJson("#prizeStrategyForm");
					//alert(JSON.stringify(param));
				/*	var length = $(
							"#prizeMaterialTableAdd tbody")
							.find("tr").length;*/
					/*if (length != 9 && length != 11) {
						layer.msg("奖品只能上传8个或10个");
						return;
					} else {*/
						var flag = $("#flag").val();
						if (flag == "add" || flag == "") {
							// 说明是新增
							/*platform.doPost(rootPath
									+ "/user/newPrizestrategy/saveClose.shtml", param);*/
							platform.apply
							.request(
									rootPath
											+ "/user/newPrizestrategy/saveCloseForTransition.shtml",
									this, param)
						} else if (flag == "edit") {
							// 说明是更新
							/*platform.doPost(rootPath
									+ "/user/newPrizestrategy/updateClose.shtml", param);*/
							platform.apply
							.request(
									rootPath
											+ "/user/newPrizestrategy/updateCloseForTransition.shtml",
									this, param)
						}
							
							/*
							// 说明是更新
							platform.apply
									.request(
											rootPath
													+ "/user/newPrizestrategy/update.shtml",
											this, param);
						}
*/
					/*}*/
				
					
					
				})
				
				$("#theSubmitButtonByTransition")
				.unbind("click").click(
						function() {
							var flag=$(this).attr("flag");
							if(flag=="false"){
								layer.msg("请勿重复点击····", {
									time : 5000,
									icon : 6
								});
								return;
							}
							var strategyName= $(".strategyName").val();
							if(strategyName==null||strategyName==""||strategyName==undefined){
								layer.msg("请先填写策略名称", {
									time : 5000,
									icon : 6
								});
								return;
							}
							var strategySex1= $(".strategySex1").attr("checked");
							var strategySex2=$(".strategySex2").attr("checked");
							if(!strategySex1&&!strategySex2){
								layer.msg("请勾选策略特性", {
									time : 5000,
									icon : 6
								});
								return;
							}
							var regPos =/^\d+$/;
							if(strategySex1){
								var oneNumPrize= $(".oneNumPrize").val();
								var oneCodeFirstNum=$(".oneCodeFirstNum").val();
								var todayNum=$(".todayNum").val();
								if(!regPos.test(oneNumPrize)||!regPos.test(oneCodeFirstNum)||!regPos.test(todayNum)){
									layer.msg("请先填写正确配置信息", {
										time : 5000,
										icon : 6
									});
									return;
								}
							}
							if(strategySex2){
								var numWithOutScan= $(".numWithOutScan").val();
								var withOutScanTotal=$(".withOutScanTotal").val();
								if(!regPos.test(numWithOutScan)||!regPos.test(withOutScanTotal)){
									layer.msg("请先填写正确配置信息", {
										time : 5000,
										icon : 6
									});
									return;
								}
							}
							$(this).attr("flag","false");
							// 获取表单提交的参数
							var param = platform
									.getFormJson("#prizeStrategyForm");
							
							console.log(param)
							
							
							//alert(JSON.stringify(param));
						/*	var length = $(
									"#prizeMaterialTableAdd tbody")
									.find("tr").length;*/
							/*if (length != 9 && length != 11) {
								layer.msg("奖品只能上传8个或10个");
								return;
							} else {*/
						
								var flag = $("#flag").val();
								if (flag == "add" || flag == "") {
									// 说明是新增
									var url=rootPath+ "/user/newPrizestrategy/saveForTransition.shtml";
									$.ajax({
										type : "POST",
										url : url,
										data : param,
										dataType : "json",
										success : function(data) {
											if(data.status==200){
												$("#theSubmitButton").attr("flag","true");
												layer.alert(data.msg, {
													time : 0,
													btn : [ '确定' ],  
													yes : function(index) {
														var url=rootPath+"/user/prizestrategy/toEditStranegyApplyForTransition.shtml?id="+ data.data.id;
														var content=$("#openDiv").html();
														if(content==""||content==null||content==undefined){
															platform
															.doGet(rootPath
																	+ "/user/newPrizestrategy/toEditStranegyForTransition.shtml?id="
																	+ data.data.id);
														}else{
															platform.inLoad(url, "#openDiv");
														}
														layer.close(index);
													}
												})
											}
											else if(data.status==201){
												$("#theSubmitButton").attr("flag","true");
												layer.msg(data.msg, {
													time : 5000,
													icon : 6
												});
											}
											else {
												layer.msg(data.msg, {
													time : 5000,
													icon : 6
												});
											}
											
										}
									});
								} else if (flag == "edit") {
									function getRequest() {
										var url = window.location.search; //获取url中"?"符后的字串
										var theRequest = new Object();
										if (url.indexOf("?") != -1) {
											var str = url.substr(1);
											strs = str.split("&");
											for(var i = 0; i < strs.length; i ++) {
												theRequest[strs[i].split("=")[0]]=decodeURI(strs[i].split("=")[1]);
											}
										}
										return theRequest;
									}
									function countDown(time) {
										var s = 0;
										var hour = time.split(':')[0];
										var min = time.split(':')[1];
										var sec = time.split(':')[2];
										s = Number(hour * 3600) + Number(min * 60) + Number(sec);
										timedifference = s;
										if(timedifference>0){
											timeInterval()
										}
										// return s;
									};

									function formatDuring(value) {
										var theTime = parseInt(value);// 秒
										var middle= 0;// 分
										var hour= 0;// 小时

										if(theTime > 60) {
											middle= parseInt(theTime/60);
											theTime = parseInt(theTime%60);
											if(middle> 60) {
												hour= parseInt(middle/60);
												middle= parseInt(middle%60);
											}
										}
										var result
										if(theTime >= 10) {
											result = ""+theTime;
										}else if(theTime < 1) {
											result = "00";
										}else if(theTime < 10&&theTime > 0){
											result = "0"+theTime;

										}
										if(middle >= 10) {
											result = ""+middle+":"+result;
										}else if(middle < 1) {
											result = "00:"+result;
										}else if(middle < 10&&middle > 0){
											result = "0"+middle+":"+result;
										}
										if(hour >= 10) {
											result = ""+hour+":"+result;
										}else if(hour < 1) {
											result = "00:"+result;
										}else if(hour < 10&&hour > 0){
											result = "0"+hour+":"+result;
										}
										return result;
									}

									function timeInterval(){
										var timer = setInterval(function(){
											timedifference--;
											if(timedifference<1){
												clearInterval(timer);
												$('#alertsurplusTime').text("00:00:00");
											}else{
												$('#alertsurplusTime').text(formatDuring(timedifference));
											}
										},1000)
									}
									function timeEnd(){
										layer.alert("<p>当前策略可能受到重置功能影响</p><p>请重新打开策略操作</p>", {
											time : 0,
											btn : [ '确认' ],
											yes : function(index) {
												location.reload();
											}
										})
									}
									param.id= $('#strategyPrizeId').val();
									param.timeStr= timeStr
									// 说明是修改
									var url=rootPath+ "/user/newPrizestrategy/updateForTransition.shtml"
									$.ajax({
										type : "POST",
										url : url,
										data : param,
										dataType : "json",
										success : function(data) {
											if(data.status==200){
												$("#theSubmitButton").attr("flag","true");
												layer.alert(data.msg, {
													time : 0,
													btn : [ '确定' ],  
													yes : function(index) {
														var url=rootPath+"/user/prizestrategy/toEditStranegyApplyForTransition.shtml?id="+ data.data.id;
														var content=$("#openDiv").html();
														if(content==""||content==null||content==undefined){
															platform
															.doGet(rootPath
																	+ "/user/newPrizestrategy/toEditStranegyForTransition.shtml?id="
																	+ data.data.id);
														}else{
															platform.inLoad(url, "#openDiv");
														}
														layer.close(index);
													}
												})
											}else if(data.status==210){
												countDown(data.data)
												// countDown("00:00:03")
												var alertHtml = "<p>当前策略处于重置功能执行时间</p><p>请于<span id='alertsurplusTime'></span>后</p><p>重新打开策略操作</p>"
												layer.alert(alertHtml, {
													time : 0,
													btn : [ '确认' ],
													yes : function(index) {
														layer.close(index);
													}
												})
											}else if(data.status==220){
												timeEnd()
											}else{
												layer.msg(data.msg, {
													time : 5000,
													icon : 6
												});
											}
											
										}
									});
								}
									
									/*
									// 说明是更新
									platform.apply
											.request(
													rootPath
															+ "/user/newPrizestrategy/update.shtml",
													this, param);
								}
*/
							/*}*/
						})

	//--------------------------------------------------------------------------------------------			
				//奖品策略提交按钮
				$("#theSubmitButton")
						.click(
								function() {
									// 获取表单提交的参数
									var param = platform
											.getFormJson("#prizeStrategyForm");
									console.info(param)

									//----获取奖品个数 2018年07月21日15:02:46
									var length = $("#prizeMaterialTableAdd tbody").find("tr").length;
									var sequenceIdArray=new Array()
									if(length-1>=8){
										for(var i =0;i<length-1;i++){
											var sequenceId = param['mlist['+i+'].sequenceId']
											sequenceIdArray[i]=sequenceId
											if(sequenceId>8){
												layer.msg("请检查您的排序序号，出现了"+sequenceId);
												return;
											}
										}
										Array.prototype.unique3 = function(){
											 var res = [];
											 var json = {};
											 for(var i = 0; i < this.length; i++){
											  if(!json[this[i]]){
											   res.push(this[i]);
											   json[this[i]] = 1;
											  }
											 }
											 return res;
											}									    
										if((sequenceIdArray.unique3().sort()+"").indexOf("1,2,3,4,5,6,7,8")==-1){
											layer.msg("请检查您的排序序号，排序后是"+sequenceIdArray.unique3().sort());
											return;
										}
									}
									/*if (length != 9 && length != 11) {
										layer.msg("奖品只能上传8个或10个");
										return;
									} else {*/
									//----获取奖品个数 2018年07月21日15:02:46
										var flag = $("#flag").val();
										if (flag == "" || flag == null) {
											// 说明是新增
											platform.apply
													.request(
															rootPath
																	+ "/user/prizestrategy/savePrizeStrategy.shtml",
															this, param);
										} else if (flag == "edit") {
											// 说明是更新
											platform.apply
													.request(
															rootPath
																	+ "/user/prizestrategy/editPrizeStrategy.shtml",
															this, param);
										}

									/*}*/
								})
			}
		},
		projectCode : {
			uploadBack : function(data, status) {
				if (!platform.isNull(data.msg)) {
					platform.alertmsg(data.msg);
				}
				if (!platform.isNull(data.data)) {
					$("#codeFile").val(data.data.keyUrl);
				}
			},

			/**
			 * 上传码文件
			 */
			upload : function() {
				$("#codeTxtFile").on(
						"change",
						function() {
							platform.myAjaxFileUpload(rootPath
									+ "/user/upload/txt.shtml", "#codeTxtFile",
									{
										codeurl : $("#codeFile").val()
									}, platform.projectCode.uploadBack,
									platform.fileUpload.uploadBackE);
						})
			},

			add : function() {
				$("#projectCodeUploadButton")
						.click(
								function() {
									$("#projectCodeUploadButton").prop(
											'disabled', 'disabled');
									var param = platform
											.getFormJson("#projectCodeForm");
									var url = rootPath
											+ "/user/projectcodeinfo/saveCodeInfo.shtml";
									$
											.post(
													url,
													param,
													function(data) {
														layer
																.alert(
																		data['msg'],
																		{
																			/*
																			 * offset : [
																			 * '50%',
																			 * '40%' ],
																			 */
																			time : 0 // 不自动关闭
																			,
																			btn : [ '确定' ],
																			yes : function(
																					index) {
																				layer
																						.close(index);
																				$(
																						"#projectCodeUploadButton")
																						.removeAttr(
																								'disabled');
																			}
																		})
													}, 'json');
								})
			},
		},

		projectType : {
			//查询所有的可用渠道
			findAllOrgan:function(){
				var url=rootPath+"/user/type/findAllOrgan.shtml";
				var checkedOrgan=$("#checkedOrgan").val();
				$.post(url,{},function(data){
					$(data).each(function(index,dom){
						var str="";
						if(dom['code']==checkedOrgan){
							str="<option value='"+dom['code']+"' selected >--"+dom['name']+"--</option>"
						}else{
							str="<option value='"+dom['code']+"' >--"+dom['name']+"--</option>"
						}
							
						$("#organ").append(str);
					})
					
				},'json');
				
			},
			
			list : function() {
				/**
				 * 跳转形式添加页面
				 */
				$("#createNewTypeButton")
						.click(
								function() {
									var classify = $(
											"#classify option:selected").val();
									platform
											.doGet(rootPath
													+ "/user/type/toAddType.shtml?classify="
													+ classify);
								});

				/**
				 * 点击砸金蛋系列
				 */
				$("#findProjectTypeList")
						.click(
								function() {
									var classify = $(
											"#classify option:selected").val();
									platform
											.flushWindow(rootPath
													+ "/user/type/findProjectTypeList.shtml?classify="
													+ classify)
								})
				/**
				 * 点击设置status为1启用
				 */
				$("#dazhuanpan").find(".btn-primary").click(
						function() {
							var arr = $(".btn-danger")
							var length = arr.length;

							var id = $(this).attr("name");
							platform.doGet(rootPath
									+ "/user/type/setStatus1.shtml?id=" + id)

						})

				/**
				 * 点击设置status为0停用
				 */
				$("#dazhuanpan").find(".btn-danger").click(
						function() {
							var id = $(this).attr("name");
							platform.doGet(rootPath
									+ "/user/type/setStatus0.shtml?id=" + id)
						})
				/**
				 * 点击更新
				 */
				$("#dazhuanpan").find(".btn-success").click(
						function() {
							var id = $(this).attr("name");
							platform.doGet(rootPath
									+ "/user/type/toEditType.shtml?id=" + id)
						})
				/**
				 * 点击删除
				 */
				$("#dazhuanpan")
						.find(".btn-warning")
						.click(
								function() {
									var id = $(this).attr("name");

									layer
											.confirm(
													'确定删除吗？',
													{
														btn : [ '确定', '取消' ],
														yes : function(index) {
															layer.close(index);
															var url = rootPath
																	+ "/user/type/deleteType.shtml";
															var param = {
																id : id
															};
															$
																	.post(
																			url,
																			{
																				id : id
																			},
																			function(
																					data) {
																				layer
																						.alert(
																								data['msg'],
																								{
																									/*
																									 * offset : [
																									 * '50%',
																									 * '40%' ],
																									 */
																									time : 0 // 不自动关闭
																									,
																									btn : [ '确定' ],
																									yes : function(
																											index) {
																										layer
																												.close(index);
																										platform
																												.doGet(rootPath
																														+ "/user/type/findProjectTypeList.shtml?classify=1")
																									}
																								})
																			},
																			'json')
														}
													// 按钮
													}, function() {
														return;
													});

								})
			},

			uploadBackbg : function(data, status) {
				if (!platform.isNull(data.msg)) {
					platform.alertmsg(data.msg);
				}
				if (!platform.isNull(data.data)) {
					$("#backgroundUrl").val(data.data.keyUrl);
					$("#bgimg").attr('src',
							"http://" + data.data.host + data.data.keyUrl);
					$("#bgimg2").attr('src',
							"http://" + data.data.host + data.data.keyUrl);
				}
			},
			uploadBacktb8 : function(data, status) {
				if (!platform.isNull(data.msg)) {
					platform.alertmsg(data.msg);
				}
				if (!platform.isNull(data.data)) {
					$("#turnTable8Url").val(data.data.keyUrl);
					$("#tableimg").attr('src',
							"http://" + data.data.host + data.data.keyUrl);
					$("#tableimg2").attr('src',
							"http://" + data.data.host + data.data.keyUrl);
				}
			},

			uploadBacktb10 : function(data, status) {
				if (!platform.isNull(data.msg)) {
					platform.alertmsg(data.msg);
				}
				if (!platform.isNull(data.data)) {
					$("#turnTable10Url").val(data.data.keyUrl);
					$("#table10img").attr('src',
							"http://" + data.data.host + data.data.keyUrl);
					$("#table10img2").attr('src',
							"http://" + data.data.host + data.data.keyUrl);
				}
			},
			uploadBackpo : function(data, status) {
				if (!platform.isNull(data.msg)) {
					platform.alertmsg(data.msg);
				}
				if (!platform.isNull(data.data)) {
					$("#pointUrl").val(data.data.keyUrl);
					$("#pointimg").attr('src',
							"http://" + data.data.host + data.data.keyUrl);
					$("#pointimg2").attr('src',
							"http://" + data.data.host + data.data.keyUrl);
				}
			},
			uploadBackto : function(data, status) {
				if (!platform.isNull(data.msg)) {
					platform.alertmsg(data.msg);
				}
				if (!platform.isNull(data.data)) {
					$("#outTurnTableUrl").val(data.data.keyUrl);
					$("#outimg").attr('src',
							"http://" + data.data.host + data.data.keyUrl);
					$("#outimg2").attr('src',
							"http://" + data.data.host + data.data.keyUrl);
				}
			},

			uploadBackrule : function(data, status) {
				if (!platform.isNull(data.msg)) {
					platform.alertmsg(data.msg);
				}
				if (!platform.isNull(data.data)) {
					$("#rulePictureUrl").val(data.data.keyUrl);
					$("#ruleimg").attr('src',
							"http://" + data.data.host + data.data.keyUrl);
					$("#ruleimg2").attr('src',
							"http://" + data.data.host + data.data.keyUrl);
				}
			},
			uploadBackrules : function(data, status) {
				if (!platform.isNull(data.msg)) {
					platform.alertmsg(data.msg);
				}
				if (!platform.isNull(data.data)) {
					$("#rulesUrl").val(data.data.keyUrl);
					$("#rulesimg").attr('src',
							"http://" + data.data.host + data.data.keyUrl);
				}
			},

			uploadBackshow : function(data, status) {
				if (!platform.isNull(data.msg)) {
					platform.alertmsg(data.msg);
				}
				if (!platform.isNull(data.data)) {
					$("#showPictureUrl").val(data.data.keyUrl);
					$("#showPictureimg").attr('src',
							"http://" + data.data.host + data.data.keyUrl);
					$("#showPictureimg2").attr('src',
							"http://" + data.data.host + data.data.keyUrl);
				}
			},

			/**
			 * 上传背景
			 */
			uploadbg : function() {

				$("#backgroundFile").on(
						"change",
						function() {
							$("#bgimg").show();
							platform.myAjaxFileUpload(rootPath
									+ "/user/upload/picture.shtml",
									"#backgroundFile", {
										backgroundUrl : $("#backgroundUrl")
												.val()
									}, platform.projectType.uploadBackbg,
									platform.fileUpload.uploadBackE);

						});
			},

			/**
			 * 上传转盘
			 */
			uploadtable : function() {
				$("#turnTableFile").on(
						"change",
						function() {
							$("#tableimg").show();
							platform.myAjaxFileUpload(rootPath
									+ "/user/upload/picture.shtml",
									"#turnTableFile", {
										turnTable8Url : $("#turnTable8Url")
												.val()
									}, platform.projectType.uploadBacktb8,
									platform.fileUpload.uploadBackE);
						});
			},

			/**
			 * 上传转盘
			 */
			uploadtable10 : function() {
				$("#turnTable10File").on(
						"change",
						function() {
							$("#table10img").show();
							platform.myAjaxFileUpload(rootPath
									+ "/user/upload/picture.shtml",
									"#turnTable10File", {
										turnTable10Url : $("#turnTable10Url")
												.val()
									}, platform.projectType.uploadBacktb10,
									platform.fileUpload.uploadBackE);
						});
			},

			/**
			 * 上传指针
			 */
			uploadpoint : function() {
				$("#pointFile").on(
						"change",
						function() {
							$("#pointimg").show();
							platform.myAjaxFileUpload(rootPath
									+ "/user/upload/picture.shtml",
									"#pointFile", {
										pointUrl : $("#pointUrl").val()
									}, platform.projectType.uploadBackpo,
									platform.fileUpload.uploadBackE);
						});
			},
			/**
			 * 上传转盘外圈
			 */
			uploadout : function() {
				$("#outTurnTableFile").on(
						"change",
						function() {
							$("#outimg").show();
							platform.myAjaxFileUpload(rootPath
									+ "/user/upload/picture.shtml",
									"#outTurnTableFile", {
										outTurnTableUrl : $("#outTurnTableUrl")
												.val()
									}, platform.projectType.uploadBackto,
									platform.fileUpload.uploadBackE);
						});
			},

			/**
			 * 上传活动规则图片
			 */
			uploadrule : function() {
				$("#rulePictureFile").on(
						"change",
						function() {
							$("#ruleimg").show();
							platform.myAjaxFileUpload(rootPath
									+ "/user/upload/picture.shtml",
									"#rulePictureFile", {
										rulePictureUrl : $("#rulePictureUrl")
												.val()
									}, platform.projectType.uploadBackrule,
									platform.fileUpload.uploadBackE);
						});
			},

			/**
			 * 上传活动规则
			 */
			uploadrules : function() {
				$("#rulesFile").on(
						"change",
						function() {
							$("#rulesimg").show();
							platform.myAjaxFileUpload(rootPath
									+ "/user/upload/picture.shtml",
									"#rulesFile", {
										rulesUrl : $("#rulesUrl").val()
									}, platform.projectType.uploadBackrules,
									platform.fileUpload.uploadBackE);

						});
			},

			/**
			 * 上传展示
			 */
			uploadshow : function() {
				$("#showPictureFile").on(
						"change",
						function() {
							$("#showPictureimg").show();
							platform.myAjaxFileUpload(rootPath
									+ "/user/upload/picture.shtml",
									"#showPictureFile", {
										showPictureUrl : $("#showPictureUrl")
												.val()
									}, platform.projectType.uploadBackshow,
									platform.fileUpload.uploadBackE);
						});
			},
			add : function() {
				$("#projectTypeButton").click(
						function() {
							// 获取表单提交的参数
							var param = platform
									.getFormJson("#projectTypeForm");
							var imgParam = platform.getFormJson("#imgParam");
							if (!platform.isNull(imgParam)) {
								param.imgParam = JSON.stringify(imgParam);
							}
							var flag = $("#flag").val();

							if (flag == "" || flag == null) {

								// 说明是新增
								platform.doPost(rootPath
										+ "/user/type/saveProjectType.shtml",
										param);
							} else if (flag == "edit") {

								// 说明是更新
								platform.doPost(rootPath
										+ "/user/type/editProjectType.shtml",
										param);
							}

						})

				$(".outlet").find(".theimg1").mouseover(function() {
					var h = $(this).parent().find("div").html();
					layer.open({
						type : 1,
						title : false,
						closeBtn : 0,
						/* area: '516px', */
						offset : [ // 为了演示，随机坐标
						$(window).height() / 4, ($(window).width() / 3) * 2 ],
						skin : 'layui-layer-nobg', // 没有背景色
						shadeClose : true,
						content : h
					});

				});

			},
		},

		activityMsg : {
			// 查询所有的数据类型
			findTheMathClass : function() {
				var url = rootPath + "/activity/findAllMathClass.shtml";

				$.post(url, {}, function(data) {

					var str = "";
					$(data).each(
							function(index, dom) {
								str += "<option value='" + dom['itemId'] + "'>"
										+ dom['itemName'] + "</option>";

							})
					$("#mathClass").append(str);

				})
			},
			// 活动日报
			activityAllMsg : function() {
				// 点击日期筛选
				$("#findTimeStage1").click(
						function() {
							var projectCode = $("#projectCode").val();
							var timeStage = $("#date-range5").val();
							var url = rootPath
									+ "/out/sumWeek.shtml?projectCode="
									+ projectCode + "&timeStage=" + timeStage;
							platform.doGet(url);
						});
				
				// 点击日期筛选
				$("#findTimeStage").click(
						function() {
							var projectCode = $("#projectCode").val();
							var timeStage = $("#date-range5").val();
							var url = rootPath
									+ "/activitys/sumWeek.shtml?projectCode="
									+ projectCode + "&timeStage=" + timeStage;
							platform.doGet(url);
						});
				// 点击日期筛选
				$("#findTimeStageByScanCode").click(
						function() {
							var projectCode = $("#projectCode").val();
							var timeStage = $("#date-range5").val();
							var url = rootPath
									+ "/activitys/sumWeekByScanCode.shtml?projectCode="
									+ projectCode + "&timeStage=" + timeStage;
							platform.doGet(url);
						});
				//周报跳转
				$("#paperForWeek").click(
						function() {
							var url = rootPath
									+ "/activitys/sumWeek.shtml?isCount=true";
							platform.doGet(url);
						});


				$("#svaeImage").click(
						function() {
							var canvas1 = "";
							var canvas2 = "";
							var canvas3 = "";
							var canvas4 = "";
							var projectCode = $("#projectCode").val();

							html2canvas($('#svgiContent'), {
								onrendered : function(canvas) {
									canvas1 += canvas.toDataURL();
								}
							})

							html2canvas($('#tuxing1'), {
								onrendered : function(canvas) {
									canvas2 += canvas.toDataURL();
								}
							})

							html2canvas($('#tuxing2'), {
								onrendered : function(canvas) {
									canvas3 += canvas.toDataURL();
								}
							})
							html2canvas($('#tuxing3'), {
								onrendered : function(canvas) {
									canvas4 += canvas.toDataURL();
								}
							})

							// 每半秒执行一次，当全部的canvas不为空的时候去请求下载，然后清除定时器
							var timer = setInterval(function() {
								if (canvas1 != "" && canvas1 != null
										&& canvas2 != "" && canvas2 != null
										&& canvas3 != "" && canvas3 != null
										&& canvas4 != "" && canvas4 != null) {
									platform.activityMsg.requestPDF(canvas1,
											canvas2, canvas3, canvas4,
											projectCode);
									clearInterval(timer);
								}
							}, 500);
						})
			},

			requestPDF : function(canvas1, canvas2, canvas3, canvas4,
					projectCode) {
				var url = rootPath + "/activity/outThePDF.shtml"
				platform.submitPost.postFunctioin(url, {
					canvas1 : canvas1,
					canvas2 : canvas2,
					canvas3 : canvas3,
					canvas4 : canvas4,
					projectCode : projectCode
				});
			},
		},
		/**
		 * 获取htmlcanvas base64url 传入放大倍数和要生成图片的div id
		 */
		getHtmlCanvasData : {
			getData : function(divDom, thescale) {
				var canvasData = "";
				var shareContent = divDom;// 需要截图的包裹的（原生的）DOM 对象
				var width = shareContent.offsetWidth; // 获取dom 宽度
				var height = shareContent.offsetHeight; // 获取dom 高度
				var canvas = document.createElement("canvas"); // 创建一个canvas节点
				var scale = thescale; // 定义任意放大倍数 支持小数
				canvas.width = width * scale; // 定义canvas 宽度 * 缩放
				canvas.height = height * scale; // 定义canvas高度 *缩放
				canvas.getContext("2d").scale(scale, scale); // 获取context,设置scale
				var opts = {
					scale : scale, // 添加的scale 参数
					canvas : canvas, // 自定义 canvas
					logging : true, // 日志开关
					width : width, // dom 原始宽度
					height : height
				// dom 原始高度
				};
				return canvasData;
			}
		},
		/**
		 * post同步提交方法
		 */
		submitPost : {
			postFunctioin : function(URL, PARAMS) {
				var temp = document.createElement("form");
				temp.action = URL;
				temp.method = "post";
				temp.style.display = "none";
				for ( var x in PARAMS) {
					var opt = document.createElement("textarea");
					opt.name = x;
					opt.value = PARAMS[x];
					// alert(opt.name)
					temp.appendChild(opt);
				}
				document.body.appendChild(temp);
				temp.submit();
				return temp;
			},
		},

		/**
		 * 给活动申请也添加提示
		 */
		activityCreateTips : {
			// 点击完成如果是商户就弹出提示信息
			shush : function() {
				$("#shanghuWancheng")
						.click(
								function() {
									var url = rootPath
											+ "/user/activity/sendMail.shtml";
									var organ = $("#organCode").val()
									if (organ != 3) {
										var organName = $("#organName").val()
										var activityName = $("#activityName")
												.val();
										var param = {
											organName : organName,
											activityName : activityName
										};
										$
												.post(
														url,
														param,
														function(data) {
															if (data['status'] == 200) {
																layer
																		.alert(
																				'您申请的项目已经提交我公司相关人员进行审核，我们将尽快为您处理！',
																				{
																					skin : 'layui-layer-molv' // 样式类名
																					,
																					closeBtn : 0
																				})
															}
														})
									}
								})
			},

			findTheOrgan : function() {
				var url = rootPath + "/user/material/findAllOrgan.shtml";
				var organCode = $("#theOrganCodeHidden").val();

				$.post(url, {}, function(data) {
					$(data).each(
							function(index, dom) {

								if (organCode == dom['code']) {
									var str = "<option value='" + dom['code']
											+ "' selected>" + dom['name']
											+ "</option>"
									$("#theOrganCode").append(str);
								} else {
									var str = "<option value='" + dom['code']
											+ "'>" + dom['name'] + "</option>"
									$("#theOrganCode").append(str);
								}
							})
				}, 'json');
			},

			createTips : function() {
				$("#brand").focus(function() {
					platform.layerTips("活动品牌填写您公司的品牌名称", "#brand");
				})
				$("#brand").blur(function() {
					var val = $(this).val();
					var pinyin = ConvertPinyin(val);
					$("#endDomain").val(pinyin);
				})
				$("#activityName").focus(function() {
					platform.layerTips("为您申请的活动起个名字吧", "#activityName");
				})
				$("#endDomain").focus(
						function() {
							platform.layerTips(
									"英文简称将会拼写在生成的url中，如果您不满意当前的英文名，请自行填写新的英文名",
									"#endDomain");
						})

				$("#saomayouxaio").click(function() {
					platform.layerTips("选择您的项目是否需要扫码", "#saomayouxaio");
				})
				
					$("#resourceNorm").click(function() {
					platform.layerTips("选择项目的资源判定标准", "#resourceNorm");
				})

				$("#startTime").focus(function() {
					platform.layerTips("指定您项目的开始时间", "#startTime");
				})
				$("#endTime").focus(function() {
					platform.layerTips("指定您项目的结束时间", "#endTime");
				})

				$("#huodongpinlei").focus(
						function() {
							platform.layerTips("填写您参加此次活动的产品类型，此项非必填项",
									"#huodongpinlei");
						})
				$("#huodongpici").focus(function() {
					platform.layerTips("为您的活动填写活动批次，此项非必填项", "#huodongpici");
				})
				$("#huodongguige").focus(
						function() {
							platform.layerTips("填写您参加此次活动的产品包装规格，此项非必填项",
									"#huodongguige");
						})
				$("#appid").focus(function() {
					platform.layerTips("填写微信标识，我们为您默认指定了我们的微信标识", "#appid");
				})
				$("#appSecret").focus(
						function() {
							platform.layerTips("填写微信秘钥，我们为您默认指定了我们的微信秘钥",
									"#appSecret");
						})
				$("#strategyProjects").click(function() {
					platform.layerTips("指定人群定向，进行项目分流", "#strategyProjects");
				})
				$("#activitys").click(
						function() {
							platform.layerTips(
									"指定您创建活动的前置活动页，进入转盘抽奖之前的页面，您可以在这个页面选择一些活动",
									"#activitys");
						})
				$("#activityTypes").click(
						function() {
							platform.layerTips(
									"指定您创建活动的形式，例如大转盘或者砸金蛋，选择并配置您的活动形式",
									"#activityTypes");
						})
				$("#prizeSettings").click(function() {
					platform.layerTips("指定您转盘上奖品的奖品类别", "#prizeSettings");
				})
				$("#strategyPrizes").click(
						function() {
							platform.layerTips("配置项目中具体的奖品信息，还有奖品的权重等细节",
									"#strategyPrizes");
						})
			}
		},

		layerTips : function(msg, id) {
			layer.tips(msg, $(id), {
				tips : [ 1, '#0099CC' ],
				time : 5000
			});
		},

		innerforms : {
			init : function() {
				platform.innerforms.greenHide();
				platform.innerforms.blueHide();
				platform.innerforms.organHide();
				platform.innerforms.ziseHide();

				$("#thegreenclass").click(function() {
					platform.innerforms.showAndHide($(this));
				})

				$("#theclueclass").click(function() {
					platform.innerforms.showAndHide($(this));
				})

				$("#theziseclass").click(function() {
					platform.innerforms.showAndHide($(this));
				})

				$("#theorganclass").click(function() {
					platform.innerforms.showAndHide($(this));
				})

				/**
				 * 划过提示
				 */

				var tip_index = 0;
				$(document).on(
						'mouseenter',
						"#thegreenclass",
						function() {
							tip_index = layer.tips(
									'点击增加展示维度：扫码uv，授权uv，访问uv，游戏访问uv，指向pv',
									'#thegreenclass', {
										tips : [ 1, '#3595CC' ],
										time : 0
									});
						}).on('mouseleave', "#thegreenclass", function() {
					layer.close(tip_index);
				});

				var tip_index2 = 0;
				$(document).on(
						'mouseenter',
						"#theclueclass",
						function() {
							tip_index2 = layer.tips(
									'点击增加展示维度：重复扫码，被分享访问pv，游戏分享pv，奖品分享pv',
									'#theclueclass', {
										tips : [ 1, '#3595CC' ],
										time : 0
									});
						}).on('mouseleave', "#theclueclass", function() {
					layer.close(tip_index2);
				});

				var tip_index3 = 0;
				$(document).on(
						'mouseenter',
						"#theziseclass",
						function() {
							tip_index3 = layer.tips('点击增加展示维度：分奖品指向uv',
									'#theziseclass', {
										tips : [ 1, '#3595CC' ],
										time : 0
									});
						}).on('mouseleave', "#theziseclass", function() {
					layer.close(tip_index3);
				});

				var tip_index4 = 0;
				$(document).on(
						'mouseenter',
						"#theorganclass",
						function() {
							tip_index4 = layer.tips('点击增加展示维度:游戏分享uv，奖品分享uv',
									'#theorganclass', {
										tips : [ 1, '#3595CC' ],
										time : 0
									});
						}).on('mouseleave', "#theorganclass", function() {
					layer.close(tip_index4);
				});

				var index = 0;
				$("table").find(".theGrayColor").on('mouseenter', function() {
					var text = $(this).html();
					index = $(this).index();
					index = layer.tips(text, $(this), {
						tips : [ 1, '#3595CC' ],
						time : 0
					});
				}).on('mouseleave', function() {
					layer.close(index)
				});

				var index2 = 0;
				$("table").find(".theziseColor").on('mouseenter', function() {
					var text = $(this).html();
					index2 = $(this).index();
					index2 = layer.tips(text, $(this), {
						tips : [ 1, '#3595CC' ],
						time : 0
					});
				}).on('mouseleave', function() {
					layer.close(index)
				});

				// 导出报表
				$("#svaeText")
						.click(
								function() {
									
									var projectCode = $("#projectCodeId").val();
									// 获取要导出的表头
									var th = $("#pages").find("table th")
									var thead = "";
									for (var i = 0; i < th.length; i++) {
										if ($(th[i]).css("display") != 'none') {
											var text = $.trim($(th[i]).html())
											if (i < th.length - 1) {
												thead += text + ","
											} else {
												thead += text
											}
										}
									}
									$("#innerFromsPort").find(
											"input[name='projectCode']").val(
											projectCode);

									$("#innerFromsPort").find(
											"input[name='thead']").val(thead);
									var param = platform
											.getFormJson("#innerFromsPort");
									var url = rootPath
											+ "/activity/downLoadExcelInnerPort.shtml";
									// platform.doPost(url,param);
									platform.submitPost.postFunctioin(url,
											param);
								})

				$("#findByDate").click(
						function() {
							var param = platform.getFormJson("#innerFromsPort");
							/*var datestr = $("#date-range00").val();*/
							/*var url =?dateStr="
									+ datestr;*/
							platform.doPost(rootPath
									+ "/activity/innerport.shtml",param);
						});
			},

			page : function() {
				$(".fd_page li").find("a").click(function() {
					var dateStr = $("#date-range00").val();
					var page = $(this).attr("assignPage");
					if(platform.isNull(page)){
						return;
					}
					var projectCode = $("#projectCodeId").val();
					platform.doGet(platform.getRequestInnerUrl(page, dateStr,projectCode));
				});
			},

			showAndHide : function(obj) {
				var c = $(obj).find("span").attr('class');
				var cl = $(obj).attr('id');
				if (c == 'checked') {
					$(obj).find("span").html("点击增加维度");
					if (cl == "thegreenclass") {
						platform.innerforms.greenHide();
						$("#innerFromsPort").find("input[name='greenValue']")
								.val(0);
					} else if (cl == "theclueclass") {
						platform.innerforms.blueHide();
						$("#innerFromsPort").find("input[name='blueValue']")
								.val(0);
					} else if (cl == "theziseclass") {
						platform.innerforms.ziseHide();
						$("#innerFromsPort").find("input[name='ziseValue']")
								.val(0);
					} else if (cl == "theorganclass") {
						platform.innerforms.organHide();
						$("#innerFromsPort").find("input[name='organValue']")
								.val(0);
					}
					$(obj).parent().find("input[type='checkbox']").prop(
							'checked', false)
					$(obj).find("span").attr('class', "")
				} else {
					$(obj).find("span").html("点击取消展示");
					if (cl == "thegreenclass") {
						platform.innerforms.greenShow();
						$("#innerFromsPort").find("input[name='greenValue']")
								.val(1);
					} else if (cl == "theclueclass") {
						platform.innerforms.blueShow();
						$("#innerFromsPort").find("input[name='blueValue']")
								.val(1);
					} else if (cl == "theziseclass") {
						platform.innerforms.ziseShow();
						$("#innerFromsPort").find("input[name='ziseValue']")
								.val(1);
					} else if (cl == "theorganclass") {
						platform.innerforms.organShow();
						$("#innerFromsPort").find("input[name='organValue']")
								.val(1);
					}
					$(obj).parent().find("input[type='checkbox']").prop(
							'checked', true)
					$(obj).find("span").attr("class", "checked");
				}
			},

			greenHide : function() {
				var index1 = $(".theGreen");
				for (var i = 0; i < index1.length; i++) {
					// alert($(index[i]).index());
					$('table tr').find('th:eq(' + $(index1[i]).index() + ')')
							.hide();
					$('table tr').find('td:eq(' + $(index1[i]).index() + ')')
							.hide();
				}
			},

			blueHide : function() {
				var index2 = $(".theBlue");
				for (var i = 0; i < index2.length; i++) {
					// alert($(index[i]).index());
					$('table tr').find('th:eq(' + $(index2[i]).index() + ')')
							.hide();
					$('table tr').find('td:eq(' + $(index2[i]).index() + ')')
							.hide();
				}
			},

			organHide : function() {
				var index3 = $(".theOrgan");
				for (var i = 0; i < index3.length; i++) {
					// alert($(index[i]).index());
					$('table tr').find('th:eq(' + $(index3[i]).index() + ')')
							.hide();
					$('table tr').find('td:eq(' + $(index3[i]).index() + ')')
							.hide();
				}
			},

			ziseHide : function() {
				var index4 = $(".theziseColor");
				for (var i = 0; i < index4.length; i++) {
					// alert($(index[i]).index());
					$('table tr').find('th:eq(' + $(index4[i]).index() + ')')
							.hide();
					$('table tr').find('td:eq(' + $(index4[i]).index() + ')')
							.hide();
				}
			},

			greenShow : function() {
				var index1 = $(".theGreen");
				for (var i = 0; i < index1.length; i++) {
					// alert($(index[i]).index());
					$('table tr').find('th:eq(' + $(index1[i]).index() + ')')
							.show();
					$('table tr').find('td:eq(' + $(index1[i]).index() + ')')
							.show();
				}
			},

			blueShow : function() {
				var index2 = $(".theBlue");
				for (var i = 0; i < index2.length; i++) {
					// alert($(index[i]).index());
					$('table tr').find('th:eq(' + $(index2[i]).index() + ')')
							.show();
					$('table tr').find('td:eq(' + $(index2[i]).index() + ')')
							.show();
				}
			},

			organShow : function() {
				var index3 = $(".theOrgan");
				for (var i = 0; i < index3.length; i++) {
					// alert($(index[i]).index());
					$('table tr').find('th:eq(' + $(index3[i]).index() + ')')
							.show();
					$('table tr').find('td:eq(' + $(index3[i]).index() + ')')
							.show();
				}
			},

			ziseShow : function() {
				var index4 = $(".theziseColor");
				for (var i = 0; i < index4.length; i++) {
					// alert($(index[i]).index());
					$('table tr').find('th:eq(' + $(index4[i]).index() + ')')
							.show();
					$('table tr').find('td:eq(' + $(index4[i]).index() + ')')
							.show();
				}
			},
		},
		//风控数据展示
		riskControl : {
			init:function(){
				var index = 0;
				$("table").find(".theSataus").on('mouseenter', function() {
					var text = $(this).html();
					index = $(this).index();
					index = layer.tips(text, $(this), {
						tips : [ 1, '#3595CC' ],
						time : 0
					});
				}).on('mouseleave', function() {
					layer.close(index)
				});
				
				$("#findByDate").click(
						function() {
							var param = platform.getFormJson("#innerFromsPort");
							/*var datestr = $("#date-range00").val();*/
							/*var url =?dateStr="
									+ datestr;*/
							platform.doPost(rootPath
									+ "/riskControl/list.shtml?isCount=true",param);
							
							
							
						});
			},
			
			
			
			page : function() {
				$(".fd_page li").find("a").click(function() {
					var dateStr = $("#date-range00").val();
					var projectName = $(".projectName").val();
					var page = $(this).attr("assignPage");
					var riskGrade = $('#riskGrade').val();
					if(platform.isNull(page)){
						return;
					}
					if (projectName==undefined) {
						projectName=''
					}
					var projectCode = $("#projectCodeId").val();
					platform.doGet(platform.getRequestRiskControlUrl(projectCode,projectName,riskGrade,page,dateStr));
				});
			}
		},
		/**
		 * 红包明细
		 */
		redPacketDetail : {
			page : function() {
				$("#zhongjiang").find(".fd_page li").find("a").click(
						function() {
							var type = $("#detailTypeVal").val();
							var page = $(this).attr("assignPage");
							var fromType=document.getElementById('fromType').value;
							if(platform.isNull(page)){
								return;
							}
							var redId = $("#theMaterialId").val();
							var dateTime=$("#dateTimeDetail").val()
							platform.doGet(rootPath
									+ "/account/redpacketcount.shtml?isCount=true&type="
									+ type + "&redId=" + redId+ "&fromType=" + fromType+ "&dateTime=" + dateTime+ "&current=" + page);
						});

				$("#rsuccess").find(".fd_page li").find("a").click(
						function() {
							var type = $("#detailTypeVal").val();
							var page = $(this).attr("assignPage");
							var fromType=document.getElementById('fromType').value;
							if(platform.isNull(page)){
								return;
							}
							var redId = $("#theMaterialId").val();
							platform.doGet(platform
									.getRequestRedPacketRecordUrl(page, type,
											redId,fromType));
						});

				$("#rerror").find(".fd_page li").find("a").click(
						function() {
							var type = $("#detailTypeVal").val();
							var page = $(this).attr("assignPage");
							var fromType=document.getElementById('fromType').value;
							var money=$("#money").val();
							if(platform.isNull(page)){
								return;
							}
							var redId = $("#theMaterialId").val();
							platform.doGet(rootPath
									+ "/account/redpacketcount.shtml?isCount=true&type="
									+ type + "&redId=" + redId+ "&fromType=" + fromType+ "&money=" + money+ "&current=" + page);
						});
				
				$("#huizong").find(".fd_page li").find("a").click(
						function() {
							var type = $("#detailTypeVal").val();
							var page = $(this).attr("assignPage");
							var fromType=document.getElementById('fromType').value;
							if(platform.isNull(page)){
								return;
							}
							var redId = $("#theMaterialId").val();
							platform.doGet(platform
									.getRequestRedPacketRecordUrl(page, type,
											redId,fromType	));
						});
			},

			checktype : function() {
				$("#myTab").find("li").click(
						function() {
							var type = $(this).attr('name');

							type = parseInt(type);

							/* $("input[name='detailTypeVal']").val(type) */

							var url = rootPath
									+ "/account/redpacketcount.shtml?isCount=true&type="
									+ type
							platform.flushWindow(url);

						})

				$("#toSearchResult").click(
						function() {
							// 高级查询
							var type = $("#detailTypeVal").val();
							var redId = $("#theMaterialId").val();
							var fromType = $("#fromType").val();
							var dateTime=$("#dateTimeDetail").val();
 
							var url = rootPath
									+ "/account/redpacketcount.shtml?isCount=true&type="
									+ type + "&redId=" + redId+ "&fromType=" + fromType+ "&dateTime=" + dateTime;
							platform.flushWindow(url)

						});
				
				$("#timeSearch").click(
						function() {
							//时间查询
							var type = $("#detailTypeVal").val();
							var fromType = $("#fromType").val();
							var dateTime = $("#prize-search-date-range").val();

							var url = rootPath
									+ "/account/redpacketcount.shtml?isCount=true&type="
									+ type + "&dateTime=" + dateTime+ "&fromType=" + fromType;
							platform.flushWindow(url)

						});
				$("#searchPrizeForBack").click(
						function() {
							//发放成功查询
							var type = $("#successType").val();
							var fromType = $("#fromType").val();
							var projectCode=platform.getProjectCode();
							var url = rootPath
									+ "/account/redpacketcount.shtml?isCount=true&type="
									+ type + "&fromType=" + fromType+"&"+projectCode;
							platform.flushWindow(url)

						});
				$("#searchPrizeForError").click(
						function() {
							//发放失败查询
							var type = $("#errorType").val();
							var fromType = $("#fromType").val();
                            var money=$("#money").val();
							var url = rootPath
									+ "/account/redpacketcount.shtml?isCount=true&type="
									+ type + "&fromType=" + fromType+ "&money=" + money;
							platform.flushWindow(url)

						});
			},

		},

		/**
		 * 个人中心
		 */
		userCenter : {
			/**
			 * 上传key
			 */
			upLoad : function() {
				/**
				 * 上传key文件theKeyFile
				 */
				$("#theKeyFile").off("change").on(
						"change",
						function() {
							platform.myAjaxFileUpload(rootPath
									+ "/user/upload/txt.shtml", "#theKeyFile",
									{
										keyUrl : $("#keyUrl").val()
									}, platform.userCenter.uploadBackKey,
									platform.fileUpload.uploadBackE);
						})

				/**
				 * 上传证书
				 */
				$("#diplomaFile").off("change").on(
						"change",
						function() {
							platform.myAjaxFileUpload(rootPath
									+ "/user/upload/zip.shtml",
									"#diplomaFile", {
										diplomaUrl : $("#diplomaUrl").val()
									}, platform.userCenter.uploadBackDip,
									platform.fileUpload.uploadBackE);
						})

			},

			// key文件上传回调
			uploadBackDip : function(data, status) {
				if (!platform.isNull(data.msg)) {
					platform.alertmsg(data.msg);
				}
				if (!platform.isNull(data.data)) {
					$("#diplomaUrl").val(data.data.keyUrl);
				}
			},

			// key文件上传回调
			uploadBackKey : function(data, status) {
				if (!platform.isNull(data.msg)) {
					platform.alertmsg(data.msg);
				}
				if (!platform.isNull(data.data)) {
					$("#keyUrl").val(data.data.keyUrl);
				}
			},

		},

		// =================================Qinkaixuan
		// ↓=================================================================================================

		theCountTemp : {
			list : function() {
				$("#theFindButton")
						.click(
								function() {
									var param = $("#date-range23").val();
									platform
											.doGet(rootPath
													+ "/activity/newsaoma.shtml?countTimeBeginAndEnd="
													+ param);
								})
			}
		},
		// ============================码分析量==============================================================

		theCodeAnaly : {

			page : function() {
				$(".fd_page li").find("a").click(
						function() {
							var page = $(this).attr("assignPage");
							if(platform.isNull(page)){
								return;
							}
							var date = $("#date1").val();
							var project = $("#project1").val();
							var stage = $("#stage").val();
							platform.doGet(platform.getCodelUrl(page, date,
									project, stage));
						})

			},

			list : function() {
				$("#codeAnaly_button").click(function() {
					var param = platform.getFormJson("#codeAyalyForm");
					platform.doPost(rootPath + "/account/codeAnaly.shtml");
					// var date=$("#date1").val();
					// var project=$("#project1").val();
					// var stage=$("#stage").val();
					// var
					// url=rootPath+"/account/codeAnaly.shtml?date="+date+"&project="+project+"&stage="+stage
					// platform.doGet(url);
				});
			},
		},
		// ---------------------------码分析率-----------------------------------------
		theCodeRate : {

			page : function() {
				$(".fd_page li").find("a").click(
						function() {
							var page = $(this).attr("assignPage");
							if(platform.isNull(page)){
								return;
							}
							var date = $("#date1").val();
							var project = $("#project1").val();
							var stage = $("#stage").val();
							platform.doGet(platform.getCodelRateUrl(page, date,
									project, stage));
						})

			},

			list : function() {
				$("#codeAnaly_button").click(
						function() {
							var date = $("#date1").val();
							var project = $("#project1").val();
							var stage = $("#stage").val();
							var url = rootPath
									+ "/account/codeRate.shtml?date=" + date
									+ "&project=" + project + "&stage=" + stage
							platform.doGet(url);
						});
			},
		},

		// ---------------------------素材应用-----------------------------------------
		materialApply : {

			page : function() {
				$(".fd_page li").find("a").click(
						function() {
							var page = $(this).attr("assignPage");
							if(platform.isNull(page)){
								return;
							}
							var material = $("#material").val();
							var project = $("#project").val();
							platform.doGet(platform.getMaterialMangagerUrl(
									page, material, project));
						})

			},

			list : function() {
				$("#materialButton").click(
						function() {
							var param = platform
									.getFormJson("#prizeMaterialCdForm");
							platform.doPost(rootPath
									+ "/user/material/materialmanager.shtml",
									param);
							/*
							 * var material=$("#material").val(); var
							 * project=$("#project").val(); var
							 * url=rootPath+"/user/material/materialmanager.shtml?material="+material+"&project="+project
							 * platform.doGet(url);
							 */
						});
			},
		},

		// ---------------------------公众号管理-----------------------------------------
		publicManager : {

			page : function() {
				$(".fd_page li").find("a").click(
						function() {
							var page = $(this).attr("assignPage");
							if(platform.isNull(page)){
								return;
							}
							var AppId = $("#AppId").val();
							var project = $("#project").val();
							platform.doGet(platform.getPublicManager(page,
									AppId, project));
						})

			},

			list : function() {
				$("#publicManagerButton").click(
						function() {
							var param = platform.getFormJson("#publicManager");
							platform.doPost(rootPath
									+ "/account/publicmanager.shtml", param);
							/*
							 * var material=$("#material").val(); var
							 * project=$("#project").val(); var
							 * url=rootPath+"/user/material/materialmanager.shtml?material="+material+"&project="+project
							 * platform.doGet(url);
							 */
						});
			},
		},
		
		
		/**
		 * 检验关键字js方法直接调用即可
		 */
		sensitiveWord:{
			/**
			 * 检测是否包含敏感词，如果包含就弹窗提示
			 */
			checkWordTips:function(text){
				var url=rootPath+"/user/wordFilter/isHaveSword.shtml";
				$.post(url,{text:text},function(data){
					if(data['isHaveSword']==true){
						//含有敏感词
						layer.alert("您刚刚填写的文本含有敏感词汇，请您检查修改！");
						return true;
					}else{
						return false;
					}
				},'json');
			},
			
			
			/**
			 * 检测是否包含敏感词，如果包含就提示那些事敏感词
			 */
			checkWordTipWord:function(text){
				var url=rootPath+"/user/wordFilter/getWord.shtml";
				$.post(url,{text:text},function(data){
					if(data['result']==true){
						//含有敏感词
						var str="";
						$(data['sensitiveWord']).each(function(index,dom){
							if(index<$(data['sensitiveWord']).length-1){
								str+=dom+",";
							}else{
								str+=dom;
							}
						})
						layer.alert("您刚刚填写的内容含有敏感词汇："+str);
						return true;
					}else{
						return false;
					}
				},'json');
				
			},
			
			/**
			 * 检测是否包含敏感词，如果包含就把敏感词替换成想要的字符
			 * 传入要检查的input框的id或者class，检查的内容，要替换内容
			 * 
			 */
			checkWordReplaceWord:function(element,text,replaceChar){
				var url=rootPath+"/user/wordFilter/replaceSword.shtml";
				$.post(url,{text:text,replaceChar:replaceChar},function(data){
					if(data['result']==true){
						//返回的是被替换的完成字符串
						$(element).val(data['afterWord'])
						layer.alert("您刚刚填写的内容含有敏感词汇，已被替换！")
						return true;
					}else{
						return false;
					}
					
				},'json')
			},
		
		
		}
		
		
	/*
	 * materialManager:{ page:function(){ $(".fd_page
	 * li").find("a").click(function(){ var page=$(this).attr("assignPage");
	 * 
	 * var prize=$("#prize").val(); var project=$("#project").val(); var
	 * sort=$("#sort").val(); var point=$("#point").val();
	 * 
	 * platform.doGet(platform.getMaterialUrl(page,prize,project,sort,point)); })
	 *  },
	 * 
	 * list:function(){ $("#materialmanager_button").click(function(){
	 * 
	 * var prize=$("#prize").val(); var project=$("#project").val(); var
	 * sort=$("#sort").val(); var point=$("#point").val();
	 * 
	 * var
	 * url=rootPath+"/user/material/materialmanager.shtml?prize="+prize+"&project="+project+"&sort="+sort+"&point="+point
	 * platform.doGet(url); }); }, }
	 */

	}
	$(document).ready(function() {
		$(".show-zp").hover(function() {
			/*
			 * var css='display: inline-block;margin: 0;padding: 0;width:
			 * 100%;height: 35px;line-height: 35px;text-align:
			 * center;background: #153001;margin-top: 150px;color:
			 * white;opacity: 0.8;cursor: pointer;'; var
			 * desc=$(this).attr("desc"); css+='content:'+desc+";";
			 */
			// $(this).attr("style",css);
		});
		platform.frame();
		$(".topClass").click(function() {
			platform.changeMenu(this);
		})
		platform.setIndexChecked();
		/*
		 * var param=platform.getParam();
		 * $("#window-content").load(rootPath+"/account/index.shtml?"+param,function(){
		 * });
		 */

	});
	window.platform = platform;

})(jQuery)

$(".navbar div").mouseover(function(){
		var index=$(this).index()+1
		if(index==1||index==3||index==4){
			
			$(this).find("img").attr("src","../assets/images/header-"+(index)+".png")
		}
		
	})
	$(".navbar div").mouseout(function(){
		var index=$(this).index()+1
		if(index==1||index==3||index==4){
			$(this).find("img").attr("src","../assets/images/header"+(index)+".png")
		}
		
	})


